var zr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qr(zt){return zt&&zt.__esModule&&Object.prototype.hasOwnProperty.call(zt,"default")?zt.default:zt}var Yn={exports:{}};/*!
 * @license Copyright 2015-2022 Ably Real-time Ltd (ably.com)
 * 
 * Ably JavaScript Library v1.2.46
 * https://github.com/ably/ably-js
 * 
 * Released under the Apache Licence v2.0
 */(function(zt,bt){(function(S,g){zt.exports=g()})(window,function(){return function(ut){var S={};function g(T){if(S[T])return S[T].exports;var c=S[T]={i:T,l:!1,exports:{}};return ut[T].call(c.exports,c,c.exports,g),c.l=!0,c.exports}return g.m=ut,g.c=S,g.d=function(T,c,G){g.o(T,c)||Object.defineProperty(T,c,{enumerable:!0,get:G})},g.r=function(T){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(T,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(T,"__esModule",{value:!0})},g.t=function(T,c){if(c&1&&(T=g(T)),c&8||c&4&&typeof T=="object"&&T&&T.__esModule)return T;var G=Object.create(null);if(g.r(G),Object.defineProperty(G,"default",{enumerable:!0,value:T}),c&2&&typeof T!="string")for(var D in T)g.d(G,D,(function(N){return T[N]}).bind(null,D));return G},g.n=function(T){var c=T&&T.__esModule?function(){return T.default}:function(){return T};return g.d(c,"a",c),c},g.o=function(T,c){return Object.prototype.hasOwnProperty.call(T,c)},g.p="",g(g.s=42)}([function(ut,S,g){g.r(S),g.d(S,"__extends",function(){return c}),g.d(S,"__assign",function(){return G}),g.d(S,"__rest",function(){return D}),g.d(S,"__decorate",function(){return N}),g.d(S,"__param",function(){return H}),g.d(S,"__metadata",function(){return j}),g.d(S,"__awaiter",function(){return b}),g.d(S,"__generator",function(){return M}),g.d(S,"__createBinding",function(){return u}),g.d(S,"__exportStar",function(){return h}),g.d(S,"__values",function(){return P}),g.d(S,"__read",function(){return O}),g.d(S,"__spread",function(){return d}),g.d(S,"__spreadArrays",function(){return p}),g.d(S,"__spreadArray",function(){return C}),g.d(S,"__await",function(){return s}),g.d(S,"__asyncGenerator",function(){return a}),g.d(S,"__asyncDelegator",function(){return t}),g.d(S,"__asyncValues",function(){return r}),g.d(S,"__makeTemplateObject",function(){return l}),g.d(S,"__importStar",function(){return y}),g.d(S,"__importDefault",function(){return U}),g.d(S,"__classPrivateFieldGet",function(){return w}),g.d(S,"__classPrivateFieldSet",function(){return L});/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var T=function(x,E){return T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,W){A.__proto__=W}||function(A,W){for(var V in W)Object.prototype.hasOwnProperty.call(W,V)&&(A[V]=W[V])},T(x,E)};function c(x,E){if(typeof E!="function"&&E!==null)throw new TypeError("Class extends value "+String(E)+" is not a constructor or null");T(x,E);function A(){this.constructor=x}x.prototype=E===null?Object.create(E):(A.prototype=E.prototype,new A)}var G=function(){return G=Object.assign||function(E){for(var A,W=1,V=arguments.length;W<V;W++){A=arguments[W];for(var X in A)Object.prototype.hasOwnProperty.call(A,X)&&(E[X]=A[X])}return E},G.apply(this,arguments)};function D(x,E){var A={};for(var W in x)Object.prototype.hasOwnProperty.call(x,W)&&E.indexOf(W)<0&&(A[W]=x[W]);if(x!=null&&typeof Object.getOwnPropertySymbols=="function")for(var V=0,W=Object.getOwnPropertySymbols(x);V<W.length;V++)E.indexOf(W[V])<0&&Object.prototype.propertyIsEnumerable.call(x,W[V])&&(A[W[V]]=x[W[V]]);return A}function N(x,E,A,W){var V=arguments.length,X=V<3?E:W===null?W=Object.getOwnPropertyDescriptor(E,A):W,ot;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")X=Reflect.decorate(x,E,A,W);else for(var at=x.length-1;at>=0;at--)(ot=x[at])&&(X=(V<3?ot(X):V>3?ot(E,A,X):ot(E,A))||X);return V>3&&X&&Object.defineProperty(E,A,X),X}function H(x,E){return function(A,W){E(A,W,x)}}function j(x,E){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(x,E)}function b(x,E,A,W){function V(X){return X instanceof A?X:new A(function(ot){ot(X)})}return new(A||(A=Promise))(function(X,ot){function at(B){try{R(W.next(B))}catch(k){ot(k)}}function $(B){try{R(W.throw(B))}catch(k){ot(k)}}function R(B){B.done?X(B.value):V(B.value).then(at,$)}R((W=W.apply(x,E||[])).next())})}function M(x,E){var A={label:0,sent:function(){if(X[0]&1)throw X[1];return X[1]},trys:[],ops:[]},W,V,X,ot;return ot={next:at(0),throw:at(1),return:at(2)},typeof Symbol=="function"&&(ot[Symbol.iterator]=function(){return this}),ot;function at(R){return function(B){return $([R,B])}}function $(R){if(W)throw new TypeError("Generator is already executing.");for(;A;)try{if(W=1,V&&(X=R[0]&2?V.return:R[0]?V.throw||((X=V.return)&&X.call(V),0):V.next)&&!(X=X.call(V,R[1])).done)return X;switch(V=0,X&&(R=[R[0]&2,X.value]),R[0]){case 0:case 1:X=R;break;case 4:return A.label++,{value:R[1],done:!1};case 5:A.label++,V=R[1],R=[0];continue;case 7:R=A.ops.pop(),A.trys.pop();continue;default:if(X=A.trys,!(X=X.length>0&&X[X.length-1])&&(R[0]===6||R[0]===2)){A=0;continue}if(R[0]===3&&(!X||R[1]>X[0]&&R[1]<X[3])){A.label=R[1];break}if(R[0]===6&&A.label<X[1]){A.label=X[1],X=R;break}if(X&&A.label<X[2]){A.label=X[2],A.ops.push(R);break}X[2]&&A.ops.pop(),A.trys.pop();continue}R=E.call(x,A)}catch(B){R=[6,B],V=0}finally{W=X=0}if(R[0]&5)throw R[1];return{value:R[0]?R[1]:void 0,done:!0}}}var u=Object.create?function(x,E,A,W){W===void 0&&(W=A),Object.defineProperty(x,W,{enumerable:!0,get:function(){return E[A]}})}:function(x,E,A,W){W===void 0&&(W=A),x[W]=E[A]};function h(x,E){for(var A in x)A!=="default"&&!Object.prototype.hasOwnProperty.call(E,A)&&u(E,x,A)}function P(x){var E=typeof Symbol=="function"&&Symbol.iterator,A=E&&x[E],W=0;if(A)return A.call(x);if(x&&typeof x.length=="number")return{next:function(){return x&&W>=x.length&&(x=void 0),{value:x&&x[W++],done:!x}}};throw new TypeError(E?"Object is not iterable.":"Symbol.iterator is not defined.")}function O(x,E){var A=typeof Symbol=="function"&&x[Symbol.iterator];if(!A)return x;var W=A.call(x),V,X=[],ot;try{for(;(E===void 0||E-- >0)&&!(V=W.next()).done;)X.push(V.value)}catch(at){ot={error:at}}finally{try{V&&!V.done&&(A=W.return)&&A.call(W)}finally{if(ot)throw ot.error}}return X}function d(){for(var x=[],E=0;E<arguments.length;E++)x=x.concat(O(arguments[E]));return x}function p(){for(var x=0,E=0,A=arguments.length;E<A;E++)x+=arguments[E].length;for(var W=Array(x),V=0,E=0;E<A;E++)for(var X=arguments[E],ot=0,at=X.length;ot<at;ot++,V++)W[V]=X[ot];return W}function C(x,E,A){if(A||arguments.length===2)for(var W=0,V=E.length,X;W<V;W++)(X||!(W in E))&&(X||(X=Array.prototype.slice.call(E,0,W)),X[W]=E[W]);return x.concat(X||Array.prototype.slice.call(E))}function s(x){return this instanceof s?(this.v=x,this):new s(x)}function a(x,E,A){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var W=A.apply(x,E||[]),V,X=[];return V={},ot("next"),ot("throw"),ot("return"),V[Symbol.asyncIterator]=function(){return this},V;function ot(z){W[z]&&(V[z]=function(et){return new Promise(function(ct,dt){X.push([z,et,ct,dt])>1||at(z,et)})})}function at(z,et){try{$(W[z](et))}catch(ct){k(X[0][3],ct)}}function $(z){z.value instanceof s?Promise.resolve(z.value.v).then(R,B):k(X[0][2],z)}function R(z){at("next",z)}function B(z){at("throw",z)}function k(z,et){z(et),X.shift(),X.length&&at(X[0][0],X[0][1])}}function t(x){var E,A;return E={},W("next"),W("throw",function(V){throw V}),W("return"),E[Symbol.iterator]=function(){return this},E;function W(V,X){E[V]=x[V]?function(ot){return(A=!A)?{value:s(x[V](ot)),done:V==="return"}:X?X(ot):ot}:X}}function r(x){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var E=x[Symbol.asyncIterator],A;return E?E.call(x):(x=typeof P=="function"?P(x):x[Symbol.iterator](),A={},W("next"),W("throw"),W("return"),A[Symbol.asyncIterator]=function(){return this},A);function W(X){A[X]=x[X]&&function(ot){return new Promise(function(at,$){ot=x[X](ot),V(at,$,ot.done,ot.value)})}}function V(X,ot,at,$){Promise.resolve($).then(function(R){X({value:R,done:at})},ot)}}function l(x,E){return Object.defineProperty?Object.defineProperty(x,"raw",{value:E}):x.raw=E,x}var i=Object.create?function(x,E){Object.defineProperty(x,"default",{enumerable:!0,value:E})}:function(x,E){x.default=E};function y(x){if(x&&x.__esModule)return x;var E={};if(x!=null)for(var A in x)A!=="default"&&Object.prototype.hasOwnProperty.call(x,A)&&u(E,x,A);return i(E,x),E}function U(x){return x&&x.__esModule?x:{default:x}}function w(x,E,A,W){if(A==="a"&&!W)throw new TypeError("Private accessor was defined without a getter");if(typeof E=="function"?x!==E||!W:!E.has(x))throw new TypeError("Cannot read private member from an object whose class did not declare it");return A==="m"?W:A==="a"?W.call(x):W?W.value:E.get(x)}function L(x,E,A,W,V){if(W==="m")throw new TypeError("Private method is not writable");if(W==="a"&&!V)throw new TypeError("Private accessor was defined without a setter");if(typeof E=="function"?x!==E||!V:!E.has(x))throw new TypeError("Cannot write private member to an object whose class did not declare it");return W==="a"?V.call(x,A):V?V.value=A:E.set(x,A),A}},function(ut,S,g){(function(T){Object.defineProperty(S,"__esModule",{value:!0}),S.allToUpperCase=S.allToLowerCase=S.encodeBody=S.decodeBody=S.Format=S.promisify=S.trim=S.arrChooseN=S.randomHexString=S.randomString=S.cheapRandStr=S.dataSizeBytes=S.inspectBody=S.inspectError=S.isErrorInfoOrPartialErrorInfo=S.now=S.parseQueryString=S.toQueryString=S.arrPopRandomElement=S.defaultPostHeaders=S.defaultGetHeaders=S.allSame=S.arrEvery=S.arrFilter=S.arrMap=S.safeArrForEach=S.arrForEach=S.forInOwnNonNullProperties=S.valuesArray=S.keysArray=S.arrWithoutValue=S.arrDeleteValue=S.arrIn=S.arrIndexOf=S.arrSubtract=S.arrIntersectOb=S.arrIntersect=S.intersect=S.containsValue=S.inherits=S.prototypicalClone=S.shallowClone=S.isEmptyArg=S.isOnlyPropIn=S.isEmpty=S.isObject=S.ensureArray=S.isArray=S.copy=S.mixin=void 0,S.arrEquals=S.toBase64=S.matchDerivedChannel=S.shallowEquals=S.getGlobalObject=S.getRetryTime=S.getJitterCoefficient=S.getBackoffCoefficient=void 0;var c=g(0),G=c.__importDefault(g(3)),D=c.__importStar(g(8)),N=c.__importDefault(g(4)),H=g(11),j=g(31);function b(Q){return Math.floor(Math.random()*Q.length)}function M(Q){for(var st=[],ft=1;ft<arguments.length;ft++)st[ft-1]=arguments[ft];for(var yt=0;yt<st.length;yt++){var It=st[yt];if(!It)break;var kt=Object.prototype.hasOwnProperty;for(var ee in It)(!kt||kt.call(It,ee))&&(Q[ee]=It[ee])}return Q}S.mixin=M;function u(Q){return M({},Q)}S.copy=u,S.isArray=Array.isArray||function(Q){return Object.prototype.toString.call(Q)=="[object Array]"};function h(Q){return p(Q)?[]:(0,S.isArray)(Q)?Q:[Q]}S.ensureArray=h;function P(Q){return Object.prototype.toString.call(Q)=="[object Object]"}S.isObject=P;function O(Q){for(var st in Q)return!1;return!0}S.isEmpty=O;function d(Q,st){for(var ft in Q)if(ft!==st)return!1;return!0}S.isOnlyPropIn=d;function p(Q){return Q==null}S.isEmptyArg=p;function C(Q){var st=new Object;for(var ft in Q)st[ft]=Q[ft];return st}S.shallowClone=C;function s(Q,st){var ft=function(){function It(){}return It}();ft.prototype=Q;var yt=new ft;return st&&M(yt,st),yt}S.prototypicalClone=s;var a=function(Q,st){if(G.default.Config.inherits){G.default.Config.inherits(Q,st);return}Q.super_=st,Q.prototype=s(st.prototype,{constructor:Q})};S.inherits=a;function t(Q,st){for(var ft in Q)if(Q[ft]==st)return!0;return!1}S.containsValue=t;function r(Q,st){return(0,S.isArray)(st)?l(Q,st):i(Q,st)}S.intersect=r;function l(Q,st){for(var ft=[],yt=0;yt<Q.length;yt++){var It=Q[yt];(0,S.arrIndexOf)(st,It)!=-1&&ft.push(It)}return ft}S.arrIntersect=l;function i(Q,st){for(var ft=[],yt=0;yt<Q.length;yt++){var It=Q[yt];It in st&&ft.push(It)}return ft}S.arrIntersectOb=i;function y(Q,st){for(var ft=[],yt=0;yt<Q.length;yt++){var It=Q[yt];(0,S.arrIndexOf)(st,It)==-1&&ft.push(It)}return ft}S.arrSubtract=y,S.arrIndexOf=Array.prototype.indexOf?function(Q,st,ft){return Q.indexOf(st,ft)}:function(Q,st,ft){ft=ft||0;for(var yt=Q.length;ft<yt;ft++)if(Q[ft]===st)return ft;return-1};function U(Q,st){return(0,S.arrIndexOf)(Q,st)!==-1}S.arrIn=U;function w(Q,st){var ft=(0,S.arrIndexOf)(Q,st),yt=ft!=-1;return yt&&Q.splice(ft,1),yt}S.arrDeleteValue=w;function L(Q,st){var ft=Q.slice();return w(ft,st),ft}S.arrWithoutValue=L;function x(Q,st){var ft=[];for(var yt in Q)st&&!Object.prototype.hasOwnProperty.call(Q,yt)||ft.push(yt);return ft}S.keysArray=x;function E(Q,st){var ft=[];for(var yt in Q)st&&!Object.prototype.hasOwnProperty.call(Q,yt)||ft.push(Q[yt]);return ft}S.valuesArray=E;function A(Q,st){for(var ft in Q)Object.prototype.hasOwnProperty.call(Q,ft)&&Q[ft]&&st(ft)}S.forInOwnNonNullProperties=A,S.arrForEach=Array.prototype.forEach?function(Q,st){Q.forEach(st)}:function(Q,st){for(var ft=Q.length,yt=0;yt<ft;yt++)st(Q[yt],yt,Q)};function W(Q,st){return(0,S.arrForEach)(Q.slice(),st)}S.safeArrForEach=W,S.arrMap=Array.prototype.map?function(Q,st){return Q.map(st)}:function(Q,st){for(var ft=[],yt=Q.length,It=0;It<yt;It++)ft.push(st(Q[It],It,Q));return ft},S.arrFilter=Array.prototype.filter?function(Q,st){return Q.filter(st)}:function(Q,st){for(var ft=[],yt=Q.length,It=0;It<yt;It++)st(Q[It])&&ft.push(Q[It]);return ft},S.arrEvery=Array.prototype.every?function(Q,st){return Q.every(st)}:function(Q,st){for(var ft=Q.length,yt=0;yt<ft;yt++)if(!st(Q[yt],yt,Q))return!1;return!0};function V(Q,st){if(Q.length===0)return!0;var ft=Q[0][st];return(0,S.arrEvery)(Q,function(yt){return yt[st]===ft})}S.allSame=V;var X={json:"application/json",jsonp:"application/javascript",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack"};function ot(Q,st){var ft=X[st||Ht.json];return{accept:ft,"X-Ably-Version":D.default.protocolVersion.toString(),"Ably-Agent":(0,D.getAgentString)(Q)}}S.defaultGetHeaders=ot;function at(Q,st){var ft,yt=ft=X[st||Ht.json];return{accept:yt,"content-type":ft,"X-Ably-Version":D.default.protocolVersion.toString(),"Ably-Agent":(0,D.getAgentString)(Q)}}S.defaultPostHeaders=at;function $(Q){return Q.splice(b(Q),1)[0]}S.arrPopRandomElement=$;function R(Q){var st=[];if(Q)for(var ft in Q)st.push(encodeURIComponent(ft)+"="+encodeURIComponent(Q[ft]));return st.length?"?"+st.join("&"):""}S.toQueryString=R;function B(Q){for(var st,ft=/([^?&=]+)=?([^&]*)/g,yt={};st=ft.exec(Q);)yt[decodeURIComponent(st[1])]=decodeURIComponent(st[2]);return yt}S.parseQueryString=B,S.now=Date.now||function(){return new Date().getTime()};function k(Q){return typeof Q=="object"&&Q!==null&&(Q.constructor.name=="ErrorInfo"||Q.constructor.name=="PartialErrorInfo")}S.isErrorInfoOrPartialErrorInfo=k;function z(Q){var st,ft;return Q instanceof Error||((st=Q==null?void 0:Q.constructor)===null||st===void 0?void 0:st.name)==="ErrorInfo"||((ft=Q==null?void 0:Q.constructor)===null||ft===void 0?void 0:ft.name)==="PartialErrorInfo"?Q.toString():G.default.Config.inspect(Q)}S.inspectError=z;function et(Q){return G.default.BufferUtils.isBuffer(Q)?Q.toString():typeof Q=="string"?Q:G.default.Config.inspect(Q)}S.inspectBody=et;function ct(Q){if(G.default.BufferUtils.isBuffer(Q))return G.default.BufferUtils.byteLength(Q);if(typeof Q=="string")return G.default.Config.stringByteSize(Q);throw new Error("Expected input of Utils.dataSizeBytes to be a buffer or string, but was: "+typeof Q)}S.dataSizeBytes=ct;function dt(){return String(Math.random()).substr(2)}S.cheapRandStr=dt;var Ot=function(Q){if(G.default.Config.getRandomValues&&typeof Uint8Array<"u"){var st=new Uint8Array(Q);return G.default.Config.getRandomValues(st),G.default.BufferUtils.base64Encode(st)}for(var ft=G.default.BufferUtils.base64CharSet,yt=Math.round(Q*4/3),It="",kt=0;kt<yt;kt++)It+=ft[b(ft)];return It};S.randomString=Ot;var St=function(Q){if(G.default.Config.getRandomValues&&typeof Uint8Array<"u"){var st=new Uint8Array(Q);return G.default.Config.getRandomValues(st),G.default.BufferUtils.hexEncode(st)}for(var ft=G.default.BufferUtils.hexCharSet,yt=Q*2,It="",kt=0;kt<yt;kt++)It+=ft[b(ft)];return It};S.randomHexString=St;function Mt(Q,st){for(var ft=Math.min(st,Q.length),yt=Q.slice(),It=[],kt=0;kt<ft;kt++)It.push($(yt));return It}S.arrChooseN=Mt,S.trim=String.prototype.trim?function(Q){return Q.trim()}:function(Q){return Q.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function vt(Q,st,ft){return new Promise(function(yt,It){Q[st].apply(Q,c.__spreadArray(c.__spreadArray([],ft,!1),[function(kt,ee){kt?It(kt):yt(ee)}],!1))})}S.promisify=vt;var Ht;(function(Q){Q.msgpack="msgpack",Q.json="json"})(Ht=S.Format||(S.Format={}));function Ft(Q,st){return st=="msgpack"?G.default.Config.msgpack.decode(Q):JSON.parse(String(Q))}S.decodeBody=Ft;function Tt(Q,st){return st=="msgpack"?G.default.Config.msgpack.encode(Q,!0):JSON.stringify(Q)}S.encodeBody=Tt;function Nt(Q){return Q.map(function(st){return st&&st.toLowerCase()})}S.allToLowerCase=Nt;function Zt(Q){return Q.map(function(st){return st&&st.toUpperCase()})}S.allToUpperCase=Zt;function ve(Q){return Math.min((Q+2)/3,2)}S.getBackoffCoefficient=ve;function te(){return 1-Math.random()*.2}S.getJitterCoefficient=te;function Qt(Q,st){return Q*ve(st)*te()}S.getRetryTime=Qt;function de(){return T||(typeof window<"u"?window:self)}S.getGlobalObject=de;function he(Q,st){return Object.keys(Q).every(function(ft){return Q[ft]===st[ft]})&&Object.keys(st).every(function(ft){return st[ft]===Q[ft]})}S.shallowEquals=he;function Ct(Q){var st=/^(\[([^?]*)(?:(.*))\])?(.+)$/,ft=Q.match(st);if(!ft||!ft.length||ft.length<5)throw new N.default("regex match failed",400,40010);if(ft[2])throw new N.default("cannot use a derived option with a ".concat(ft[2]," channel"),400,40010);return{qualifierParam:ft[3]||"",channelName:ft[4]}}S.matchDerivedChannel=Ct;function qt(Q){return G.default.Config.createHmac?Buffer.from(Q,"ascii").toString("base64"):(0,H.stringify)((0,j.parse)(Q))}S.toBase64=qt;function Je(Q,st){return Q.length===st.length&&(0,S.arrEvery)(Q,function(ft,yt){return ft===st[yt]})}S.arrEquals=Je}).call(this,g(13))},function(ut,S,g){(function(T){Object.defineProperty(S,"__esModule",{value:!0});var c=g(0),G=c.__importDefault(g(3)),D=T||(typeof window<"u"?window:self),N;(function(u){u[u.None=0]="None",u[u.Error=1]="Error",u[u.Major=2]="Major",u[u.Minor=3]="Minor",u[u.Micro=4]="Micro"})(N||(N={}));function H(u,h){return"".concat(u).padStart(h?3:2,"0")}function j(u){return G.default.Config.logTimestamps?function(h){var P=new Date;u(H(P.getHours())+":"+H(P.getMinutes())+":"+H(P.getSeconds())+"."+H(P.getMilliseconds(),1)+" "+h)}:u}var b=function(){var u,h,P,O;return typeof Window>"u"&&typeof WorkerGlobalScope>"u"||typeof((h=(u=D==null?void 0:D.console)===null||u===void 0?void 0:u.log)===null||h===void 0?void 0:h.apply)=="function"?(P=function(){for(var d=[],p=0;p<arguments.length;p++)d[p]=arguments[p];console.log.apply(console,d)},O=console.warn?function(){for(var d=[],p=0;p<arguments.length;p++)d[p]=arguments[p];console.warn.apply(console,d)}:P):D!=null&&D.console.log?P=O=function(){Function.prototype.apply.call(console.log,console,arguments)}:P=O=function(){},[P,O].map(j)},M=function(){function u(){u.logLevel=u.LOG_DEFAULT}return u.initLogHandlers=function(){var h=b(),P=h[0],O=h[1];this.logHandler=P,this.logErrorHandler=O},u.logLevel=N.Error,u.LOG_NONE=N.None,u.LOG_ERROR=N.Error,u.LOG_MAJOR=N.Major,u.LOG_MINOR=N.Minor,u.LOG_MICRO=N.Micro,u.LOG_DEFAULT=N.Error,u.LOG_DEBUG=N.Micro,u.logAction=function(h,P,O){u.shouldLog(h)&&(h===N.Error?u.logErrorHandler:u.logHandler)("Ably: "+P+": "+O)},u.deprecated=function(h,P){u.deprecatedWithMsg(h,"Please use '"+P+"' instead.")},u.deprecatedWithMsg=function(h,P){u.shouldLog(N.Error)&&u.logErrorHandler("Ably: Deprecation warning - '"+h+"' is deprecated and will be removed from a future version. "+P)},u.shouldLog=function(h){return h<=u.logLevel},u.setLog=function(h,P){h!==void 0&&(u.logLevel=h),P!==void 0&&(u.logHandler=u.logErrorHandler=P)},u}();S.default=M}).call(this,g(13))},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=function(){function c(){}return c}();S.default=T},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0}),S.PartialErrorInfo=void 0;var T=g(0),c=T.__importDefault(g(3)),G=T.__importStar(g(1));function D(j){var b="["+j.constructor.name;return j.message&&(b+=": "+j.message),j.statusCode&&(b+="; statusCode="+j.statusCode),j.code&&(b+="; code="+j.code),j.cause&&(b+="; cause="+G.inspectError(j.cause)),j.href&&!(j.message&&j.message.indexOf("help.ably.io")>-1)&&(b+="; see "+j.href+" "),b+="]",b}var N=function(j){T.__extends(b,j);function b(M,u,h,P){var O=j.call(this,M)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(O,b.prototype),O.code=u,O.statusCode=h,O.cause=P,O}return b.prototype.toString=function(){return D(this)},b.fromValues=function(M){var u=M,h=u.message,P=u.code,O=u.statusCode;if(typeof h!="string"||typeof P!="number"||typeof O!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+c.default.Config.inspect(M));var d=Object.assign(new b(h,P,O),M);return d.code&&!d.href&&(d.href="https://help.ably.io/error/"+d.code),d},b}(Error);S.default=N;var H=function(j){T.__extends(b,j);function b(M,u,h,P){var O=j.call(this,M)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(O,b.prototype),O.code=u,O.statusCode=h,O.cause=P,O}return b.prototype.toString=function(){return D(this)},b}(Error);S.PartialErrorInfo=H},function(ut,S,g){(function(T,c){ut.exports=c(g(6))})(this,function(T){return function(){if(typeof ArrayBuffer=="function"){var c=T,G=c.lib,D=G.WordArray,N=D.init,H=D.init=function(j){if(j instanceof ArrayBuffer&&(j=new Uint8Array(j)),(j instanceof Int8Array||typeof Uint8ClampedArray<"u"&&j instanceof Uint8ClampedArray||j instanceof Int16Array||j instanceof Uint16Array||j instanceof Int32Array||j instanceof Uint32Array||j instanceof Float32Array||j instanceof Float64Array)&&(j=new Uint8Array(j.buffer,j.byteOffset,j.byteLength)),j instanceof Uint8Array){for(var b=j.byteLength,M=[],u=0;u<b;u++)M[u>>>2]|=j[u]<<24-u%4*8;N.call(this,M,b)}else N.apply(this,arguments)};H.prototype=D}}(),T.lib.WordArray})},function(ut,S,g){(function(T){(function(c,G){ut.exports=G()})(this,function(){var c=c||function(G,D){var N;if(typeof window<"u"&&window.crypto&&(N=window.crypto),!N&&typeof window<"u"&&window.msCrypto&&(N=window.msCrypto),!N&&typeof T<"u"&&T.crypto&&(N=T.crypto),!N)try{N=g(44)}catch{}var H=function(){if(N){if(typeof N.getRandomValues=="function")try{return N.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof N.randomBytes=="function")try{return N.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},j=Object.create||function(){function a(){}return function(t){var r;return a.prototype=t,r=new a,a.prototype=null,r}}(),b={},M=b.lib={},u=M.Base=function(){return{extend:function(a){var t=j(this);return a&&t.mixIn(a),(!t.hasOwnProperty("init")||this.init===t.init)&&(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var t in a)a.hasOwnProperty(t)&&(this[t]=a[t]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),h=M.WordArray=u.extend({init:function(a,t){a=this.words=a||[],t!=D?this.sigBytes=t:this.sigBytes=a.length*4},toString:function(a){return(a||O).stringify(this)},concat:function(a){var t=this.words,r=a.words,l=this.sigBytes,i=a.sigBytes;if(this.clamp(),l%4)for(var y=0;y<i;y++){var U=r[y>>>2]>>>24-y%4*8&255;t[l+y>>>2]|=U<<24-(l+y)%4*8}else for(var y=0;y<i;y+=4)t[l+y>>>2]=r[y>>>2];return this.sigBytes+=i,this},clamp:function(){var a=this.words,t=this.sigBytes;a[t>>>2]&=4294967295<<32-t%4*8,a.length=G.ceil(t/4)},clone:function(){var a=u.clone.call(this);return a.words=this.words.slice(0),a},random:function(a){for(var t=[],r=0;r<a;r+=4)t.push(H());return new h.init(t,a)}}),P=b.enc={},O=P.Hex={stringify:function(a){for(var t=a.words,r=a.sigBytes,l=[],i=0;i<r;i++){var y=t[i>>>2]>>>24-i%4*8&255;l.push((y>>>4).toString(16)),l.push((y&15).toString(16))}return l.join("")},parse:function(a){for(var t=a.length,r=[],l=0;l<t;l+=2)r[l>>>3]|=parseInt(a.substr(l,2),16)<<24-l%8*4;return new h.init(r,t/2)}},d=P.Latin1={stringify:function(a){for(var t=a.words,r=a.sigBytes,l=[],i=0;i<r;i++){var y=t[i>>>2]>>>24-i%4*8&255;l.push(String.fromCharCode(y))}return l.join("")},parse:function(a){for(var t=a.length,r=[],l=0;l<t;l++)r[l>>>2]|=(a.charCodeAt(l)&255)<<24-l%4*8;return new h.init(r,t)}},p=P.Utf8={stringify:function(a){try{return decodeURIComponent(escape(d.stringify(a)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(a){return d.parse(unescape(encodeURIComponent(a)))}},C=M.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new h.init,this._nDataBytes=0},_append:function(a){typeof a=="string"&&(a=p.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(a){var t,r=this._data,l=r.words,i=r.sigBytes,y=this.blockSize,U=y*4,w=i/U;a?w=G.ceil(w):w=G.max((w|0)-this._minBufferSize,0);var L=w*y,x=G.min(L*4,i);if(L){for(var E=0;E<L;E+=y)this._doProcessBlock(l,E);t=l.splice(0,L),r.sigBytes-=x}return new h.init(t,x)},clone:function(){var a=u.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});M.Hasher=C.extend({cfg:u.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){C.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){a&&this._append(a);var t=this._doFinalize();return t},blockSize:16,_createHelper:function(a){return function(t,r){return new a.init(r).finalize(t)}},_createHmacHelper:function(a){return function(t,r){return new s.HMAC.init(a,r).finalize(t)}}});var s=b.algo={};return b}(Math);return c})}).call(this,g(13))},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importStar(g(1)),G=T.__importDefault(g(2)),D=T.__importDefault(g(3));function N(b,M,u){try{M.apply(b,u)}catch(h){G.default.logAction(G.default.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+h+"; stack = "+(h&&h.stack))}}function H(b,M,u){for(var h,P,O,d=0;d<b.length;d++)if(h=b[d],u&&(h=h[u]),c.isArray(h)){for(;(P=c.arrIndexOf(h,M))!==-1;)h.splice(P,1);u&&h.length===0&&delete b[d][u]}else if(c.isObject(h))for(O in h)Object.prototype.hasOwnProperty.call(h,O)&&c.isArray(h[O])&&H([h],M,O)}var j=function(){function b(){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}return b.prototype.on=function(){for(var M=this,u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];if(u.length===1){var P=u[0];if(typeof P=="function")this.any.push(P);else throw new Error("EventListener.on(): Invalid arguments: "+D.default.Config.inspect(u))}if(u.length===2){var O=u[0],d=u[1];if(typeof d!="function")throw new Error("EventListener.on(): Invalid arguments: "+D.default.Config.inspect(u));if(c.isEmptyArg(O))this.any.push(d);else if(c.isArray(O))O.forEach(function(C){M.on(C,d)});else{if(typeof O!="string")throw new Error("EventListener.on(): Invalid arguments: "+D.default.Config.inspect(u));var p=this.events[O]||(this.events[O]=[]);p.push(d)}}},b.prototype.off=function(){for(var M,u=this,h=[],P=0;P<arguments.length;P++)h[P]=arguments[P];if(h.length==0||c.isEmptyArg(h[0])&&c.isEmptyArg(h[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}var O=h[0],d=h[1],p=null,C=null;if(h.length===1||!d)typeof O=="function"?p=O:C=O;else{if(typeof d!="function")throw new Error("EventEmitter.off(): invalid arguments:"+D.default.Config.inspect(h));M=[O,d],C=M[0],p=M[1]}if(p&&c.isEmptyArg(C)){H([this.any,this.events,this.anyOnce,this.eventsOnce],p);return}if(c.isArray(C)){C.forEach(function(s){u.off(s,p)});return}if(typeof C!="string")throw new Error("EventEmitter.off(): invalid arguments:"+D.default.Config.inspect(h));p?H([this.events,this.eventsOnce],p,C):(delete this.events[C],delete this.eventsOnce[C])},b.prototype.listeners=function(M){if(M){var u=this.events[M]||[];return this.eventsOnce[M]&&Array.prototype.push.apply(u,this.eventsOnce[M]),u.length?u:null}return this.any.length?this.any:null},b.prototype.emit=function(M){for(var u=[],h=1;h<arguments.length;h++)u[h-1]=arguments[h];var P={event:M},O=[];this.anyOnce.length&&(Array.prototype.push.apply(O,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(O,this.any);var d=this.eventsOnce[M];d&&(Array.prototype.push.apply(O,d),delete this.eventsOnce[M]);var p=this.events[M];p&&Array.prototype.push.apply(O,p),c.arrForEach(O,function(C){N(P,C,u)})},b.prototype.once=function(){for(var M=this,u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];var P=u.length;if((P===0||P===1&&typeof u[0]!="function")&&D.default.Config.Promise){var O=u[0];return new D.default.Config.Promise(function(t){M.once(O,t)})}var d=u[0],p=u[1];if(u.length===1&&typeof d=="function")this.anyOnce.push(d);else if(c.isEmptyArg(d)){if(typeof p!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+D.default.Config.inspect(u));this.anyOnce.push(p)}else if(c.isArray(d)){var C=this,s=function(){var t=Array.prototype.slice.call(arguments);if(c.arrForEach(d,function(r){C.off(r,s)}),typeof p!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+D.default.Config.inspect(u));p.apply(this,t)};c.arrForEach(d,function(t){C.on(t,s)})}else{if(typeof d!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+D.default.Config.inspect(u));var a=this.eventsOnce[d]||(this.eventsOnce[d]=[]);if(p){if(typeof p!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+D.default.Config.inspect(u));a.push(p)}}},b.prototype.whenState=function(M,u,h){for(var P=this,O=[],d=3;d<arguments.length;d++)O[d-3]=arguments[d];var p={event:M};if(typeof M!="string"||typeof u!="string")throw"whenState requires a valid event String argument";if(typeof h!="function"&&D.default.Config.Promise)return new D.default.Config.Promise(function(C){b.prototype.whenState.apply(P,[M,u,C].concat(O))});M===u?N(p,h,O):this.once(M,h)},b}();S.default=j},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0}),S.getDefaults=S.normaliseOptions=S.objectifyOptions=S.getAgentString=S.getHosts=S.getFallbackHosts=S.environmentFallbackHosts=S.getHttpScheme=S.getPort=S.getHost=void 0;var T=g(0),c=T.__importDefault(g(3)),G=T.__importStar(g(1)),D=T.__importDefault(g(2)),N=T.__importDefault(g(4)),H=g(43),j="ably-js/"+H.version,b={ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["A.ably-realtime.com","B.ably-realtime.com","C.ably-realtime.com","D.ably-realtime.com","E.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,preferenceConnectTimeout:6e3,parallelUpgradeDelay:6e3},httpMaxRetryCount:3,maxMessageSize:65536,version:H.version,protocolVersion:2,agent:j,getHost:M,getPort:u,getHttpScheme:h,environmentFallbackHosts:P,getFallbackHosts:O,getHosts:d,checkHost:p,objectifyOptions:t,normaliseOptions:r};function M(i,y,U){return U?y=y==i.restHost&&i.realtimeHost||y||i.realtimeHost:y=y||i.restHost,y}S.getHost=M;function u(i,y){return y||i.tls?i.tlsPort:i.port}S.getPort=u;function h(i){return i.tls?"https://":"http://"}S.getHttpScheme=h;function P(i){return[i+"-a-fallback.ably-realtime.com",i+"-b-fallback.ably-realtime.com",i+"-c-fallback.ably-realtime.com",i+"-d-fallback.ably-realtime.com",i+"-e-fallback.ably-realtime.com"]}S.environmentFallbackHosts=P;function O(i){var y=i.fallbackHosts,U=typeof i.httpMaxRetryCount<"u"?i.httpMaxRetryCount:b.httpMaxRetryCount;return y?G.arrChooseN(y,U):[]}S.getFallbackHosts=O;function d(i){return[i.restHost].concat(O(i))}S.getHosts=d;function p(i){if(typeof i!="string")throw new N.default("host must be a string; was a "+typeof i,4e4,400);if(!i.length)throw new N.default("host must not be zero-length",4e4,400)}function C(i,y,U){return i.realtimeHost?i.realtimeHost:i.restHost?(D.default.logAction(D.default.LOG_MINOR,"Defaults.normaliseOptions",'restHost is set to "'+i.restHost+'" but realtimeHost is not set, so setting realtimeHost to "'+i.restHost+'" too. If this is not what you want, please set realtimeHost explicitly.'),i.restHost):y?b.REALTIME_HOST:U+"-"+b.REALTIME_HOST}function s(i){var y={};for(var U in b.TIMEOUTS)y[U]=i[U]||b.TIMEOUTS[U];return y}function a(i){var y=b.agent;if(i.agents)for(var U in i.agents)y+=" "+U+"/"+i.agents[U];return y}S.getAgentString=a;function t(i){return typeof i=="string"?i.indexOf(":")==-1?{token:i}:{key:i}:i}S.objectifyOptions=t;function r(i){if(i.host&&(D.default.deprecated("host","restHost"),i.restHost=i.host),i.wsHost&&(D.default.deprecated("wsHost","realtimeHost"),i.realtimeHost=i.wsHost),i.queueEvents&&(D.default.deprecated("queueEvents","queueMessages"),i.queueMessages=i.queueEvents),i.fallbackHostsUseDefault){if(i.fallbackHosts){var y="fallbackHosts and fallbackHostsUseDefault cannot both be set";throw D.default.logAction(D.default.LOG_ERROR,"Defaults.normaliseOptions",y),new N.default(y,4e4,400)}if(i.port||i.tlsPort){var y="fallbackHostsUseDefault cannot be set when port or tlsPort are set";throw D.default.logAction(D.default.LOG_ERROR,"Defaults.normaliseOptions",y),new N.default(y,4e4,400)}i.environment?D.default.deprecatedWithMsg("fallbackHostsUseDefault","There is no longer a need to set this when the environment option is also set since the library will now generate the correct fallback hosts using the environment option."):D.default.deprecated("fallbackHostsUseDefault","fallbackHosts: Ably.Defaults.FALLBACK_HOSTS"),i.fallbackHosts=b.FALLBACK_HOSTS}i.recover===!0&&(D.default.deprecated("{recover: true}","{recover: function(lastConnectionDetails, cb) { cb(true); }}"),i.recover=function($,R){R(!0)}),typeof i.recover=="function"&&i.closeOnUnload===!0&&(D.default.logAction(D.default.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),i.recover=void 0),"closeOnUnload"in i||(i.closeOnUnload=!i.recover),i.transports&&G.arrIn(i.transports,"xhr")&&(D.default.deprecated('transports: ["xhr"]','transports: ["xhr_streaming"]'),G.arrDeleteValue(i.transports,"xhr"),i.transports.push("xhr_streaming")),"queueMessages"in i||(i.queueMessages=!0);var U=i.environment&&String(i.environment).toLowerCase()||b.ENVIRONMENT,w=!U||U==="production";!i.fallbackHosts&&!i.restHost&&!i.realtimeHost&&!i.port&&!i.tlsPort&&(i.fallbackHosts=w?b.FALLBACK_HOSTS:P(U));var L=i.restHost||(w?b.REST_HOST:U+"-"+b.REST_HOST),x=C(i,w,U);G.arrForEach((i.fallbackHosts||[]).concat(L,x),p),i.port=i.port||b.PORT,i.tlsPort=i.tlsPort||b.TLS_PORT,"tls"in i||(i.tls=!0);var E=s(i);if("useBinaryProtocol"in i?i.useBinaryProtocol=c.default.Config.supportsBinary&&i.useBinaryProtocol:i.useBinaryProtocol=c.default.Config.preferBinary,i.clientId){var A=i.headers=i.headers||{};A["X-Ably-ClientId"]=c.default.BufferUtils.base64Encode(c.default.BufferUtils.utf8Encode(i.clientId))}"idempotentRestPublishing"in i||(i.idempotentRestPublishing=!0),i.promises&&!c.default.Config.Promise&&(D.default.logAction(D.default.LOG_ERROR,"Defaults.normaliseOptions","{promises: true} was specified, but no Promise constructor found; disabling promises"),i.promises=!1);var W=null,V=i.connectivityCheckUrl;if(i.connectivityCheckUrl){var X=i.connectivityCheckUrl.split("?"),ot=X[0],at=X[1];W=at?G.parseQueryString(at):{},ot.indexOf("://")===-1&&(ot="https://"+ot),V=ot}return T.__assign(T.__assign({},i),{useBinaryProtocol:"useBinaryProtocol"in i?c.default.Config.supportsBinary&&i.useBinaryProtocol:c.default.Config.preferBinary,realtimeHost:x,restHost:L,maxMessageSize:i.maxMessageSize||b.maxMessageSize,timeouts:E,connectivityCheckParams:W,connectivityCheckUrl:V})}S.normaliseOptions=r,S.default=b;function l(i){return Object.assign(b,i)}S.getDefaults=l},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importDefault(g(3)),G=T.__importDefault(g(2)),D=T.__importDefault(g(4)),N=T.__importStar(g(1));function H(u){return!u||!u.channelOptions?{channelOptions:u,plugins:{},baseEncodedPreviousPayload:void 0}:u}function j(u){if(u&&u.cipher){if(!c.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var h=c.default.Crypto.getCipher(u.cipher);return{cipher:h.cipherParams,channelCipher:h.cipher}}return u??{}}function b(u){var h=0;return u.name&&(h+=u.name.length),u.clientId&&(h+=u.clientId.length),u.extras&&(h+=JSON.stringify(u.extras).length),u.data&&(h+=N.dataSizeBytes(u.data)),h}var M=function(){function u(){}return u.prototype.toJSON=function(){var h=this.encoding,P=this.data;return P&&c.default.BufferUtils.isBuffer(P)&&(arguments.length>0?(h=h?h+"/base64":"base64",P=c.default.BufferUtils.base64Encode(P)):P=c.default.BufferUtils.toBuffer(P)),{name:this.name,id:this.id,clientId:this.clientId,connectionId:this.connectionId,connectionKey:this.connectionKey,extras:this.extras,encoding:h,data:P}},u.prototype.toString=function(){var h="[Message";return this.name&&(h+="; name="+this.name),this.id&&(h+="; id="+this.id),this.timestamp&&(h+="; timestamp="+this.timestamp),this.clientId&&(h+="; clientId="+this.clientId),this.connectionId&&(h+="; connectionId="+this.connectionId),this.encoding&&(h+="; encoding="+this.encoding),this.extras&&(h+="; extras ="+JSON.stringify(this.extras)),this.data&&(typeof this.data=="string"?h+="; data="+this.data:c.default.BufferUtils.isBuffer(this.data)?h+="; data (buffer)="+c.default.BufferUtils.base64Encode(this.data):h+="; data (json)="+JSON.stringify(this.data)),this.extras&&(h+="; extras="+JSON.stringify(this.extras)),h+="]",h},u.encrypt=function(h,P,O){var d=h.data,p=h.encoding,C=P.channelCipher;p=p?p+"/":"",c.default.BufferUtils.isBuffer(d)||(d=c.default.BufferUtils.utf8Encode(String(d)),p=p+"utf-8/"),C.encrypt(d,function(s,a){if(s){O(s);return}h.data=a,h.encoding=p+"cipher+"+C.algorithm,O(null,h)})},u.encode=function(h,P,O){var d=h.data,p=typeof d=="string"||c.default.BufferUtils.isBuffer(d)||d===null||d===void 0;if(!p)if(N.isObject(d)||N.isArray(d))h.data=JSON.stringify(d),h.encoding=h.encoding?h.encoding+"/json":"json";else throw new D.default("Data type is unsupported",40013,400);P!=null&&P.cipher?u.encrypt(h,P,O):O(null,h)},u.encodeArray=function(h,P,O){for(var d=0,p=0;p<h.length;p++)u.encode(h[p],P,function(C){if(C){O(C);return}d++,d==h.length&&O(null,h)})},u.decode=function(h,P){var O=H(P),d=h.data,p=h.encoding;if(p){var C=p.split("/"),s=void 0,a=C.length,t=h.data,r="";try{for(;(s=a)>0;){var l=C[--a].match(/([-\w]+)(\+([\w-]+))?/);if(!l)break;switch(r=l[1],r){case"base64":t=c.default.BufferUtils.base64Decode(String(t)),s==C.length&&(d=t);continue;case"utf-8":t=c.default.BufferUtils.utf8Decode(t);continue;case"json":t=JSON.parse(t);continue;case"cipher":if(O.channelOptions!=null&&O.channelOptions.cipher&&O.channelOptions.channelCipher){var i=l[3],y=O.channelOptions.channelCipher;if(i!=y.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");t=y.decrypt(t);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!O.plugins||!O.plugins.vcdiff)throw new D.default("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new D.default("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{var U=O.baseEncodedPreviousPayload;typeof U=="string"&&(U=c.default.BufferUtils.utf8Encode(U)),U=c.default.BufferUtils.toBuffer(U),t=c.default.BufferUtils.toBuffer(t),t=c.default.BufferUtils.typedArrayToBuffer(O.plugins.vcdiff.decode(t,U)),d=t}catch(L){throw new D.default("Vcdiff delta decode failed with "+L,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(L){var w=L;throw new D.default("Error processing the "+r+" encoding, decoder returned ‘"+w.message+"’",w.code||40013,400)}finally{h.encoding=s<=0?null:C.slice(0,s).join("/"),h.data=t}}O.baseEncodedPreviousPayload=d},u.fromResponseBody=function(h,P,O){O&&(h=N.decodeBody(h,O));for(var d=0;d<h.length;d++){var p=h[d]=u.fromValues(h[d]);try{u.decode(p,P)}catch(C){G.default.logAction(G.default.LOG_ERROR,"Message.fromResponseBody()",C.toString())}}return h},u.fromValues=function(h){return Object.assign(new u,h)},u.fromValuesArray=function(h){for(var P=h.length,O=new Array(P),d=0;d<P;d++)O[d]=u.fromValues(h[d]);return O},u.fromEncoded=function(h,P){var O=u.fromValues(h),d=j(P??null);try{u.decode(O,d)}catch(p){G.default.logAction(G.default.LOG_ERROR,"Message.fromEncoded()",p.toString())}return O},u.fromEncodedArray=function(h,P){return h.map(function(O){return u.fromEncoded(O,P)})},u.getMessagesSize=function(h){for(var P,O=0,d=0;d<h.length;d++)P=h[d],O+=P.size||(P.size=b(P));return O},u.serialize=N.encodeBody,u}();S.default=M},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importStar(g(1)),G=T.__importDefault(g(4)),D=T.__importDefault(g(9)),N=T.__importDefault(g(15)),H={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18},j=[];Object.keys(H).forEach(function(O){j[H[O]]=O});var b={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19},M=Object.keys(b);b.MODE_ALL=b.PRESENCE|b.PUBLISH|b.SUBSCRIBE|b.PRESENCE_SUBSCRIBE;function u(O){var d=[];if(O)for(var p=0;p<O.length;p++)d.push(O[p].toString());return"[ "+d.join(", ")+" ]"}var h="id channel channelSerial connectionId count msgSerial timestamp".split(" "),P=function(){function O(){var d=this;this.hasFlag=function(p){return(d.flags&b[p])>0}}return O.prototype.setFlag=function(d){return this.flags=this.flags|b[d]},O.prototype.getMode=function(){return this.flags&&this.flags&b.MODE_ALL},O.prototype.encodeModesToFlags=function(d){var p=this;d.forEach(function(C){return p.setFlag(C)})},O.prototype.decodeModesFromFlags=function(){var d=this,p=[];return O.channelModes.forEach(function(C){d.hasFlag(C)&&p.push(C)}),p.length>0?p:void 0},O.fromValues=function(d){return Object.assign(new O,d)},O.Action=H,O.channelModes=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE"],O.ActionName=j,O.serialize=c.encodeBody,O.deserialize=function(d,p){var C=c.decodeBody(d,p);return O.fromDeserialized(C)},O.fromDeserialized=function(d){var p=d.error;p&&(d.error=G.default.fromValues(p));var C=d.messages;if(C)for(var s=0;s<C.length;s++)C[s]=D.default.fromValues(C[s]);var a=d.presence;if(a)for(var s=0;s<a.length;s++)a[s]=N.default.fromValues(a[s],!0);return Object.assign(new O,d)},O.stringify=function(d){var p="[ProtocolMessage";d.action!==void 0&&(p+="; action="+O.ActionName[d.action]||!1);for(var C,s=0;s<h.length;s++)C=h[s],d[C]!==void 0&&(p+="; "+C+"="+d[C]);if(d.messages&&(p+="; messages="+u(D.default.fromValuesArray(d.messages))),d.presence&&(p+="; presence="+u(N.default.fromValuesArray(d.presence))),d.error&&(p+="; error="+G.default.fromValues(d.error).toString()),d.auth&&d.auth.accessToken&&(p+="; token="+d.auth.accessToken),d.flags&&(p+="; flags="+M.filter(d.hasFlag).join(",")),d.params){var a="";c.forInOwnNonNullProperties(d.params,function(t){a.length>0&&(a+="; "),a+=t+"="+d.params[t]}),a.length>0&&(p+="; params=["+a+"]")}return p+="]",p},O}();S.default=P},function(ut,S,g){(function(T,c){ut.exports=c(g(6))})(this,function(T){return function(){var c=T,G=c.lib,D=G.WordArray,N=c.enc;N.Base64={stringify:function(j){var b=j.words,M=j.sigBytes,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";j.clamp();for(var h=[],P=0;P<M;P+=3)for(var O=b[P>>>2]>>>24-P%4*8&255,d=b[P+1>>>2]>>>24-(P+1)%4*8&255,p=b[P+2>>>2]>>>24-(P+2)%4*8&255,C=O<<16|d<<8|p,s=0;s<4&&P+s*.75<M;s++)h.push(u.charAt(C>>>6*(3-s)&63));var a=u.charAt(64);if(a)for(;h.length%4;)h.push(a);return h.join("")},parse:function(j){var b=j.length,M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=this._reverseMap;if(!u){u=this._reverseMap=[];for(var h=0;h<M.length;h++)u[M.charCodeAt(h)]=h}var P=M.charAt(64);if(P){var O=j.indexOf(P);O!==-1&&(b=O)}return H(j,b,u)}};function H(j,b,M){for(var u=[],h=0,P=0;P<b;P++)if(P%4){var O=M[j.charCodeAt(P-1)]<<P%4*2,d=M[j.charCodeAt(P)]>>>6-P%4*2,p=O|d;u[h>>>2]|=p<<24-h%4*8,h++}return D.create(u,h)}}(),T.enc.Base64})},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importStar(g(1)),G=T.__importDefault(g(10)),D=T.__importDefault(g(26)),N=T.__importDefault(g(2)),H=T.__importDefault(g(8)),j=T.__importDefault(g(20)),b=T.__importDefault(g(17)),M=T.__importDefault(g(4)),u=T.__importDefault(g(21)),h=T.__importDefault(g(3));function P(p){var C=[80015,80017,80030];return p.code?b.default.isTokenErr(p)?!1:c.arrIn(C,p.code)?!0:p.code>=4e4&&p.code<5e4:!1}function O(p){return P(p)?[G.default.fromValues({action:G.default.Action.ERROR,error:p})]:[G.default.fromValues({action:G.default.Action.DISCONNECTED,error:p})]}var d=function(p){T.__extends(C,p);function C(s,a,t){var r=p.call(this,s,a,t,!0)||this;return r.onAuthUpdated=function(l){r.authParams={access_token:l.token}},r.stream="stream"in t?t.stream:!0,r.sendRequest=null,r.recvRequest=null,r.pendingCallback=null,r.pendingItems=null,r}return C.prototype.connect=function(){var s=this;N.default.logAction(N.default.LOG_MINOR,"CometTransport.connect()","starting"),D.default.prototype.connect.call(this);var a=this.params,t=a.options,r=H.default.getHost(t,a.host),l=H.default.getPort(t),i=t.tls?"https://":"http://";this.baseUri=i+r+":"+l+"/comet/";var y=this.baseUri+"connect";N.default.logAction(N.default.LOG_MINOR,"CometTransport.connect()","uri: "+y),this.auth.getAuthParams(function(U,w){if(U){s.disconnect(U);return}if(!s.isDisposed){s.authParams=w;var L=s.params.getConnectParams(w);"stream"in L&&(s.stream=L.stream),N.default.logAction(N.default.LOG_MINOR,"CometTransport.connect()","connectParams:"+c.toQueryString(L));var x=!1,E=s.recvRequest=s.createRequest(y,null,L,null,s.stream?u.default.REQ_RECV_STREAM:u.default.REQ_RECV);E.on("data",function(A){s.recvRequest&&(x||(x=!0,s.emit("preconnect")),s.onData(A))}),E.on("complete",function(A){if(s.recvRequest||(A=A||new M.default("Request cancelled",80003,400)),s.recvRequest=null,!x&&!A&&(x=!0,s.emit("preconnect")),s.onActivity(),A){A.code?s.onData(O(A)):s.disconnect(A);return}h.default.Config.nextTick(function(){s.recv()})}),E.exec()}})},C.prototype.requestClose=function(){N.default.logAction(N.default.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)},C.prototype.requestDisconnect=function(){N.default.logAction(N.default.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)},C.prototype._requestCloseOrDisconnect=function(s){var a=this,t=s?this.closeUri:this.disconnectUri;if(t){var r=this.createRequest(t,null,this.authParams,null,u.default.REQ_SEND);r.on("complete",function(l){l&&(N.default.logAction(N.default.LOG_ERROR,"CometTransport.request"+(s?"Close()":"Disconnect()"),"request returned err = "+c.inspectError(l)),a.finish("disconnected",l))}),r.exec()}},C.prototype.dispose=function(){var s=this;N.default.logAction(N.default.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(N.default.logAction(N.default.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",j.default.disconnected()),h.default.Config.nextTick(function(){s.emit("disposed")}))},C.prototype.onConnect=function(s){var a;if(!this.isDisposed){var t=(a=s.connectionDetails)===null||a===void 0?void 0:a.connectionKey;D.default.prototype.onConnect.call(this,s);var r=this.baseUri+t;N.default.logAction(N.default.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+r),this.sendUri=r+"/send",this.recvUri=r+"/recv",this.closeUri=r+"/close",this.disconnectUri=r+"/disconnect"}},C.prototype.send=function(s){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(s);return}var a=this.pendingItems||[];a.push(s),this.pendingItems=null,this.sendItems(a)},C.prototype.sendAnyPending=function(){var s=this.pendingItems;s&&(this.pendingItems=null,this.sendItems(s))},C.prototype.sendItems=function(s){var a=this,t=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(s),u.default.REQ_SEND);t.on("complete",function(r,l){if(r&&N.default.logAction(N.default.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+c.inspectError(r)),a.sendRequest=null,r){r.code?a.onData(O(r)):a.disconnect(r);return}l&&a.onData(l),a.pendingItems&&h.default.Config.nextTick(function(){a.sendRequest||a.sendAnyPending()})}),t.exec()},C.prototype.recv=function(){var s=this;if(!this.recvRequest&&this.isConnected){var a=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?u.default.REQ_RECV_STREAM:u.default.REQ_RECV_POLL);a.on("data",function(t){s.onData(t)}),a.on("complete",function(t){if(s.recvRequest=null,s.onActivity(),t){t.code?s.onData(O(t)):s.disconnect(t);return}h.default.Config.nextTick(function(){s.recv()})}),a.exec()}},C.prototype.onData=function(s){try{var a=this.decodeResponse(s);if(a&&a.length)for(var t=0;t<a.length;t++)this.onProtocolMessage(G.default.fromDeserialized(a[t]))}catch(r){N.default.logAction(N.default.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+r.stack)}},C.prototype.encodeRequest=function(s){return JSON.stringify(s)},C.prototype.decodeResponse=function(s){return typeof s=="string"?JSON.parse(s):s},C}(D.default);S.default=d},function(ut,S){var g;g=function(){return this}();try{g=g||new Function("return this")()}catch{typeof window=="object"&&(g=window)}ut.exports=g},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importDefault(g(3)),G=T.__importStar(g(1)),D=T.__importDefault(g(2)),N=T.__importDefault(g(17)),H=T.__importDefault(g(18)),j=g(4);function b(d,p,C,s,a){d.http.supportsAuthHeaders?d.auth.getAuthHeaders(function(t,r){t?s(t):a(G.mixin(r,p),C)}):d.auth.getAuthParams(function(t,r){t?s(t):a(p,G.mixin(r,C))})}function M(d,p){return function(C,s,a,t,r){if(C&&!s){d(C);return}if(!t)try{s=G.decodeBody(s,p)}catch(L){G.isErrorInfoOrPartialErrorInfo(L)?d(L):d(new j.PartialErrorInfo(G.inspectError(L),null));return}if(!s){d(new j.PartialErrorInfo("unenvelope(): Response body is missing",null));return}var l=s,i=l.statusCode,y=l.response,U=l.headers;if(i===void 0){d(C,s,a,!0,r);return}if(i<200||i>=300){var w=y&&y.error||C;w||(w=new Error("Error in unenveloping "+s),w.statusCode=i),d(w,y,U,!0,i);return}d(C,y,U,!0,i)}}function u(d){var p=[];if(d)for(var C in d)p.push(C+"="+d[C]);return p.join("&")}function h(d,p){return d+(p?"?":"")+u(p)}function P(d,p,C,s){return function(a,t,r,l,i){a?D.default.logAction(D.default.LOG_MICRO,"Resource."+p+"()","Received Error; "+h(C,s)+"; Error: "+G.inspectError(a)):D.default.logAction(D.default.LOG_MICRO,"Resource."+p+"()","Received; "+h(C,s)+"; Headers: "+u(r)+"; StatusCode: "+i+"; Body: "+(c.default.BufferUtils.isBuffer(t)?t.toString():t)),d&&d(a,t,r,l,i)}}var O=function(){function d(){}return d.get=function(p,C,s,a,t,r){d.do(H.default.Get,p,C,null,s,a,t,r)},d.delete=function(p,C,s,a,t,r){d.do(H.default.Delete,p,C,null,s,a,t,r)},d.post=function(p,C,s,a,t,r,l){d.do(H.default.Post,p,C,s,a,t,r,l)},d.patch=function(p,C,s,a,t,r,l){d.do(H.default.Patch,p,C,s,a,t,r,l)},d.put=function(p,C,s,a,t,r,l){d.do(H.default.Put,p,C,s,a,t,r,l)},d.do=function(p,C,s,a,t,r,l,i){D.default.shouldLog(D.default.LOG_MICRO)&&(i=P(i,p,s,r)),l&&(i=i&&M(i,l),(r=r||{}).envelope=l);function y(U,w){var L;if(D.default.shouldLog(D.default.LOG_MICRO)&&D.default.logAction(D.default.LOG_MICRO,"Resource."+p+"()","Sending; "+h(s,w)),D.default.shouldLog(D.default.LOG_MICRO)){var x=a;if(((L=U["content-type"])===null||L===void 0?void 0:L.indexOf("msgpack"))>0)try{x=c.default.Config.msgpack.decode(a)}catch(E){D.default.logAction(D.default.LOG_MICRO,"Resource."+p+"()","Sending MsgPack Decoding Error: "+G.inspectError(E))}D.default.logAction(D.default.LOG_MICRO,"Resource."+p+"()","Sending; "+h(s,w)+"; Body: "+x)}C.http.do(p,C,s,U,a,w,function(E,A,W,V,X){if(E&&N.default.isTokenErr(E)){C.auth.authorize(null,null,function(ot){if(ot){i(ot);return}b(C,W,w,i,y)});return}i(E,A,W,V,X)})}b(C,t,r,i,y)},d}();S.default=O},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importDefault(g(2)),G=T.__importDefault(g(3)),D=T.__importDefault(g(9)),N=T.__importStar(g(1));function H(b){return j.Actions.indexOf(b)}var j=function(){function b(){}return b.prototype.isSynthesized=function(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId},b.prototype.parseId=function(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");var M=this.id.split(":");return{connectionId:M[0],msgSerial:parseInt(M[1],10),index:parseInt(M[2],10)}},b.prototype.toJSON=function(){var M=this.data,u=this.encoding;return M&&G.default.BufferUtils.isBuffer(M)&&(arguments.length>0?(u=u?u+"/base64":"base64",M=G.default.BufferUtils.base64Encode(M)):M=G.default.BufferUtils.toBuffer(M)),{id:this.id,clientId:this.clientId,action:H(this.action),data:M,encoding:u,extras:this.extras}},b.prototype.toString=function(){var M="[PresenceMessage";return M+="; action="+this.action,this.id&&(M+="; id="+this.id),this.timestamp&&(M+="; timestamp="+this.timestamp),this.clientId&&(M+="; clientId="+this.clientId),this.connectionId&&(M+="; connectionId="+this.connectionId),this.encoding&&(M+="; encoding="+this.encoding),this.data&&(typeof this.data=="string"?M+="; data="+this.data:G.default.BufferUtils.isBuffer(this.data)?M+="; data (buffer)="+G.default.BufferUtils.base64Encode(this.data):M+="; data (json)="+JSON.stringify(this.data)),this.extras&&(M+="; extras="+JSON.stringify(this.extras)),M+="]",M},b.fromResponseBody=function(M,u,h){var P=[];h&&(M=N.decodeBody(M,h));for(var O=0;O<M.length;O++){var d=P[O]=b.fromValues(M[O],!0);try{b.decode(d,u)}catch(p){c.default.logAction(c.default.LOG_ERROR,"PresenceMessage.fromResponseBody()",p.toString())}}return P},b.fromValues=function(M,u){return u&&(M.action=b.Actions[M.action]),Object.assign(new b,M)},b.fromValuesArray=function(M){for(var u=M.length,h=new Array(u),P=0;P<u;P++)h[P]=b.fromValues(M[P]);return h},b.fromEncoded=function(M,u){var h=b.fromValues(M,!0);try{b.decode(h,u??{})}catch(P){c.default.logAction(c.default.LOG_ERROR,"PresenceMessage.fromEncoded()",P.toString())}return h},b.fromEncodedArray=function(M,u){return M.map(function(h){return b.fromEncoded(h,u)})},b.fromData=function(M){return M instanceof b?M:b.fromValues({data:M})},b.Actions=["absent","present","enter","leave","update"],b.encode=D.default.encode,b.decode=D.default.decode,b.getMessagesSize=D.default.getMessagesSize,b}();S.default=j},function(ut,S,g){(function(T){Object.defineProperty(S,"__esModule",{value:!0});var c=g(0),G=c.__importStar(g(1)),D=c.__importDefault(g(7)),N=c.__importStar(g(4)),H=c.__importDefault(g(2)),j=c.__importDefault(g(8)),b=c.__importDefault(g(21)),M=c.__importDefault(g(3));function u(i,y){return G.arrIn(G.allToLowerCase(G.keysArray(y)),"x-ably-errorcode")}function h(i,y){if(u(i,y))return i.error&&N.default.fromValues(i.error)}var P=function(){},O=0,d={},p=typeof T<"u"&&T.XDomainRequest;function C(){var i=navigator.userAgent.toString().match(/MSIE\s([\d.]+)/);return i&&Number(i[1])}function s(){var i;return p&&(i=C())&&i===10}function a(i,y){return i.getResponseHeader&&i.getResponseHeader(y)}function t(i){return i.getResponseHeader&&(i.getResponseHeader("transfer-encoding")||!i.getResponseHeader("content-length"))}function r(i){for(var y=G.trim(i.getAllResponseHeaders()).split(`\r
`),U={},w=0;w<y.length;w++){var L=y[w].split(":").map(G.trim);U[L[0].toLowerCase()]=L[1]}return U}var l=function(i){c.__extends(y,i);function y(U,w,L,x,E,A,W){var V=i.call(this)||this;return L=L||{},L.rnd=G.cheapRandStr(),s()&&!L.envelope&&(L.envelope="json"),V.uri=U+G.toQueryString(L),V.headers=w||{},V.body=x,V.method=W?W.toUpperCase():G.isEmptyArg(x)?"GET":"POST",V.requestMode=E,V.timeouts=A,V.timedOut=!1,V.requestComplete=!1,V.id=String(++O),d[V.id]=V,V}return y.createRequest=function(U,w,L,x,E,A,W){var V=A||j.default.TIMEOUTS;return new y(U,w,G.copy(L),x,E,V,W)},y.prototype.complete=function(U,w,L,x,E){this.requestComplete||(this.requestComplete=!0,!U&&w&&this.emit("data",w),this.emit("complete",U,w,L,x,E),this.dispose())},y.prototype.abort=function(){this.dispose()},y.prototype.exec=function(){var U=this,w=this.headers,L=this.requestMode==b.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,x=this.timer=setTimeout(function(){U.timedOut=!0,A.abort()},L),E=this.method,A=this.xhr=new XMLHttpRequest,W=w.accept,V=this.body,X="text";if(W?W.indexOf("application/x-msgpack")===0&&(X="arraybuffer"):w.accept="application/json",V){var ot=w["content-type"]||(w["content-type"]="application/json");ot.indexOf("application/json")>-1&&typeof V!="string"&&(V=JSON.stringify(V))}A.open(E,this.uri,!0),A.responseType=X,"authorization"in w&&(A.withCredentials=!0);for(var at in w)A.setRequestHeader(at,w[at]);var $=function(vt,Ht,Ft,Tt){var Nt,Zt=Ht+" (event type: "+vt.type+")";!((Nt=U==null?void 0:U.xhr)===null||Nt===void 0)&&Nt.statusText&&(Zt+=", current statusText is "+U.xhr.statusText),H.default.logAction(H.default.LOG_ERROR,"Request.on"+vt.type+"()",Zt),U.complete(new N.PartialErrorInfo(Zt,Ft,Tt))};A.onerror=function(vt){$(vt,"XHR error occurred",null,400)},A.onabort=function(vt){U.timedOut?$(vt,"Request aborted due to request timeout expiring",null,408):$(vt,"Request cancelled",null,400)},A.ontimeout=function(vt){$(vt,"Request timed out",null,408)};var R,B,k,z=0,et=!1,ct=function(){if(clearTimeout(x),k=B<400,B==204){U.complete(null,null,null,null,B);return}R=U.requestMode==b.default.REQ_RECV_STREAM&&k&&t(A)},dt=function(){var vt;try{var Ht=a(A,"content-type"),Ft=Ht?Ht.indexOf("application/json")>=0:A.responseType=="text";if(Ft){var Tt=A.responseType==="arraybuffer"?M.default.BufferUtils.utf8Decode(A.response):String(A.responseText);Tt.length?vt=JSON.parse(Tt):vt=Tt,et=!0}else vt=A.response;vt.response!==void 0?(B=vt.statusCode,k=B<400,w=vt.headers,vt=vt.response):w=r(A)}catch(Zt){U.complete(new N.PartialErrorInfo("Malformed response body from server: "+Zt.message,null,400));return}if(k||G.isArray(vt)){U.complete(null,vt,w,et,B);return}var Nt=h(vt,w);Nt||(Nt=new N.PartialErrorInfo("Error response received from server: "+B+" body was: "+M.default.Config.inspect(vt),null,B)),U.complete(Nt,vt,w,et,B)};function Ot(){for(var vt=A.responseText,Ht=vt.length-1,Ft,Tt;z<Ht&&(Ft=vt.indexOf(`
`,z))>-1;)Tt=vt.slice(z,Ft),z=Ft+1,St(Tt)}var St=function(vt){try{vt=JSON.parse(vt)}catch(Ht){U.complete(new N.PartialErrorInfo("Malformed response body from server: "+Ht.message,null,400));return}U.emit("data",vt)},Mt=function(){Ot(),U.streamComplete=!0,M.default.Config.nextTick(function(){U.complete()})};A.onreadystatechange=function(){var vt=A.readyState;vt<3||A.status!==0&&(B===void 0&&(B=A.status,B===1223&&(B=204),ct()),vt==3&&R?Ot():vt==4&&(R?Mt():dt()))},A.send(V)},y.prototype.dispose=function(){var U=this.xhr;if(U){U.onreadystatechange=U.onerror=U.onabort=U.ontimeout=P,this.xhr=null;var w=this.timer;w&&(clearTimeout(w),this.timer=null),this.requestComplete||U.abort()}delete d[this.id]},y}(D.default);S.default=l}).call(this,g(13))},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importDefault(g(2)),G=T.__importStar(g(1)),D=T.__importDefault(g(23)),N=T.__importDefault(g(4)),H=T.__importDefault(g(45)),j=g(11),b=T.__importDefault(g(18)),M=T.__importDefault(g(25)),u=T.__importDefault(g(3)),h=T.__importDefault(g(14)),P=Math.pow(2,17);function O(){}function d(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function p(L){return!!L.connection}function C(L){return G.isErrorInfoOrPartialErrorInfo(L)?(L.code||(L.statusCode===403?L.code=40300:(L.code=40170,L.statusCode=401)),L):new N.default(G.inspectError(L),L.code||40170,L.statusCode||401)}var s=function(L,x){if(u.default.Config.createHmac){var E=u.default.Config.createHmac("SHA256",x);return E.update(L),E.digest("base64")}return(0,j.stringify)((0,H.default)(L,x))};function a(L){if(!L)return"";typeof L=="string"&&(L=JSON.parse(L));var x=Object.create(null),E=G.keysArray(L,!0);if(!E)return"";E.sort();for(var A=0;A<E.length;A++)x[E[A]]=L[E[A]].sort();return JSON.stringify(x)}function t(L){if(L.authCallback)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with authCallback");else if(L.authUrl)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with authUrl");else if(L.key)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(L.tokenDetails)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with supplied token only");else{var x="authOptions must include valid authentication parameters";throw c.default.logAction(c.default.LOG_ERROR,"Auth()",x),new Error(x)}}function r(L){return"useTokenAuth"in L&&!L.useTokenAuth}function l(L){return L.useTokenAuth||!r(L)&&(L.authCallback||L.authUrl||L.token||L.tokenDetails)}function i(L){return!L.key&&!L.authCallback&&!L.authUrl}var y=0;function U(){return y++}var w=function(){function L(x,E){if(this.authOptions={},this.client=x,this.tokenParams=E.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,l(E)){if(E.key&&!s){var A="client-side token request signing not supported";throw c.default.logAction(c.default.LOG_ERROR,"Auth()",A),new Error(A)}i(E)&&c.default.logAction(c.default.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(E.defaultTokenParams,E),t(this.authOptions)}else{if(!E.key){var A="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw c.default.logAction(c.default.LOG_ERROR,"Auth()",A),new N.default(A,40160,401)}c.default.logAction(c.default.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(E)}}return L.prototype.authorize=function(x,E,A){var W=this,V;if(typeof x=="function"&&!A?(A=x,V=x=null):typeof E=="function"&&!A?(A=E,V=null):V=E,!A&&this.client.options.promises)return G.promisify(this,"authorize",arguments);if(V&&V.key&&this.authOptions.key!==V.key)throw new N.default("Unable to update auth options with incompatible key",40102,401);V&&"force"in V&&(c.default.logAction(c.default.LOG_ERROR,"Auth.authorize","Deprecation warning: specifying {force: true} in authOptions is no longer necessary, authorize() now always gets a new token. Please remove this, as in version 1.0 and later, having a non-null authOptions will overwrite stored library authOptions, which may not be what you want"),G.isOnlyPropIn(V,"force")&&(V=null)),this._forceNewToken(x,V,function(X,ot){if(X){W.client.connection&&X.statusCode===M.default.Forbidden&&W.client.connection.connectionManager.actOnErrorFromAuthorize(X),A==null||A(X);return}p(W.client)?W.client.connection.connectionManager.onAuthUpdated(ot,A||O):A==null||A(null,ot)})},L.prototype.authorise=function(x,E,A){c.default.deprecated("Auth.authorise","Auth.authorize"),this.authorize(x,E,A)},L.prototype._forceNewToken=function(x,E,A){var W=this;this.tokenDetails=null,this._saveTokenOptions(x,E),t(this.authOptions),this._ensureValidAuthCredentials(!0,function(V,X){delete W.tokenParams.timestamp,delete W.authOptions.queryTime,A(V,X)})},L.prototype.requestToken=function(x,E,A){var W=this;if(typeof x=="function"&&!A?(A=x,E=x=null):typeof E=="function"&&!A&&(A=E,E=null),!A&&this.client.options.promises)return G.promisify(this,"requestToken",arguments);E=E||this.authOptions,x=x||G.copy(this.tokenParams);var V=A||O,X,ot=this.client;if(E.authCallback)c.default.logAction(c.default.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),X=E.authCallback;else if(E.authUrl)c.default.logAction(c.default.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),X=function(z,et){var ct=G.mixin({accept:"application/json, text/plain"},E.authHeaders),dt=E.authMethod&&E.authMethod.toLowerCase()==="post",Ot,St=E.authUrl.indexOf("?");St>-1&&(Ot=G.parseQueryString(E.authUrl.slice(St)),E.authUrl=E.authUrl.slice(0,St),dt||(E.authParams=G.mixin(Ot,E.authParams)));var Mt=G.mixin({},E.authParams||{},z),vt=function(Tt,Nt,Zt,ve){var te;if(Tt?c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+G.inspectError(Tt)):(te=Zt["content-type"],c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+te+"; body: "+G.inspectBody(Nt))),Tt||ve)return et(Tt,Nt);if(u.default.BufferUtils.isBuffer(Nt)&&(Nt=Nt.toString()),!te){et(new N.default("authUrl response is missing a content-type header",40170,401));return}var Qt=te.indexOf("application/json")>-1,de=te.indexOf("text/plain")>-1||te.indexOf("application/jwt")>-1;if(!Qt&&!de){et(new N.default("authUrl responded with unacceptable content-type "+te+", should be either text/plain, application/jwt or application/json",40170,401));return}if(Qt){if(Nt.length>P){et(new N.default("authUrl response exceeded max permitted length",40170,401));return}try{Nt=JSON.parse(Nt)}catch(he){et(new N.default("Unexpected error processing authURL response; err = "+he.message,40170,401));return}}et(null,Nt,te)};if(c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+E.authUrl+"; Params: "+JSON.stringify(Mt)+"; method: "+(dt?"POST":"GET")),dt){var Ht=ct||{};Ht["content-type"]="application/x-www-form-urlencoded";var Ft=G.toQueryString(Mt).slice(1);W.client.http.doUri(b.default.Post,ot,E.authUrl,Ht,Ft,Ot,vt)}else W.client.http.doUri(b.default.Get,ot,E.authUrl,ct||{},null,Mt,vt)};else if(E.key)c.default.logAction(c.default.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),X=function(z,et){W.createTokenRequest(z,E,et)};else{var at="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";c.default.logAction(c.default.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),V(new N.default(at,40171,403));return}"capability"in x&&(x.capability=a(x.capability));var $=function(z,et){var ct=z.keyName,dt="/keys/"+ct+"/requestToken",Ot=function(Mt){return ot.baseUri(Mt)+dt},St=G.defaultPostHeaders(W.client.options);E.requestHeaders&&G.mixin(St,E.requestHeaders),c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+dt+"; Token params: "+JSON.stringify(z)),W.client.http.do(b.default.Post,ot,Ot,St,JSON.stringify(z),null,et)},R=!1,B=this.client.options.timeouts.realtimeRequestTimeout,k=setTimeout(function(){R=!0;var z="Token request callback timed out after "+B/1e3+" seconds";c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()",z),V(new N.default(z,40170,401))},B);X(x,function(z,et,ct){if(!R){if(clearTimeout(k),z){c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+G.inspectError(z)),V(C(z));return}if(typeof et=="string"){et.length===0?V(new N.default("Token string is empty",40170,401)):et.length>P?V(new N.default("Token string exceeded max permitted length (was "+et.length+" bytes)",40170,401)):et==="undefined"||et==="null"?V(new N.default("Token string was literal null/undefined",40170,401)):et[0]==="{"&&!(ct&&ct.indexOf("application/jwt")>-1)?V(new N.default("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):V(null,{token:et});return}if(typeof et!="object"){var dt="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof et;c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()",dt),V(new N.default(dt,40170,401));return}var Ot=JSON.stringify(et).length;if(Ot>P&&!E.suppressMaxLengthCheck){V(new N.default("Token request/details object exceeded max permitted stringified size (was "+Ot+" bytes)",40170,401));return}if("issued"in et){V(null,et);return}if(!("keyName"in et)){var dt="Expected token request callback to call back with a token string, token request object, or token details object";c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()",dt),V(new N.default(dt,40170,401));return}$(et,function(St,Mt,vt,Ht){if(St){c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+G.inspectError(St)),V(C(St));return}Ht||(Mt=JSON.parse(Mt)),c.default.logAction(c.default.LOG_MINOR,"Auth.getToken()","token received"),V(null,Mt)})}})},L.prototype.createTokenRequest=function(x,E,A){var W=this;if(typeof x=="function"&&!A?(A=x,E=x=null):typeof E=="function"&&!A&&(A=E,E=null),!A&&this.client.options.promises)return G.promisify(this,"createTokenRequest",arguments);E=E||this.authOptions,x=x||G.copy(this.tokenParams);var V=E.key;if(!V){A(new N.default("No key specified",40101,403));return}var X=V.split(":"),ot=X[0],at=X[1];if(!at){A(new N.default("Invalid key specified",40101,403));return}if(x.clientId===""){A(new N.default("clientId can’t be an empty string",40012,400));return}"capability"in x&&(x.capability=a(x.capability));var $=G.mixin({keyName:ot},x),R=x.clientId||"",B=x.ttl||"",k=x.capability||"";(function(z){if($.timestamp){z();return}W.getTimestamp(E&&E.queryTime,function(et,ct){if(et){A(et);return}$.timestamp=ct,z()})})(function(){var z=$.nonce||($.nonce=d()),et=$.timestamp,ct=$.keyName+`
`+B+`
`+k+`
`+R+`
`+et+`
`+z+`
`;$.mac=$.mac||s(ct,at),c.default.logAction(c.default.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),A(null,$)})},L.prototype.getAuthParams=function(x){this.method=="basic"?x(null,{key:this.key}):this._ensureValidAuthCredentials(!1,function(E,A){if(E){x(E);return}if(!A)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");x(null,{access_token:A.token})})},L.prototype.getAuthHeaders=function(x){this.method=="basic"?x(null,{authorization:"Basic "+this.basicKey}):this._ensureValidAuthCredentials(!1,function(E,A){if(E){x(E);return}if(!A)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");x(null,{authorization:"Bearer "+G.toBase64(A.token)})})},L.prototype.getTimestamp=function(x,E){!this.isTimeOffsetSet()&&(x||this.authOptions.queryTime)?this.client.time(E):E(null,this.getTimestampUsingOffset())},L.prototype.getTimestampUsingOffset=function(){return G.now()+(this.client.serverTimeOffset||0)},L.prototype.isTimeOffsetSet=function(){return this.client.serverTimeOffset!==null},L.prototype._saveBasicOptions=function(x){this.method="basic",this.key=x.key,this.basicKey=G.toBase64(x.key),this.authOptions=x||{},"clientId"in x&&this._userSetClientId(x.clientId)},L.prototype._saveTokenOptions=function(x,E){this.method="token",x&&(this.tokenParams=x),E&&(E.token&&(E.tokenDetails=typeof E.token=="string"?{token:E.token}:E.token),E.tokenDetails&&(this.tokenDetails=E.tokenDetails),"clientId"in E&&this._userSetClientId(E.clientId),this.authOptions=E)},L.prototype._ensureValidAuthCredentials=function(x,E){var A=this,W=this.tokenDetails;if(W){if(this._tokenClientIdMismatch(W.clientId)){E(new N.default("Mismatch between clientId in token ("+W.clientId+") and current clientId ("+this.clientId+")",40102,403));return}if(!this.isTimeOffsetSet()||!W.expires||W.expires>=this.getTimestampUsingOffset()){c.default.logAction(c.default.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+W.expires),E(null,W);return}c.default.logAction(c.default.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}if((this.waitingForTokenRequest||(this.waitingForTokenRequest=D.default.create())).push(E),!(this.currentTokenRequestId!==null&&!x)){var V=this.currentTokenRequestId=U();this.requestToken(this.tokenParams,this.authOptions,function(X,ot){if(A.currentTokenRequestId>V){c.default.logAction(c.default.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one");return}A.currentTokenRequestId=null;var at=A.waitingForTokenRequest||O;if(A.waitingForTokenRequest=null,X){at(X);return}at(null,A.tokenDetails=ot)})}},L.prototype._userSetClientId=function(x){if(typeof x=="string"||x===null){if(x==="*")throw new N.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);var E=this._uncheckedSetClientId(x);if(E)throw E}else throw new N.default("clientId must be either a string or null",40012,400)},L.prototype._uncheckedSetClientId=function(x){if(this._tokenClientIdMismatch(x)){var E="Unexpected clientId mismatch: client has "+this.clientId+", requested "+x,A=new N.default(E,40102,401);return c.default.logAction(c.default.LOG_ERROR,"Auth._uncheckedSetClientId()",E),A}else return this.clientId=this.tokenParams.clientId=x,null},L.prototype._tokenClientIdMismatch=function(x){return!!(this.clientId&&this.clientId!=="*"&&x&&x!=="*"&&this.clientId!==x)},L.isTokenErr=function(x){return x.code&&x.code>=40140&&x.code<40150},L.prototype.revokeTokens=function(x,E,A){if(l(this.client.options))throw new N.default("Cannot revoke tokens when using token auth",40162,401);var W=this.client.options.keyName,V;if(typeof E=="function"?(A=E,V={}):V=E??{},A===void 0){if(this.client.options.promises)return G.promisify(this,"revokeTokens",[x,V]);A=O}var X=A,ot=T.__assign({targets:x.map(function(B){return"".concat(B.type,":").concat(B.value)})},V),at=this.client.options.useBinaryProtocol?G.Format.msgpack:G.Format.json,$=G.defaultPostHeaders(this.client.options,at);this.client.options.headers&&G.mixin($,this.client.options.headers);var R=G.encodeBody(ot,at);h.default.post(this.client,"/keys/".concat(W,"/revokeTokens"),R,$,{newBatchResponse:"true"},null,function(B,k,z,et){if(B){X(B);return}var ct=et?k:G.decodeBody(k,at);X(null,ct)})},L}();S.default=w},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T;(function(c){c.Get="get",c.Delete="delete",c.Post="post",c.Put="put",c.Patch="patch"})(T||(T={})),S.default=T},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0}),S.HttpPaginatedResponse=S.PaginatedResult=void 0;var T=g(0),c=T.__importStar(g(1)),G=T.__importDefault(g(2)),D=T.__importDefault(g(14));function N(h){var P=h.match(/^\.\/(\w+)\?(.*)$/);return P&&P[2]&&c.parseQueryString(P[2])}function H(h){typeof h=="string"&&(h=h.split(","));for(var P={},O=0;O<h.length;O++){var d=h[O].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(d){var p=N(d[1]);p&&(P[d[2]]=p)}}return P}function j(h,P,O){return!(O&&(P||typeof h.code=="number"))}var b=function(){function h(P,O,d,p,C,s){this.rest=P,this.path=O,this.headers=d,this.envelope=p??null,this.bodyHandler=C,this.useHttpPaginatedResponse=s||!1}return h.prototype.get=function(P,O){var d=this;D.default.get(this.rest,this.path,this.headers,P,this.envelope,function(p,C,s,a,t){d.handlePage(p,C,s,a,t,O)})},h.prototype.delete=function(P,O){var d=this;D.default.delete(this.rest,this.path,this.headers,P,this.envelope,function(p,C,s,a,t){d.handlePage(p,C,s,a,t,O)})},h.prototype.post=function(P,O,d){var p=this;D.default.post(this.rest,this.path,O,this.headers,P,this.envelope,function(C,s,a,t,r){d&&p.handlePage(C,s,a,t,r,d)})},h.prototype.put=function(P,O,d){var p=this;D.default.put(this.rest,this.path,O,this.headers,P,this.envelope,function(C,s,a,t,r){d&&p.handlePage(C,s,a,t,r,d)})},h.prototype.patch=function(P,O,d){var p=this;D.default.patch(this.rest,this.path,O,this.headers,P,this.envelope,function(C,s,a,t,r){d&&p.handlePage(C,s,a,t,r,d)})},h.prototype.handlePage=function(P,O,d,p,C,s){if(P&&j(P,O,this.useHttpPaginatedResponse)){G.default.logAction(G.default.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+c.inspectError(P)),s==null||s(P);return}var a,t,r;try{a=this.bodyHandler(O,d||{},p)}catch(l){s==null||s(P||l);return}d&&(t=d.Link||d.link)&&(r=H(t)),this.useHttpPaginatedResponse?s(null,new u(this,a,d||{},C,r,P)):s(null,new M(this,a,r))},h}(),M=function(){function h(P,O,d){var p=this;this.resource=P,this.items=O;var C=this;d&&("first"in d&&(this.first=function(s){if(!s&&C.resource.rest.options.promises)return c.promisify(C,"first",[]);C.get(d.first,s)}),"current"in d&&(this.current=function(s){if(!s&&C.resource.rest.options.promises)return c.promisify(C,"current",[]);C.get(d.current,s)}),this.next=function(s){if(!s&&C.resource.rest.options.promises)return c.promisify(C,"next",[]);"next"in d?C.get(d.next,s):s(null)},this.hasNext=function(){return"next"in d},this.isLast=function(){var s;return!(!((s=p.hasNext)===null||s===void 0)&&s.call(p))})}return h.prototype.get=function(P,O){var d=this.resource;D.default.get(d.rest,d.path,d.headers,P,d.envelope,function(p,C,s,a,t){d.handlePage(p,C,s,a,t,O)})},h}();S.PaginatedResult=M;var u=function(h){T.__extends(P,h);function P(O,d,p,C,s,a){var t=h.call(this,O,d,s)||this;return t.statusCode=C,t.success=C<300&&C>=200,t.headers=p,t.errorCode=a&&a.code,t.errorMessage=a&&a.message,t}return P.prototype.toJSON=function(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}},P}(M);S.HttpPaginatedResponse=u,S.default=b},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0}),S.isRetriable=void 0;var T=g(0),c=T.__importDefault(g(4)),G={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},D={disconnected:function(){return c.default.fromValues({statusCode:400,code:G.DISCONNECTED,message:"Connection to server temporarily unavailable"})},suspended:function(){return c.default.fromValues({statusCode:400,code:G.SUSPENDED,message:"Connection to server unavailable"})},failed:function(){return c.default.fromValues({statusCode:400,code:G.FAILED,message:"Connection failed or disconnected by server"})},closing:function(){return c.default.fromValues({statusCode:400,code:G.CLOSING,message:"Connection closing"})},closed:function(){return c.default.fromValues({statusCode:400,code:G.CLOSED,message:"Connection closed"})},unknownConnectionErr:function(){return c.default.fromValues({statusCode:500,code:G.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"})},unknownChannelErr:function(){return c.default.fromValues({statusCode:500,code:G.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})}};function N(H){return!H.statusCode||!H.code||H.statusCode>=500?!0:Object.values(G).includes(H.code)}S.isRetriable=N,S.default=D},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T;(function(c){c[c.REQ_SEND=0]="REQ_SEND",c[c.REQ_RECV=1]="REQ_RECV",c[c.REQ_RECV_POLL=2]="REQ_RECV_POLL",c[c.REQ_RECV_STREAM=3]="REQ_RECV_STREAM"})(T||(T={})),S.default=T},function(ut,S,g){(function(T,c){ut.exports=c(g(6),g(5),g(58),g(11),g(40),g(32),g(24),g(27),g(28),g(59),g(60))})(this,function(T){return T})},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importDefault(g(2)),G=function(){function D(N){this.members=N||[]}return D.prototype.call=function(){for(var N=[],H=0;H<arguments.length;H++)N[H]=arguments[H];for(var j=0,b=this.members;j<b.length;j++){var M=b[j];if(M)try{M.apply(void 0,N)}catch(u){c.default.logAction(c.default.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+u+"; stack = "+u.stack)}}},D.prototype.push=function(){for(var N,H=[],j=0;j<arguments.length;j++)H[j]=arguments[j];(N=this.members).push.apply(N,H)},D.create=function(N){var H=new D(N);return Object.assign(function(){for(var j=[],b=0;b<arguments.length;b++)j[b]=arguments[b];return H.call.apply(H,j)},{push:function(j){return H.push(j)}})},D}();S.default=G},function(ut,S,g){(function(T,c){ut.exports=c(g(6))})(this,function(T){(function(){var c=T,G=c.lib,D=G.Base,N=c.enc,H=N.Utf8,j=c.algo;j.HMAC=D.extend({init:function(b,M){b=this._hasher=new b.init,typeof M=="string"&&(M=H.parse(M));var u=b.blockSize,h=u*4;M.sigBytes>h&&(M=b.finalize(M)),M.clamp();for(var P=this._oKey=M.clone(),O=this._iKey=M.clone(),d=P.words,p=O.words,C=0;C<u;C++)d[C]^=1549556828,p[C]^=909522486;P.sigBytes=O.sigBytes=h,this.reset()},reset:function(){var b=this._hasher;b.reset(),b.update(this._iKey)},update:function(b){return this._hasher.update(b),this},finalize:function(b){var M=this._hasher,u=M.finalize(b);M.reset();var h=M.finalize(this._oKey.clone().concat(u));return h}})})()})},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0}),S.isSuccessCode=void 0;var T;(function(G){G[G.Success=200]="Success",G[G.NoContent=204]="NoContent",G[G.BadRequest=400]="BadRequest",G[G.Unauthorized=401]="Unauthorized",G[G.Forbidden=403]="Forbidden",G[G.RequestTimeout=408]="RequestTimeout",G[G.InternalServerError=500]="InternalServerError"})(T||(T={}));function c(G){return G>=T.Success&&G<T.BadRequest}S.isSuccessCode=c,S.default=T},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importDefault(g(10)),G=T.__importStar(g(1)),D=T.__importDefault(g(7)),N=T.__importDefault(g(2)),H=T.__importDefault(g(20)),j=T.__importDefault(g(4)),b=T.__importDefault(g(3)),M=c.default.Action,u=c.default.fromValues({action:M.CLOSE}),h=c.default.fromValues({action:M.DISCONNECT}),P=function(O){T.__extends(d,O);function d(p,C,s,a){var t=O.call(this)||this;return a&&(s.format=void 0,s.heartbeats=!0),t.connectionManager=p,p.registerProposedTransport(t),t.auth=C,t.params=s,t.timeouts=s.options.timeouts,t.format=s.format,t.isConnected=!1,t.isFinished=!1,t.isDisposed=!1,t.maxIdleInterval=null,t.idleTimer=null,t.lastActivity=null,t}return d.prototype.connect=function(){},d.prototype.close=function(){this.isConnected&&this.requestClose(),this.finish("closed",H.default.closed())},d.prototype.disconnect=function(p){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",p||H.default.disconnected())},d.prototype.fail=function(p){this.isConnected&&this.requestDisconnect(),this.finish("failed",p||H.default.failed())},d.prototype.finish=function(p,C){var s;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((s=this.idleTimer)!==null&&s!==void 0?s:void 0),this.idleTimer=null,this.emit(p,C),this.dispose())},d.prototype.onProtocolMessage=function(p){switch(N.default.shouldLog(N.default.LOG_MICRO)&&N.default.logAction(N.default.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+c.default.stringify(p)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),p.action){case M.HEARTBEAT:N.default.logAction(N.default.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",p.id);break;case M.CONNECTED:this.onConnect(p),this.emit("connected",p.error,p.connectionId,p.connectionDetails,p);break;case M.CLOSED:this.onClose(p);break;case M.DISCONNECTED:this.onDisconnect(p);break;case M.ACK:this.emit("ack",p.msgSerial,p.count);break;case M.NACK:this.emit("nack",p.msgSerial,p.count,p.error);break;case M.SYNC:this.connectionManager.onChannelMessage(p,this);break;case M.ACTIVATE:break;case M.AUTH:this.auth.authorize(function(C){C&&N.default.logAction(N.default.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+G.inspectError(C))});break;case M.ERROR:if(N.default.logAction(N.default.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+b.default.Config.inspect(p.error)+(p.channel?", channel: "+p.channel:"")),p.channel===void 0){this.onFatalError(p);break}this.connectionManager.onChannelMessage(p,this);break;default:this.connectionManager.onChannelMessage(p,this)}},d.prototype.onConnect=function(p){if(this.isConnected=!0,!p.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");var C=p.connectionDetails.maxIdleInterval;C&&(this.maxIdleInterval=C+this.timeouts.realtimeRequestTimeout,this.onActivity())},d.prototype.onDisconnect=function(p){var C=p&&p.error;N.default.logAction(N.default.LOG_MINOR,"Transport.onDisconnect()","err = "+G.inspectError(C)),this.finish("disconnected",C)},d.prototype.onFatalError=function(p){var C=p&&p.error;N.default.logAction(N.default.LOG_MINOR,"Transport.onFatalError()","err = "+G.inspectError(C)),this.finish("failed",C)},d.prototype.onClose=function(p){var C=p&&p.error;N.default.logAction(N.default.LOG_MINOR,"Transport.onClose()","err = "+G.inspectError(C)),this.finish("closed",C)},d.prototype.requestClose=function(){N.default.logAction(N.default.LOG_MINOR,"Transport.requestClose()",""),this.send(u)},d.prototype.requestDisconnect=function(){N.default.logAction(N.default.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(h)},d.prototype.ping=function(p){var C={action:c.default.Action.HEARTBEAT};p&&(C.id=p),this.send(c.default.fromValues(C))},d.prototype.dispose=function(){N.default.logAction(N.default.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()},d.prototype.onActivity=function(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=G.now(),this.setIdleTimer(this.maxIdleInterval+100))},d.prototype.setIdleTimer=function(p){var C=this;this.idleTimer||(this.idleTimer=setTimeout(function(){C.onIdleTimerExpire()},p))},d.prototype.onIdleTimerExpire=function(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;var p=G.now()-this.lastActivity,C=this.maxIdleInterval-p;if(C<=0){var s="No activity seen from realtime in "+p+"ms; assuming connection has dropped";N.default.logAction(N.default.LOG_ERROR,"Transport.onIdleTimerExpire()",s),this.disconnect(new j.default(s,80003,408))}else this.setIdleTimer(C+100)},d.tryConnect=function(p,C,s,a,t){var r=new p(C,s,a),l,i=function(U){clearTimeout(l),t({event:this.event,error:U})},y=C.options.timeouts.realtimeRequestTimeout;l=setTimeout(function(){r.off(["preconnect","disconnected","failed"]),r.dispose(),i.call({event:"disconnected"},new j.default("Timeout waiting for transport to indicate itself viable",5e4,500))},y),r.on(["failed","disconnected"],i),r.on("preconnect",function(){N.default.logAction(N.default.LOG_MINOR,"Transport.tryConnect()","viable transport "+r),clearTimeout(l),r.off(["failed","disconnected"],i),t(null,r)}),r.connect()},d}(D.default);S.default=P},function(ut,S,g){(function(T,c){ut.exports=c(g(6),g(40),g(24))})(this,function(T){return function(){var c=T,G=c.lib,D=G.Base,N=G.WordArray,H=c.algo,j=H.MD5,b=H.EvpKDF=D.extend({cfg:D.extend({keySize:128/32,hasher:j,iterations:1}),init:function(M){this.cfg=this.cfg.extend(M)},compute:function(M,u){for(var h,P=this.cfg,O=P.hasher.create(),d=N.create(),p=d.words,C=P.keySize,s=P.iterations;p.length<C;){h&&O.update(h),h=O.update(M).finalize(u),O.reset();for(var a=1;a<s;a++)h=O.finalize(h),O.reset();d.concat(h)}return d.sigBytes=C*4,d}});c.EvpKDF=function(M,u,h){return b.create(h).compute(M,u)}}(),T.EvpKDF})},function(ut,S,g){(function(T,c){ut.exports=c(g(6),g(27))})(this,function(T){T.lib.Cipher||function(c){var G=T,D=G.lib,N=D.Base,H=D.WordArray,j=D.BufferedBlockAlgorithm,b=G.enc;b.Utf8;var M=b.Base64,u=G.algo,h=u.EvpKDF,P=D.Cipher=j.extend({cfg:N.extend(),createEncryptor:function(w,L){return this.create(this._ENC_XFORM_MODE,w,L)},createDecryptor:function(w,L){return this.create(this._DEC_XFORM_MODE,w,L)},init:function(w,L,x){this.cfg=this.cfg.extend(x),this._xformMode=w,this._key=L,this.reset()},reset:function(){j.reset.call(this),this._doReset()},process:function(w){return this._append(w),this._process()},finalize:function(w){w&&this._append(w);var L=this._doFinalize();return L},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function w(L){return typeof L=="string"?U:l}return function(L){return{encrypt:function(x,E,A){return w(E).encrypt(L,x,E,A)},decrypt:function(x,E,A){return w(E).decrypt(L,x,E,A)}}}}()});D.StreamCipher=P.extend({_doFinalize:function(){var w=this._process(!0);return w},blockSize:1});var O=G.mode={},d=D.BlockCipherMode=N.extend({createEncryptor:function(w,L){return this.Encryptor.create(w,L)},createDecryptor:function(w,L){return this.Decryptor.create(w,L)},init:function(w,L){this._cipher=w,this._iv=L}}),p=O.CBC=function(){var w=d.extend();w.Encryptor=w.extend({processBlock:function(x,E){var A=this._cipher,W=A.blockSize;L.call(this,x,E,W),A.encryptBlock(x,E),this._prevBlock=x.slice(E,E+W)}}),w.Decryptor=w.extend({processBlock:function(x,E){var A=this._cipher,W=A.blockSize,V=x.slice(E,E+W);A.decryptBlock(x,E),L.call(this,x,E,W),this._prevBlock=V}});function L(x,E,A){var W,V=this._iv;V?(W=V,this._iv=c):W=this._prevBlock;for(var X=0;X<A;X++)x[E+X]^=W[X]}return w}(),C=G.pad={},s=C.Pkcs7={pad:function(w,L){for(var x=L*4,E=x-w.sigBytes%x,A=E<<24|E<<16|E<<8|E,W=[],V=0;V<E;V+=4)W.push(A);var X=H.create(W,E);w.concat(X)},unpad:function(w){var L=w.words[w.sigBytes-1>>>2]&255;w.sigBytes-=L}};D.BlockCipher=P.extend({cfg:P.cfg.extend({mode:p,padding:s}),reset:function(){var w;P.reset.call(this);var L=this.cfg,x=L.iv,E=L.mode;this._xformMode==this._ENC_XFORM_MODE?w=E.createEncryptor:(w=E.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==w?this._mode.init(this,x&&x.words):(this._mode=w.call(E,this,x&&x.words),this._mode.__creator=w)},_doProcessBlock:function(w,L){this._mode.processBlock(w,L)},_doFinalize:function(){var w,L=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(L.pad(this._data,this.blockSize),w=this._process(!0)):(w=this._process(!0),L.unpad(w)),w},blockSize:128/32});var a=D.CipherParams=N.extend({init:function(w){this.mixIn(w)},toString:function(w){return(w||this.formatter).stringify(this)}}),t=G.format={},r=t.OpenSSL={stringify:function(w){var L,x=w.ciphertext,E=w.salt;return E?L=H.create([1398893684,1701076831]).concat(E).concat(x):L=x,L.toString(M)},parse:function(w){var L,x=M.parse(w),E=x.words;return E[0]==1398893684&&E[1]==1701076831&&(L=H.create(E.slice(2,4)),E.splice(0,4),x.sigBytes-=16),a.create({ciphertext:x,salt:L})}},l=D.SerializableCipher=N.extend({cfg:N.extend({format:r}),encrypt:function(w,L,x,E){E=this.cfg.extend(E);var A=w.createEncryptor(x,E),W=A.finalize(L),V=A.cfg;return a.create({ciphertext:W,key:x,iv:V.iv,algorithm:w,mode:V.mode,padding:V.padding,blockSize:w.blockSize,formatter:E.format})},decrypt:function(w,L,x,E){E=this.cfg.extend(E),L=this._parse(L,E.format);var A=w.createDecryptor(x,E).finalize(L.ciphertext);return A},_parse:function(w,L){return typeof w=="string"?L.parse(w,this):w}}),i=G.kdf={},y=i.OpenSSL={execute:function(w,L,x,E){E||(E=H.random(64/8));var A=h.create({keySize:L+x}).compute(w,E),W=H.create(A.words.slice(L),x*4);return A.sigBytes=L*4,a.create({key:A,iv:W,salt:E})}},U=D.PasswordBasedCipher=l.extend({cfg:l.cfg.extend({kdf:y}),encrypt:function(w,L,x,E){E=this.cfg.extend(E);var A=E.kdf.execute(x,w.keySize,w.ivSize);E.iv=A.iv;var W=l.encrypt.call(this,w,L,A.key,E);return W.mixIn(A),W},decrypt:function(w,L,x,E){E=this.cfg.extend(E),L=this._parse(L,E.format);var A=E.kdf.execute(x,w.keySize,w.ivSize,L.salt);E.iv=A.iv;var W=l.decrypt.call(this,w,L,A.key,E);return W}})}()})},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0}),S.Request=S.createRequest=void 0;var T=g(0),c=T.__importStar(g(1)),G=T.__importDefault(g(12)),D=T.__importDefault(g(3)),N=T.__importDefault(g(7)),H=g(4),j=T.__importDefault(g(8)),b=T.__importDefault(g(2)),M=T.__importDefault(g(21)),u=c.getGlobalObject(),h=function(){},P=u._ablyjs_jsonp={};P._=function(t){return P["_"+t]||h};var O=1,d="jsonp";function p(t,r,l,i,y,U,w){return U=U||j.default.TIMEOUTS,new s(void 0,t,r,c.copy(l),i,y,U,w)}S.createRequest=p;var C=function(t){T.__extends(r,t);function r(l,i,y){var U=t.call(this,l,i,y)||this;return U.shortName=d,y.stream=!1,U}return r.isAvailable=function(){return D.default.Config.jsonpSupported&&D.default.Config.allowComet},r.prototype.toString=function(){return"JSONPTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},r.prototype.createRequest=function(l,i,y,U,w,L,x){return L=(this===null||this===void 0?void 0:this.timeouts)||L||j.default.TIMEOUTS,p(l,i,y,U,w,L,x)},r}(G.default),s=function(t){T.__extends(r,t);function r(l,i,y,U,w,L,x,E){var A=t.call(this)||this;return l===void 0&&(l=O++),A.id=l,A.uri=i,A.params=U||{},A.params.rnd=c.cheapRandStr(),y&&(y["X-Ably-Version"]&&(A.params.v=y["X-Ably-Version"]),y["X-Ably-Lib"]&&(A.params.lib=y["X-Ably-Lib"])),A.body=w,A.method=E,A.requestMode=L,A.timeouts=x,A.requestComplete=!1,A}return r.prototype.exec=function(){var l=this,i=this.id,y=this.body,U=this.method,w=this.uri,L=this.params;L.callback="_ablyjs_jsonp._("+i+")",L.envelope="jsonp",y&&(L.body=y),U&&U!=="get"&&(L.method=U);var x=this.script=document.createElement("script"),E=w+c.toQueryString(L);x.src=E,x.src.split("/").slice(-1)[0]!==E.split("/").slice(-1)[0]&&b.default.logAction(b.default.LOG_ERROR,"JSONP Request.exec()","Warning: the browser appears to have truncated the script URI. This will likely result in the request failing due to an unparseable body param"),x.async=!0,x.type="text/javascript",x.charset="UTF-8",x.onerror=function(V){l.complete(new H.PartialErrorInfo("JSONP script error (event: "+D.default.Config.inspect(V)+")",null,400))},P["_"+i]=function(V){if(V.statusCode){var X=V.response;if(V.statusCode==204)l.complete(null,null,null,V.statusCode);else if(!X)l.complete(new H.PartialErrorInfo("Invalid server response: no envelope detected",null,500));else if(V.statusCode<400||c.isArray(X))l.complete(null,X,V.headers,V.statusCode);else{var ot=X.error||new H.PartialErrorInfo("Error response received from server",null,V.statusCode);l.complete(ot)}}else l.complete(null,V)};var A=this.requestMode==M.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout;this.timer=setTimeout(this.abort.bind(this),A);var W=document.getElementsByTagName("head")[0];W.insertBefore(x,W.firstChild)},r.prototype.complete=function(l,i,y,U){if(y=y||{},!this.requestComplete){this.requestComplete=!0;var w=void 0;i&&(w=typeof i=="string"?"text/plain":"application/json",y["content-type"]=w,this.emit("data",i)),this.emit("complete",l,i,y,!0,U),this.dispose()}},r.prototype.abort=function(){this.dispose()},r.prototype.dispose=function(){var l=this.timer;l&&(clearTimeout(l),this.timer=null);var i=this.script;i.parentNode&&i.parentNode.removeChild(i),delete P[this.id],this.emit("disposed")},r}(N.default);S.Request=s;function a(t){return u.JSONPTransport=C,C.isAvailable()&&(t.supportedTransports[d]=C),C}S.default=a},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importStar(g(1)),G=T.__importDefault(g(2)),D=T.__importDefault(g(8)),N=T.__importDefault(g(17)),H=T.__importDefault(g(46)),j=T.__importDefault(g(19)),b=T.__importDefault(g(33)),M=T.__importDefault(g(4)),u=T.__importDefault(g(49)),h=T.__importDefault(g(18)),P=T.__importDefault(g(3)),O=T.__importDefault(g(9)),d=T.__importDefault(g(15)),p=T.__importDefault(g(14)),C=function(){},s=function(){function t(r){if(!r){var l="no options provided";throw G.default.logAction(G.default.LOG_ERROR,"Rest()",l),new Error(l)}var i=D.default.objectifyOptions(r);i.log&&G.default.setLog(i.log.level,i.log.handler),G.default.logAction(G.default.LOG_MICRO,"Rest()","initialized with clientOptions "+P.default.Config.inspect(r));var y=this.options=D.default.normaliseOptions(i);if(y.key){var U=y.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!U){var l="invalid key parameter";throw G.default.logAction(G.default.LOG_ERROR,"Rest()",l),new M.default(l,40400,404)}y.keyName=U[1],y.keySecret=U[2]}if("clientId"in y)if(typeof y.clientId=="string"||y.clientId===null){if(y.clientId==="*")throw new M.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new M.default("clientId must be either a string or null",40012,400);G.default.logAction(G.default.LOG_MINOR,"Rest()","started; version = "+D.default.version),this.baseUri=this.authority=function(w){return D.default.getHttpScheme(y)+w+":"+D.default.getPort(y,!1)},this._currentFallback=null,this.serverTimeOffset=null,this.http=new P.default.Http(y),this.auth=new N.default(this,y),this.channels=new a(this),this.push=new H.default(this)}return t.prototype.stats=function(r,l){if(l===void 0)if(typeof r=="function")l=r,r=null;else{if(this.options.promises)return c.promisify(this,"stats",[r]);l=C}var i=c.defaultGetHeaders(this.options),y=this.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,U=this.http.supportsLinkHeaders?void 0:y;this.options.headers&&c.mixin(i,this.options.headers),new j.default(this,"/stats",i,U,function(w,L,x){for(var E=x?w:JSON.parse(w),A=0;A<E.length;A++)E[A]=u.default.fromValues(E[A]);return E}).get(r,l)},t.prototype.time=function(r,l){var i=this;if(l===void 0){if(typeof r=="function")l=r,r=null;else if(this.options.promises)return c.promisify(this,"time",[r])}var y=l||C,U=c.defaultGetHeaders(this.options);this.options.headers&&c.mixin(U,this.options.headers);var w=function(L){return i.authority(L)+"/time"};this.http.do(h.default.Get,this,w,U,null,r,function(L,x,E,A){if(L){y(L);return}A||(x=JSON.parse(x));var W=x[0];if(!W){y(new M.default("Internal error (unexpected result type from GET /time)",5e4,500));return}i.serverTimeOffset=W-c.now(),y(null,W)})},t.prototype.request=function(r,l,i,y,U,w){var L=this.options.useBinaryProtocol,x=L?P.default.Config.msgpack.encode:JSON.stringify,E=L?P.default.Config.msgpack.decode:JSON.parse,A=L?c.Format.msgpack:c.Format.json,W=this.http.supportsLinkHeaders?void 0:A;i=i||{};var V=r.toLowerCase(),X=V=="get"?c.defaultGetHeaders(this.options,A):c.defaultPostHeaders(this.options,A);if(w===void 0){if(this.options.promises)return c.promisify(this,"request",[r,l,i,y,U]);w=C}typeof y!="string"&&(y=x(y)),this.options.headers&&c.mixin(X,this.options.headers),U&&c.mixin(X,U);var ot=new j.default(this,l,X,W,function(at,$,R){return c.ensureArray(R?at:E(at))},!0);if(!c.arrIn(P.default.Http.methods,V))throw new M.default("Unsupported method "+V,40500,405);c.arrIn(P.default.Http.methodsWithBody,V)?ot[V](i,y,w):ot[V](i,w)},t.prototype.batchPublish=function(r,l){if(l===void 0){if(this.options.promises)return c.promisify(this,"batchPublish",[r]);l=C}var i=l,y,U;c.isArray(r)?(y=r,U=!1):(y=[r],U=!0);var w=this.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,L=c.defaultPostHeaders(this.options,w);this.options.headers&&c.mixin(L,this.options.headers);var x=c.encodeBody(y,w);p.default.post(this,"/messages",x,L,{newBatchResponse:"true"},null,function(E,A,W,V){if(E){i(E);return}var X=V?A:c.decodeBody(A,w);U?i(null,X[0]):i(null,X)})},t.prototype.batchPresence=function(r,l){if(l===void 0){if(this.options.promises)return c.promisify(this,"batchPresence",[r]);l=C}var i=l,y=this.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,U=c.defaultPostHeaders(this.options,y);this.options.headers&&c.mixin(U,this.options.headers);var w=r.join(",");p.default.get(this,"/presence",U,{newBatchResponse:"true",channels:w},null,function(L,x,E,A){if(L){i(L);return}var W=A?x:c.decodeBody(x,y);i(null,W)})},t.prototype.setLog=function(r){G.default.setLog(r.level,r.handler)},t.Promise=function(r){return r=D.default.objectifyOptions(r),r.promises=!0,new t(r)},t.Callbacks=t,t.Platform=P.default,t.Message=O.default,t.PresenceMessage=d.default,t}(),a=function(){function t(r){this.rest=r,this.all=Object.create(null)}return t.prototype.get=function(r,l){r=String(r);var i=this.all[r];return i?l&&i.setOptions(l):this.all[r]=i=new b.default(this.rest,r,l),i},t.prototype.release=function(r){delete this.all[String(r)]},t}();S.default=s},function(ut,S,g){(function(T,c){ut.exports=c(g(6))})(this,function(T){return T.enc.Utf8})},function(ut,S,g){(function(T,c){ut.exports=c(g(6))})(this,function(T){return function(c){var G=T,D=G.lib,N=D.WordArray,H=D.Hasher,j=G.algo,b=[],M=[];(function(){function P(C){for(var s=c.sqrt(C),a=2;a<=s;a++)if(!(C%a))return!1;return!0}function O(C){return(C-(C|0))*4294967296|0}for(var d=2,p=0;p<64;)P(d)&&(p<8&&(b[p]=O(c.pow(d,1/2))),M[p]=O(c.pow(d,1/3)),p++),d++})();var u=[],h=j.SHA256=H.extend({_doReset:function(){this._hash=new N.init(b.slice(0))},_doProcessBlock:function(P,O){for(var d=this._hash.words,p=d[0],C=d[1],s=d[2],a=d[3],t=d[4],r=d[5],l=d[6],i=d[7],y=0;y<64;y++){if(y<16)u[y]=P[O+y]|0;else{var U=u[y-15],w=(U<<25|U>>>7)^(U<<14|U>>>18)^U>>>3,L=u[y-2],x=(L<<15|L>>>17)^(L<<13|L>>>19)^L>>>10;u[y]=w+u[y-7]+x+u[y-16]}var E=t&r^~t&l,A=p&C^p&s^C&s,W=(p<<30|p>>>2)^(p<<19|p>>>13)^(p<<10|p>>>22),V=(t<<26|t>>>6)^(t<<21|t>>>11)^(t<<7|t>>>25),X=i+V+E+M[y]+u[y],ot=W+A;i=l,l=r,r=t,t=a+X|0,a=s,s=C,C=p,p=X+ot|0}d[0]=d[0]+p|0,d[1]=d[1]+C|0,d[2]=d[2]+s|0,d[3]=d[3]+a|0,d[4]=d[4]+t|0,d[5]=d[5]+r|0,d[6]=d[6]+l|0,d[7]=d[7]+i|0},_doFinalize:function(){var P=this._data,O=P.words,d=this._nDataBytes*8,p=P.sigBytes*8;return O[p>>>5]|=128<<24-p%32,O[(p+64>>>9<<4)+14]=c.floor(d/4294967296),O[(p+64>>>9<<4)+15]=d,P.sigBytes=O.length*4,this._process(),this._hash},clone:function(){var P=H.clone.call(this);return P._hash=this._hash.clone(),P}});G.SHA256=H._createHelper(h),G.HmacSHA256=H._createHmacHelper(h)}(Math),T.SHA256})},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importStar(g(1)),G=T.__importDefault(g(7)),D=T.__importDefault(g(2)),N=T.__importDefault(g(34)),H=T.__importDefault(g(9)),j=T.__importDefault(g(4)),b=T.__importDefault(g(19)),M=T.__importDefault(g(14)),u=T.__importDefault(g(3));function h(){}var P=9;function O(C){return c.arrEvery(C,function(s){return!s.id})}function d(C){var s=C||{};if(s.cipher){if(!u.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var a=u.default.Crypto.getCipher(s.cipher);s.cipher=a.cipherParams,s.channelCipher=a.cipher}else"cipher"in s&&(s.cipher=void 0,s.channelCipher=null);return s}var p=function(C){T.__extends(s,C);function s(a,t,r){var l=C.call(this)||this;return D.default.logAction(D.default.LOG_MINOR,"Channel()","started; name = "+t),l.rest=a,l.name=t,l.basePath="/channels/"+encodeURIComponent(t),l.presence=new N.default(l),l.channelOptions=d(r),l}return s.prototype.setOptions=function(a){this.channelOptions=d(a)},s.prototype.history=function(a,t){if(D.default.logAction(D.default.LOG_MICRO,"Channel.history()","channel = "+this.name),t===void 0)if(typeof a=="function")t=a,a=null;else{if(this.rest.options.promises)return c.promisify(this,"history",arguments);t=h}this._history(a,t)},s.prototype._history=function(a,t){var r=this.rest,l=r.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,i=this.rest.http.supportsLinkHeaders?void 0:l,y=c.defaultGetHeaders(r.options,l);r.options.headers&&c.mixin(y,r.options.headers);var U=this.channelOptions;new b.default(r,this.basePath+"/messages",y,i,function(w,L,x){return H.default.fromResponseBody(w,U,x?void 0:l)}).get(a,t)},s.prototype.publish=function(){var a=this,t=arguments.length,r=arguments[0],l=arguments[1],i=arguments[t-1],y,U;if(typeof i!="function"){if(this.rest.options.promises)return c.promisify(this,"publish",arguments);i=h}if(typeof r=="string"||r===null)y=[H.default.fromValues({name:r,data:l})],U=arguments[2];else if(c.isObject(r))y=[H.default.fromValues(r)],U=arguments[1];else if(c.isArray(r))y=H.default.fromValuesArray(r),U=arguments[1];else throw new j.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);(typeof U!="object"||!U)&&(U={});var w=this.rest,L=w.options,x=L.useBinaryProtocol?c.Format.msgpack:c.Format.json,E=w.options.idempotentRestPublishing,A=c.defaultPostHeaders(w.options,x);if(L.headers&&c.mixin(A,L.headers),E&&O(y)){var W=c.randomString(P);c.arrForEach(y,function(V,X){V.id=W+":"+X.toString()})}H.default.encodeArray(y,this.channelOptions,function(V){if(V){i(V);return}var X=H.default.getMessagesSize(y),ot=L.maxMessageSize;if(X>ot){i(new j.default("Maximum size of messages that can be published at once exceeded ( was "+X+" bytes; limit is "+ot+" bytes)",40009,400));return}a._publish(H.default.serialize(y,x),A,U,i)})},s.prototype._publish=function(a,t,r,l){M.default.post(this.rest,this.basePath+"/messages",a,t,r,null,l)},s.prototype.status=function(a){if(typeof a!="function"&&this.rest.options.promises)return c.promisify(this,"status",[]);var t=this.rest.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,r=c.defaultPostHeaders(this.rest.options,t);M.default.get(this.rest,this.basePath,r,{},t,a||h)},s}(G.default);S.default=p},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importStar(g(1)),G=T.__importDefault(g(7)),D=T.__importDefault(g(2)),N=T.__importDefault(g(19)),H=T.__importDefault(g(15));function j(){}var b=function(M){T.__extends(u,M);function u(h){var P=M.call(this)||this;return P.channel=h,P.basePath=h.basePath+"/presence",P}return u.prototype.get=function(h,P){if(D.default.logAction(D.default.LOG_MICRO,"Presence.get()","channel = "+this.channel.name),P===void 0)if(typeof h=="function")P=h,h=null;else{if(this.channel.rest.options.promises)return c.promisify(this,"get",arguments);P=j}var O=this.channel.rest,d=O.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,p=this.channel.rest.http.supportsLinkHeaders?void 0:d,C=c.defaultGetHeaders(O.options,d);O.options.headers&&c.mixin(C,O.options.headers);var s=this.channel.channelOptions;new N.default(O,this.basePath,C,p,function(a,t,r){return H.default.fromResponseBody(a,s,r?void 0:d)}).get(h,P)},u.prototype.history=function(h,P){return D.default.logAction(D.default.LOG_MICRO,"Presence.history()","channel = "+this.channel.name),this._history(h,P)},u.prototype._history=function(h,P){if(P===void 0)if(typeof h=="function")P=h,h=null;else{if(this.channel.rest.options.promises)return c.promisify(this,"_history",[h]);P=j}var O=this.channel.rest,d=O.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,p=this.channel.rest.http.supportsLinkHeaders?void 0:d,C=c.defaultGetHeaders(O.options,d);O.options.headers&&c.mixin(C,O.options.headers);var s=this.channel.channelOptions;new N.default(O,this.basePath+"/history",C,p,function(a,t,r){return H.default.fromResponseBody(a,s,r?void 0:d)}).get(h,P)},u}(G.default);S.default=b},function(ut,S,g){(function(T){Object.defineProperty(S,"__esModule",{value:!0}),S.TransportParams=void 0;var c=g(0),G=c.__importDefault(g(10)),D=c.__importStar(g(1)),N=c.__importStar(g(52)),H=c.__importStar(g(8)),j=c.__importDefault(g(3)),b=c.__importDefault(g(7)),M=c.__importDefault(g(36)),u=c.__importDefault(g(2)),h=c.__importDefault(g(37)),P=c.__importStar(g(20)),O=c.__importStar(g(4)),d=c.__importDefault(g(17)),p=c.__importDefault(g(9)),C=c.__importDefault(g(23)),s=c.__importDefault(g(53)),a=c.__importDefault(g(26)),t=c.__importDefault(g(25)),r=function(){var at;return typeof j.default.WebStorage<"u"&&((at=j.default.WebStorage)===null||at===void 0?void 0:at.localSupported)},l=function(){var at;return typeof j.default.WebStorage<"u"&&((at=j.default.WebStorage)===null||at===void 0?void 0:at.sessionSupported)},i=G.default.Action,y=function(){},U="ably-transport-preference",w="ably-connection-recovery";function L(){var at,$;return l()&&(($=(at=j.default.WebStorage)===null||at===void 0?void 0:at.getSession)===null||$===void 0?void 0:$.call(at,w))}function x(at){var $,R;return l()&&((R=($=j.default.WebStorage)===null||$===void 0?void 0:$.setSession)===null||R===void 0?void 0:R.call($,w,at))}function E(){var at,$;return l()&&(($=(at=j.default.WebStorage)===null||at===void 0?void 0:at.removeSession)===null||$===void 0?void 0:$.call(at,w))}function A(at,$){return D.arrIndexOf(j.default.Defaults.transportPreferenceOrder,at.shortName)>D.arrIndexOf(j.default.Defaults.transportPreferenceOrder,$.shortName)}function W(at,$,R){var B;if(at.channel!==$.channel||(B=at.action)!==i.PRESENCE&&B!==i.MESSAGE||B!==$.action)return!1;var k=B===i.PRESENCE?"presence":"messages",z=at[k].concat($[k]),et=p.default.getMessagesSize(z);return et>R||!D.allSame(z,"clientId")||!D.arrEvery(z,function(ct){return!ct.id})?!1:(at[k]=z,!0)}function V(at){try{return JSON.parse(at)}catch{return null}}var X=function(){function at($,R,B,k){this.options=$,this.host=R,this.mode=B,this.connectionKey=k,this.format=$.useBinaryProtocol?D.Format.msgpack:D.Format.json}return at.prototype.getConnectParams=function($){var R=$?D.copy($):{},B=this.options;switch(this.mode){case"upgrade":R.upgrade=this.connectionKey;break;case"resume":R.resume=this.connectionKey;break;case"recover":{var k=V(B.recover);k&&(R.recover=k.connectionKey);break}}return B.clientId!==void 0&&(R.clientId=B.clientId),B.echoMessages===!1&&(R.echo="false"),this.format!==void 0&&(R.format=this.format),this.stream!==void 0&&(R.stream=this.stream),this.heartbeats!==void 0&&(R.heartbeats=this.heartbeats),R.v=H.default.protocolVersion,R.agent=(0,H.getAgentString)(this.options),B.transportParams!==void 0&&D.mixin(R,B.transportParams),R},at.prototype.toString=function(){var $="[mode="+this.mode;return this.host&&($+=",host="+this.host),this.connectionKey&&($+=",connectionKey="+this.connectionKey),this.format&&($+=",format="+this.format),$+="]",$},at}();S.TransportParams=X;var ot=function(at){c.__extends($,at);function $(R,B){var k=at.call(this)||this;k.disconnectedRetryCount=0,$.initTransports(),k.realtime=R,k.options=B;var z=B.timeouts,et=z.preferenceConnectTimeout+z.realtimeRequestTimeout;if(k.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:et,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},synchronizing:{state:"connected",terminal:!1,queueEvents:!0,sendEvents:!1,forceQueueEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:z.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:z.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:z.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},k.state=k.states.initialized,k.errorReason=null,k.queuedMessages=new M.default,k.msgSerial=0,k.connectionDetails=void 0,k.connectionId=void 0,k.connectionKey=void 0,k.connectionStateTtl=z.connectionStateTtl,k.maxIdleInterval=null,k.transports=D.intersect(B.transports||H.default.defaultTransports,$.supportedTransports),k.baseTransport=D.intersect(H.default.baseTransportOrder,k.transports)[0],k.upgradeTransports=D.intersect(k.transports,H.default.upgradeTransports),k.transportPreference=null,k.httpHosts=H.default.getHosts(B),k.activeProtocol=null,k.proposedTransports=[],k.pendingTransports=[],k.host=null,k.lastAutoReconnectAttempt=null,k.lastActivity=null,k.forceFallbackHost=!1,k.connectCounter=0,u.default.logAction(u.default.LOG_MINOR,"Realtime.ConnectionManager()","started"),u.default.logAction(u.default.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(B.transports||H.default.defaultTransports)+"]"),u.default.logAction(u.default.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+k.transports+"]"),u.default.logAction(u.default.LOG_MICRO,"Realtime.ConnectionManager()","http hosts = ["+k.httpHosts+"]"),!k.transports.length){var ct="no requested transports available";throw u.default.logAction(u.default.LOG_ERROR,"realtime.ConnectionManager()",ct),new Error(ct)}var dt=j.default.Config.addEventListener;return dt&&(l()&&typeof B.recover=="function"&&dt("beforeunload",k.persistConnection.bind(k)),B.closeOnUnload===!0&&dt("beforeunload",function(){u.default.logAction(u.default.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),k.requestState({state:"closing"})}),dt("online",function(){k.state==k.states.disconnected||k.state==k.states.suspended?(u.default.logAction(u.default.LOG_MINOR,"ConnectionManager caught browser ‘online’ event","reattempting connection"),k.requestState({state:"connecting"})):k.state==k.states.connecting&&(k.pendingTransports.forEach(function(Ot){Ot.off()}),k.disconnectAllTransports(),k.startConnect())}),dt("offline",function(){k.state==k.states.connected&&(u.default.logAction(u.default.LOG_MINOR,"ConnectionManager caught browser ‘offline’ event","disconnecting active transport"),k.disconnectAllTransports())})),k}return $.initTransports=function(){(0,s.default)($),D.arrForEach(j.default.Transports,function(R){R($)})},$.prototype.createTransportParams=function(R,B){return new X(this.options,R,B,this.connectionKey)},$.prototype.getTransportParams=function(R){var B=this,k=function(z){if(B.connectionKey){z("resume");return}if(typeof B.options.recover=="string"){z("recover");return}var et=B.options.recover,ct=L();if(ct&&typeof et=="function"){u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data"),et(ct,function(dt){dt?(B.options.recover=ct.recoveryKey,z("recover")):z("clean")});return}z("clean")};k(function(z){var et=B.createTransportParams(null,z);if(z==="recover"){u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+B.options.recover);var ct=V(B.options.recover);ct&&(B.msgSerial=ct.msgSerial)}else u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+et.toString());R(et)})},$.prototype.tryATransport=function(R,B,k){var z=this;u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+B),a.default.tryConnect($.supportedTransports[B],this,this.realtime.auth,R,function(et,ct){var dt=z.state;if(dt==z.states.closing||dt==z.states.closed||dt==z.states.failed){ct&&(u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+dt.state+" while we were attempting the transport; closing "+ct),ct.close()),k(!0);return}if(et){u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+B+" "+et.event+", err: "+et.error.toString()),d.default.isTokenErr(et.error)&&!(z.errorReason&&d.default.isTokenErr(z.errorReason))?(z.errorReason=et.error,z.realtime.auth._forceNewToken(null,null,function(Ot){if(Ot){z.actOnErrorFromAuthorize(Ot);return}z.tryATransport(R,B,k)})):et.event==="failed"?(z.notifyState({state:"failed",error:et.error}),k(!0)):et.event==="disconnected"&&((0,P.isRetriable)(et.error)?k(!1):(z.notifyState({state:z.states.connecting.failState,error:et.error}),k(!0)));return}u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+B+"; setting pending"),z.setTransportPending(ct,R),k(null,ct)})},$.prototype.setTransportPending=function(R,B){var k=this,z=B.mode;u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+R+"; mode = "+z),D.arrDeleteValue(this.proposedTransports,R),this.pendingTransports.push(R);var et=j.default.Defaults.transportPreferenceOrder[j.default.Defaults.transportPreferenceOrder.length-1];R.once("connected",function(dt,Ot,St){z=="upgrade"&&k.activeProtocol?R.shortName!==et&&D.arrIn(k.getUpgradePossibilities(),et)&&k.activeProtocol?setTimeout(function(){k.scheduleTransportActivation(dt,R,Ot,St)},k.options.timeouts.parallelUpgradeDelay):k.scheduleTransportActivation(dt,R,Ot,St):(k.activateTransport(dt,R,Ot,St),j.default.Config.nextTick(function(){k.connectImpl(B)})),z==="recover"&&k.options.recover&&(k.options.recover=null,k.unpersistConnection())});var ct=this;R.on(["disconnected","closed","failed"],function(dt){ct.deactivateTransport(R,this.event,dt)}),this.emit("transport.pending",R)},$.prototype.scheduleTransportActivation=function(R,B,k,z){var et=this,ct=this.activeProtocol&&this.activeProtocol.getTransport(),dt=function(){B.disconnect(),D.arrDeleteValue(et.pendingTransports,B)};if(this.state!==this.states.connected&&this.state!==this.states.connecting){u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+B.shortName),dt();return}if(ct&&!A(B,ct)){u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+B.shortName+" is no better than current active transport "+ct.shortName+" - abandoning upgrade"),dt();return}u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Scheduling transport upgrade; transport = "+B);var Ot=null;if(!B.isConnected){u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+B.shortName+"is no longer connected; abandoning upgrade"),dt();return}if(this.state===this.states.connected)u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Currently connected, so temporarily pausing events until the upgrade is complete"),this.state=this.states.synchronizing,Ot=this.activeProtocol;else if(this.state!==this.states.connecting){u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+B.shortName),dt();return}u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Syncing transport; transport = "+B);var St=function(){u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Activating transport; transport = "+B),B.send(G.default.fromValues({action:i.ACTIVATE})),et.activateTransport(R,B,k,z),et.state===et.states.synchronizing?(u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, sending queued messages on upgraded transport; transport = "+B),et.state=et.states.connected):u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, but state is now "+et.state.state+", so leaving unchanged"),et.state.sendEvents&&et.sendQueuedMessages()};Ot?Ot.onceIdle(St):St()},$.prototype.activateTransport=function(R,B,k,z){var et=this;u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+B),R&&u.default.logAction(u.default.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+R),k&&u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+k),z&&u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(z)),this.persistTransportPreference(B);var ct=this.state,dt=this.states.connected.state;if(u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+ct.state),ct.state==this.states.closing.state||ct.state==this.states.closed.state||ct.state==this.states.failed.state)return u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),B.disconnect(),!1;if(D.arrDeleteValue(this.pendingTransports,B),!B.isConnected)return u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+B+" since it appears to no longer be connected"),!1;var Ot=this.activeProtocol;this.activeProtocol=new N.default(B),this.host=B.params.host;var St=z.connectionKey;if(St&&this.connectionKey!=St&&this.setConnection(k,z,!!R),this.onConnectionDetailsUpdate(z,B),j.default.Config.nextTick(function(){B.on("connected",function(vt,Ht,Ft){et.onConnectionDetailsUpdate(Ft,B),et.emit("update",new h.default(dt,dt,null,vt))})}),ct.state===this.states.connected.state?R&&(this.errorReason=this.realtime.connection.errorReason=R,this.emit("update",new h.default(dt,dt,null,R))):(this.notifyState({state:"connected",error:R}),this.errorReason=this.realtime.connection.errorReason=R||null),this.emit("transport.active",B),Ot)if(Ot.messageQueue.count()>0&&u.default.logAction(u.default.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+Ot.transport.shortName+", new one is "+B.shortName+") finishing with "+Ot.messageQueue.count()+" messages still pending"),Ot.transport===B){var Mt="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+B.shortName+"; stack = "+new Error().stack;u.default.logAction(u.default.LOG_ERROR,"ConnectionManager.activateTransport()",Mt)}else Ot.finish();return D.safeArrForEach(this.pendingTransports,function(vt){if(vt===B){var Ht="Assumption violated: activating a transport that is still marked as a pending transport; transport = "+B.shortName+"; stack = "+new Error().stack;u.default.logAction(u.default.LOG_ERROR,"ConnectionManager.activateTransport()",Ht),D.arrDeleteValue(et.pendingTransports,B)}else vt.disconnect()}),D.safeArrForEach(this.proposedTransports,function(vt){vt===B?(u.default.logAction(u.default.LOG_ERROR,"ConnectionManager.activateTransport()","Assumption violated: activating a transport that is still marked as a proposed transport; transport = "+B.shortName+"; stack = "+new Error().stack),D.arrDeleteValue(et.proposedTransports,B)):vt.dispose()}),!0},$.prototype.deactivateTransport=function(R,B,k){var z=this.activeProtocol,et=z&&z.getTransport()===R,ct=D.arrDeleteValue(this.pendingTransports,R),dt=D.arrDeleteValue(this.proposedTransports,R),Ot=this.noTransportsScheduledForActivation();if(u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+R),u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+B+(et?"; was active":ct?"; was pending":dt?"; was proposed":"")+(Ot?"":"; another transport is scheduled for activation")),k&&k.message&&u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+k.message),et&&(u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(z.getPendingMessages()),j.default.Config.nextTick(function(){z.clearPendingMessages()}),this.activeProtocol=this.host=null),this.emit("transport.inactive",R),et&&Ot||et&&B==="failed"||B==="closed"||z===null&&ct&&this.pendingTransports.length===0){if(B==="disconnected"&&k&&k.statusCode>500&&this.httpHosts.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:B,error:k,retryImmediately:!0});return}var St=B==="failed"&&d.default.isTokenErr(k)?"disconnected":B;this.notifyState({state:St,error:k});return}et&&B==="disconnected"&&this.state!==this.states.synchronizing&&(u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","wasActive but another transport is connected and scheduled for activation, so going into the connecting state until it activates"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),this.notifyState({state:"connecting",error:k}))},$.prototype.noTransportsScheduledForActivation=function(){return D.isEmpty(this.pendingTransports)||this.pendingTransports.every(function(R){return!R.isConnected})},$.prototype.setConnection=function(R,B,k){var z=this.connectionId,et=z&&z!==R,ct=!z&&k;(et||ct)&&(u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==R&&u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=R,this.realtime.connection.key=this.connectionKey=B.connectionKey},$.prototype.clearConnection=function(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()},$.prototype.createRecoveryKey=function(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null},$.prototype.checkConnectionStateFreshness=function(){if(!(!this.lastActivity||!this.connectionId)){var R=D.now()-this.lastActivity;R>this.connectionStateTtl+this.maxIdleInterval&&(u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+R+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}},$.prototype.persistConnection=function(){if(l()){var R=this.createRecoveryKey();R&&x({recoveryKey:R,disconnectedAt:D.now(),location:T.location,clientId:this.realtime.auth.clientId})}},$.prototype.unpersistConnection=function(){E()},$.prototype.getError=function(){return this.errorReason||this.getStateError()},$.prototype.getStateError=function(){var R,B;return(B=(R=P.default)[this.state.state])===null||B===void 0?void 0:B.call(R)},$.prototype.activeState=function(){return this.state.queueEvents||this.state.sendEvents},$.prototype.enactStateChange=function(R){var B=R.current==="failed"?u.default.LOG_ERROR:u.default.LOG_MAJOR;u.default.logAction(B,"Connection state",R.current+(R.reason?"; reason: "+R.reason:"")),u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+R.current+"; reason = "+(R.reason&&R.reason.message));var k=this.state=this.states[R.current];R.reason&&(this.errorReason=R.reason,this.realtime.connection.errorReason=R.reason),(k.terminal||k.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",R)},$.prototype.startTransitionTimer=function(R){var B=this;u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+R.state),this.transitionTimer&&(u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(function(){B.transitionTimer&&(B.transitionTimer=null,u.default.logAction(u.default.LOG_MINOR,"ConnectionManager "+R.state+" timer expired","requesting new state: "+R.failState),B.notifyState({state:R.failState}))},R.retryDelay)},$.prototype.cancelTransitionTimer=function(){u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)},$.prototype.startSuspendTimer=function(){var R=this;this.suspendTimer||(this.suspendTimer=setTimeout(function(){R.suspendTimer&&(R.suspendTimer=null,u.default.logAction(u.default.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),R.states.connecting.failState="suspended",R.notifyState({state:"suspended"}))},this.connectionStateTtl))},$.prototype.checkSuspendTimer=function(R){R!=="disconnected"&&R!=="suspended"&&R!=="connecting"&&this.cancelSuspendTimer()},$.prototype.cancelSuspendTimer=function(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)},$.prototype.startRetryTimer=function(R){var B=this;this.retryTimer=setTimeout(function(){u.default.logAction(u.default.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),B.retryTimer=null,B.requestState({state:"connecting"})},R)},$.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},$.prototype.notifyState=function(R){var B=this,k,z,et=R.state,ct=et==="disconnected"&&(this.state===this.states.connected||this.state===this.states.synchronizing||R.retryImmediately||this.state===this.states.connecting&&R.error&&d.default.isTokenErr(R.error)&&!(this.errorReason&&d.default.isTokenErr(this.errorReason)));if(u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+et+(ct?"; will retry connection immediately":"")),et!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(R.state),(et==="suspended"||et==="connected")&&(this.disconnectedRetryCount=0),!this.state.terminal)){var dt=this.states[R.state],Ot=dt.retryDelay;dt.state==="disconnected"&&(this.disconnectedRetryCount++,Ot=D.getRetryTime(dt.retryDelay,this.disconnectedRetryCount));var St=new h.default(this.state.state,dt.state,Ot,R.error||((z=(k=P.default)[dt.state])===null||z===void 0?void 0:z.call(k)));if(ct){var Mt=function(){B.state===B.states.disconnected&&(B.lastAutoReconnectAttempt=D.now(),B.requestState({state:"connecting"}))},vt=this.lastAutoReconnectAttempt&&D.now()-this.lastAutoReconnectAttempt+1;vt&&vt<1e3?(u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+vt+"ms ago, waiting another "+(1e3-vt)+"ms before trying again"),setTimeout(Mt,1e3-vt)):j.default.Config.nextTick(Mt)}else(et==="disconnected"||et==="suspended")&&this.startRetryTimer(Ot);(et==="disconnected"&&!ct||et==="suspended"||dt.terminal)&&j.default.Config.nextTick(function(){B.disconnectAllTransports()}),et=="connected"&&!this.activeProtocol&&u.default.logAction(u.default.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(St),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(et,St.reason),this.failQueuedMessages(St.reason))}},$.prototype.requestState=function(R){var B=this,k,z,et=R.state;if(u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+et+"; current state: "+this.state.state),et!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(et),!(et=="connecting"&&this.state.state=="connected")&&!(et=="closing"&&this.state.state=="closed"))){var ct=this.states[et],dt=new h.default(this.state.state,ct.state,null,R.error||((z=(k=P.default)[ct.state])===null||z===void 0?void 0:z.call(k)));this.enactStateChange(dt),et=="connecting"&&j.default.Config.nextTick(function(){B.startConnect()}),et=="closing"&&this.closeImpl()}},$.prototype.startConnect=function(){var R=this;if(this.state!==this.states.connecting){u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}var B=this.realtime.auth,k=++this.connectCounter,z=function(){R.checkConnectionStateFreshness(),R.getTransportParams(function(ct){if(ct.mode==="recover"&&ct.options.recover){var dt=V(ct.options.recover);dt&&R.realtime.channels.recoverChannels(dt.channelSerials)}k===R.connectCounter&&R.connectImpl(ct,k)})};if(u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),B.method==="basic")z();else{var et=function(ct){k===R.connectCounter&&(ct?R.actOnErrorFromAuthorize(ct):z())};this.errorReason&&d.default.isTokenErr(this.errorReason)?B._forceNewToken(null,null,et):B._ensureValidAuthCredentials(!1,et)}},$.prototype.connectImpl=function(R,B){var k=this.state.state;k!==this.states.connecting.state&&k!==this.states.connected.state?u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect (or connected to upgrade), but was "+k):this.pendingTransports.length?u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.connectImpl()","Transports "+this.pendingTransports[0].toString()+" currently pending; taking no action"):k==this.states.connected.state?this.upgradeIfNeeded(R):this.transports.length>1&&this.getTransportPreference()?this.connectPreference(R,B):this.connectBase(R,B)},$.prototype.connectPreference=function(R,B){var k=this,z=this.getTransportPreference(),et=!1;D.arrIn(this.transports,z)||(this.unpersistTransportPreference(),this.connectImpl(R,B)),u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.connectPreference()","Trying to connect with stored transport preference "+z);var ct=setTimeout(function(){et=!0,k.state.state!==k.states.connected.state&&(u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.connectPreference()","Shortcircuit connection attempt with "+z+" failed; clearing preference and trying from scratch"),k.disconnectAllTransports(),k.unpersistTransportPreference()),k.connectImpl(R,B)},this.options.timeouts.preferenceConnectTimeout);R.host=this.httpHosts[0],this.tryATransport(R,z,function(dt,Ot){clearTimeout(ct),et&&Ot?(Ot.off(),Ot.disconnect(),D.arrDeleteValue(k.pendingTransports,Ot)):!Ot&&!dt&&(k.unpersistTransportPreference(),k.connectImpl(R,B))})},$.prototype.connectBase=function(R,B){var k=this,z=function(St){k.notifyState({state:k.states.connecting.failState,error:St})},et=this.httpHosts.slice(),ct=function(St,Mt){B===k.connectCounter&&!Mt&&!St&&Ot()};u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.connectBase()","Trying to connect with base transport "+this.baseTransport);var dt=et.shift();if(!dt){z(new O.default("Unable to connect (no available host)",80003,404));return}R.host=dt;var Ot=function(){if(!et.length){z(new O.default("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!k.realtime.http.checkConnectivity){z(new O.PartialErrorInfo("Internal error: Http.checkConnectivity not set",null,500));return}k.realtime.http.checkConnectivity(function(St,Mt){if(B===k.connectCounter){if(St){z(St);return}if(!Mt){z(new O.default("Unable to connect (network unreachable)",80003,404));return}R.host=D.arrPopRandomElement(et),k.tryATransport(R,k.baseTransport,ct)}})};if(this.forceFallbackHost&&et.length){this.forceFallbackHost=!1,Ot();return}this.tryATransport(R,this.baseTransport,ct)},$.prototype.getUpgradePossibilities=function(){var R=this.activeProtocol.getTransport().shortName,B=D.arrIndexOf(this.upgradeTransports,R);return this.upgradeTransports.slice(B+1)},$.prototype.upgradeIfNeeded=function(R){var B=this,k=this.getUpgradePossibilities();u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.upgradeIfNeeded()","upgrade possibilities: "+j.default.Config.inspect(k)),k.length&&D.arrForEach(k,function(z){var et=B.createTransportParams(R.host,"upgrade");B.tryATransport(et,z,y)})},$.prototype.closeImpl=function(){u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),D.safeArrForEach(this.pendingTransports,function(R){u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+R),R&&R.close()}),D.safeArrForEach(this.proposedTransports,function(R){u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.closeImpl()","Disposing of proposed transport: "+R),R&&R.dispose()}),this.activeProtocol&&(u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})},$.prototype.onAuthUpdated=function(R,B){var k=this,z;switch(this.state.state){case"connected":{if(u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport"),(this.pendingTransports.length||this.proposedTransports.length)&&this.state!==this.states.synchronizing){this.disconnectAllTransports(!0);var et=this.activeProtocol.getTransport().params;j.default.Config.nextTick(function(){k.state.state==="connected"&&k.upgradeIfNeeded(et)})}var ct=(z=this.activeProtocol)===null||z===void 0?void 0:z.getTransport();ct&&ct.onAuthUpdated&&ct.onAuthUpdated(R);var dt=G.default.fromValues({action:i.AUTH,auth:{accessToken:R.token}});this.send(dt);var Ot=function(){k.off(St),B(null,R)},St=function(vt){vt.current==="failed"&&(k.off(Ot),k.off(St),B(vt.reason||k.getStateError()))};this.once("connectiondetails",Ot),this.on("connectionstate",St);break}case"connecting":u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");var Mt=function(vt){switch(vt.current){case"connected":k.off(Mt),B(null,R);break;case"failed":case"closed":case"suspended":k.off(Mt),B(vt.reason||k.getStateError());break}};this.on("connectionstate",Mt),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}},$.prototype.disconnectAllTransports=function(R){u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"+(R?" except the active transport":"")),this.connectCounter++,D.safeArrForEach(this.pendingTransports,function(B){u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+B),B&&B.disconnect()}),this.pendingTransports=[],D.safeArrForEach(this.proposedTransports,function(B){u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disposing of proposed transport: "+B),B&&B.dispose()}),this.proposedTransports=[],this.activeProtocol&&!R&&(u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())},$.prototype.send=function(R,B,k){k=k||y;var z=this.state;if(z.sendEvents){u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new N.PendingMessage(R,k));return}var et=B&&z.queueEvents||z.forceQueueEvents;if(!et){var ct="rejecting event, queueEvent was "+B+", state was "+z.state;u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.send()",ct),k(this.errorReason||new O.default(ct,9e4,400));return}u.default.shouldLog(u.default.LOG_MICRO)&&u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+G.default.stringify(R)),this.queue(R,k)},$.prototype.sendImpl=function(R){var B=R.message;R.ackRequired&&!R.sendAttempted&&(B.msgSerial=this.msgSerial++);try{this.activeProtocol.send(R)}catch(k){u.default.logAction(u.default.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+k.stack)}},$.prototype.queue=function(R,B){u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.queue()","queueing event");var k=this.queuedMessages.last(),z=this.options.maxMessageSize;k&&!k.sendAttempted&&W(k.message,R,z)?(k.merged||(k.callback=C.default.create([k.callback]),k.merged=!0),k.callback.push(B)):this.queuedMessages.push(new N.PendingMessage(R,B))},$.prototype.sendQueuedMessages=function(){u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");for(var R;R=this.queuedMessages.shift();)this.sendImpl(R)},$.prototype.queuePendingMessages=function(R){R&&R.length&&(u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+R.length+" pending messages"),this.queuedMessages.prepend(R))},$.prototype.failQueuedMessages=function(R){var B=this.queuedMessages.count();B>0&&(u.default.logAction(u.default.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+B+" queued messages, err = "+D.inspectError(R)),this.queuedMessages.completeAllMessages(R))},$.prototype.onChannelMessage=function(R,B){var k=this.activeProtocol&&B===this.activeProtocol.getTransport(),z=D.arrIn(this.pendingTransports,B)&&this.state==this.states.synchronizing;k||z?this.realtime.channels.onChannelMessage(R):D.arrIndexOf([i.ACK,i.NACK,i.ERROR],R.action)>-1?this.realtime.channels.onChannelMessage(R):u.default.logAction(u.default.LOG_MICRO,"ConnectionManager.onChannelMessage()","received message "+JSON.stringify(R)+"on defunct transport; discarding")},$.prototype.ping=function(R,B){var k=this;if(R){u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.ping()","transport = "+R);var z=function(){R.off("heartbeat",dt),B(new O.default("Timeout waiting for heartbeat response",5e4,500))},et=D.now(),ct=D.cheapRandStr(),dt=function(Ht){if(Ht===ct){R.off("heartbeat",dt),clearTimeout(Ot);var Ft=D.now()-et;B(null,Ft)}},Ot=setTimeout(z,this.options.timeouts.realtimeRequestTimeout);R.on("heartbeat",dt),R.ping(ct);return}if(this.state.state!=="connected"){B(new O.default("Unable to ping service; not connected",4e4,400));return}var St=!1,Mt=function(Ht,Ft){k.off("transport.active",vt),St||(St=!0,B(Ht,Ft))},vt=function(){St||(St=!0,j.default.Config.nextTick(function(){k.ping(null,B)}))};this.on("transport.active",vt),this.ping(this.activeProtocol.getTransport(),Mt)},$.prototype.abort=function(R){this.activeProtocol.getTransport().fail(R)},$.prototype.registerProposedTransport=function(R){this.proposedTransports.push(R)},$.prototype.getTransportPreference=function(){var R,B;return this.transportPreference||r()&&((B=(R=j.default.WebStorage)===null||R===void 0?void 0:R.get)===null||B===void 0?void 0:B.call(R,U))},$.prototype.persistTransportPreference=function(R){var B,k;D.arrIn(H.default.upgradeTransports,R.shortName)&&(this.transportPreference=R.shortName,r()&&((k=(B=j.default.WebStorage)===null||B===void 0?void 0:B.set)===null||k===void 0||k.call(B,U,R.shortName)))},$.prototype.unpersistTransportPreference=function(){var R,B;this.transportPreference=null,r()&&((B=(R=j.default.WebStorage)===null||R===void 0?void 0:R.remove)===null||B===void 0||B.call(R,U))},$.prototype.actOnErrorFromAuthorize=function(R){if(R.code===40171)this.notifyState({state:"failed",error:R});else if(R.code===40102)this.notifyState({state:"failed",error:R});else if(R.statusCode===t.default.Forbidden){var B="Client configured authentication provider returned 403; failing the connection";u.default.logAction(u.default.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",B),this.notifyState({state:"failed",error:new O.default(B,80019,403,R)})}else{var B="Client configured authentication provider request failed";u.default.logAction(u.default.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",B),this.notifyState({state:this.state.failState,error:new O.default(B,80019,401,R)})}},$.prototype.onConnectionDetailsUpdate=function(R,B){if(R){this.connectionDetails=R,R.maxMessageSize&&(this.options.maxMessageSize=R.maxMessageSize);var k=R.clientId;if(k){var z=this.realtime.auth._uncheckedSetClientId(k);if(z){u.default.logAction(u.default.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",z.message),B.fail(z);return}}var et=R.connectionStateTtl;et&&(this.connectionStateTtl=et),this.maxIdleInterval=R.maxIdleInterval,this.emit("connectiondetails",R)}},$.supportedTransports={},$}(b.default);S.default=ot}).call(this,g(13))},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importDefault(g(7)),G=T.__importDefault(g(2)),D=function(N){T.__extends(H,N);function H(){var j=N.call(this)||this;return j.messages=[],j}return H.prototype.count=function(){return this.messages.length},H.prototype.push=function(j){this.messages.push(j)},H.prototype.shift=function(){return this.messages.shift()},H.prototype.last=function(){return this.messages[this.messages.length-1]},H.prototype.copyAll=function(){return this.messages.slice()},H.prototype.append=function(j){this.messages.push.apply(this.messages,j)},H.prototype.prepend=function(j){this.messages.unshift.apply(this.messages,j)},H.prototype.completeMessages=function(j,b,M){G.default.logAction(G.default.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+j+"; count = "+b),M=M||null;var u=this.messages;if(u.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");var h=u[0];if(h){var P=h.message.msgSerial,O=j+b;if(O>P)for(var d=u.splice(0,O-P),p=0,C=d;p<C.length;p++){var s=C[p];s.callback(M)}u.length==0&&this.emit("idle")}},H.prototype.completeAllMessages=function(j){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,j)},H.prototype.resetSendAttempted=function(){for(var j=0,b=this.messages;j<b.length;j++){var M=b[j];M.sendAttempted=!1}},H.prototype.clear=function(){G.default.logAction(G.default.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")},H}(c.default);S.default=D},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=function(){function c(G,D,N,H){this.previous=G,this.current=D,N&&(this.retryIn=N),H&&(this.reason=H)}return c}();S.default=T},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importDefault(g(10)),G=T.__importDefault(g(7)),D=T.__importStar(g(1)),N=T.__importDefault(g(33)),H=T.__importDefault(g(2)),j=T.__importDefault(g(54)),b=T.__importDefault(g(9)),M=T.__importDefault(g(39)),u=T.__importStar(g(4)),h=T.__importDefault(g(15)),P=T.__importDefault(g(20)),O=c.default.Action,d=function(){};function p(s){if(s&&"params"in s&&!D.isObject(s.params))return new u.default("options.params must be an object",4e4,400);if(s&&"modes"in s){if(!D.isArray(s.modes))return new u.default("options.modes must be an array",4e4,400);for(var a=0;a<s.modes.length;a++){var t=s.modes[a];if(!t||typeof t!="string"||!D.arrIn(c.default.channelModes,String.prototype.toUpperCase.call(t)))return new u.default("Invalid channel mode: "+t,4e4,400)}}}var C=function(s){T.__extends(a,s);function a(t,r,l){var i=s.call(this,t,r,l)||this;return i.retryCount=0,i.history=function(y,U){if(H.default.logAction(H.default.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name),U===void 0)if(typeof y=="function")U=y,y=null;else{if(this.rest.options.promises)return D.promisify(this,"history",arguments);U=d}if(y&&y.untilAttach){if(this.state!=="attached"){U(new u.default("option untilAttach requires the channel to be attached",4e4,400));return}if(!this.properties.attachSerial){U(new u.default("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400));return}delete y.untilAttach,y.from_serial=this.properties.attachSerial}N.default.prototype._history.call(this,y,U)},i.whenState=function(y,U){return G.default.prototype.whenState.call(i,y,i.state,U)},H.default.logAction(H.default.LOG_MINOR,"RealtimeChannel()","started; name = "+r),i.realtime=t,i.presence=new j.default(i),i.connectionManager=t.connection.connectionManager,i.state="initialized",i.subscriptions=new G.default,i.syncChannelSerial=void 0,i.properties={attachSerial:void 0,channelSerial:void 0},i.setOptions(l),i.errorReason=null,i._requestedFlags=null,i._mode=null,i._attachResume=!1,i._decodingContext={channelOptions:i.channelOptions,plugins:t.options.plugins||{},baseEncodedPreviousPayload:void 0},i._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},i._allChannelChanges=new G.default,i}return a.prototype.invalidStateError=function(){return new u.default("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)},a.processListenerArgs=function(t){return t=Array.prototype.slice.call(t),typeof t[0]=="function"&&t.unshift(null),t[t.length-1]==null&&t.pop(),t},a.prototype.setOptions=function(t,r){if(!r&&this.rest.options.promises)return D.promisify(this,"setOptions",arguments);var l=r||function(y){y&&H.default.logAction(H.default.LOG_ERROR,"RealtimeChannel.setOptions()","Set options failed: "+y.toString())},i=p(t);if(i){l(i);return}N.default.prototype.setOptions.call(this,t),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(t)?(this.attachImpl(),this._allChannelChanges.once(["attached","update","detached","failed"],function(y){switch(this.event){case"update":case"attached":l==null||l(null);return;default:l==null||l(y.reason);return}})):l()},a.prototype._shouldReattachToSetOptions=function(t){return this.state==="attached"||this.state==="attaching"?!!(t!=null&&t.params&&(!this.params||!D.shallowEquals(this.params,t.params))||t!=null&&t.modes&&(!this.modes||!D.arrEquals(t.modes,this.modes))):!1},a.prototype.publish=function(){for(var t=this,r=[],l=0;l<arguments.length;l++)r[l]=arguments[l];var i=r[0],y=r.length,U=r[y-1];if(typeof U!="function"){if(this.realtime.options.promises)return D.promisify(this,"publish",arguments);U=d,++y}if(!this.connectionManager.activeState()){U(this.connectionManager.getError());return}if(y==2)if(D.isObject(i))i=[b.default.fromValues(i)];else if(D.isArray(i))i=b.default.fromValuesArray(i);else throw new u.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else i=[b.default.fromValues({name:r[0],data:r[1]})];var w=this.realtime.options.maxMessageSize;b.default.encodeArray(i,this.channelOptions,function(L){if(L){U(L);return}var x=b.default.getMessagesSize(i);if(x>w){U(new u.default("Maximum size of messages that can be published at once exceeded ( was "+x+" bytes; limit is "+w+" bytes)",40009,400));return}t.__publish(i,U)})},a.prototype.__publish=function(t,r){H.default.logAction(H.default.LOG_MICRO,"RealtimeChannel.publish()","message count = "+t.length);var l=this.state;switch(l){case"failed":case"suspended":r(u.default.fromValues(this.invalidStateError()));break;default:{H.default.logAction(H.default.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+l);var i=new c.default;i.action=O.MESSAGE,i.channel=this.name,i.messages=t,this.sendMessage(i,r);break}}},a.prototype.onEvent=function(t){H.default.logAction(H.default.LOG_MICRO,"RealtimeChannel.onEvent()","received message");for(var r=this.subscriptions,l=0;l<t.length;l++){var i=t[l];r.emit(i.name,i)}},a.prototype.attach=function(t,r){var l;if(typeof t=="function"?(r=t,l=null):l=t,!r){if(this.realtime.options.promises)return D.promisify(this,"attach",arguments);r=function(i){i&&H.default.logAction(H.default.LOG_MAJOR,"RealtimeChannel.attach()","Channel attach failed: "+i.toString())}}if(l)H.default.deprecated("channel.attach() with flags","channel.setOptions() with channelOptions.params"),this._requestedFlags=l;else if(this.state==="attached"){r(null,null);return}this._attach(!1,null,r)},a.prototype._attach=function(t,r,l){l||(l=function(y){y&&H.default.logAction(H.default.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+y.toString())});var i=this.connectionManager;if(!i.activeState()){l(i.getError());return}(this.state!=="attaching"||t)&&this.requestState("attaching",r),this.once(function(y){switch(this.event){case"attached":l==null||l(null,y);break;case"detached":case"suspended":case"failed":l==null||l(y.reason||i.getError()||new u.default("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":l==null||l(new u.default("Attach request superseded by a subsequent detach request",9e4,409));break}})},a.prototype.attachImpl=function(){H.default.logAction(H.default.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");var t=c.default.fromValues({action:O.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this._requestedFlags?t.encodeModesToFlags(this._requestedFlags):this.channelOptions.modes&&t.encodeModesToFlags(D.allToUpperCase(this.channelOptions.modes)),this._attachResume&&t.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(t.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(t,d)},a.prototype.detach=function(t){if(!t){if(this.realtime.options.promises)return D.promisify(this,"detach",arguments);t=d}var r=this.connectionManager;if(!r.activeState()){t(r.getError());return}switch(this.state){case"suspended":this.notifyState("detached"),t();break;case"detached":t();break;case"failed":t(new u.default("Unable to detach; channel state = failed",90001,400));break;default:this.requestState("detaching");case"detaching":this.once(function(l){switch(this.event){case"detached":t();break;case"attached":case"suspended":case"failed":t(l.reason||r.getError()||new u.default("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":t(new u.default("Detach request superseded by a subsequent attach request",9e4,409));break}})}},a.prototype.detachImpl=function(t){H.default.logAction(H.default.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");var r=c.default.fromValues({action:O.DETACH,channel:this.name});this.sendMessage(r,t||d)},a.prototype.subscribe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var l=a.processListenerArgs(t),i=l[0],y=l[1],U=l[2];if(!U&&this.realtime.options.promises)return D.promisify(this,"subscribe",[i,y]);if(this.state==="failed"){U==null||U(u.default.fromValues(this.invalidStateError()));return}return i&&typeof i=="object"&&!Array.isArray(i)?this._subscribeFilter(i,y):this.subscriptions.on(i,y),this.attach(U||d)},a.prototype._subscribeFilter=function(t,r){var l=function(i){var y,U,w,L,x,E,A={name:i.name,refTimeserial:(U=(y=i.extras)===null||y===void 0?void 0:y.ref)===null||U===void 0?void 0:U.timeserial,refType:(L=(w=i.extras)===null||w===void 0?void 0:w.ref)===null||L===void 0?void 0:L.type,isRef:!!(!((E=(x=i.extras)===null||x===void 0?void 0:x.ref)===null||E===void 0)&&E.timeserial),clientId:i.clientId};Object.entries(t).find(function(W){var V=W[0],X=W[1];return X!==void 0?A[V]!==X:!1})||r(i)};this._addFilteredSubscription(t,r,l),this.subscriptions.on(l)},a.prototype._addFilteredSubscription=function(t,r,l){var i;if(this.filteredSubscriptions||(this.filteredSubscriptions=new Map),this.filteredSubscriptions.has(r)){var y=this.filteredSubscriptions.get(r);y.set(t,((i=y==null?void 0:y.get(t))===null||i===void 0?void 0:i.concat(l))||[l])}else this.filteredSubscriptions.set(r,new Map([[t,[l]]]))},a.prototype._getAndDeleteFilteredSubscriptions=function(t,r){var l=this;if(!this.filteredSubscriptions)return[];if(!r&&t)return Array.from(this.filteredSubscriptions.entries()).map(function(w){var L,x=w[0],E=w[1],A=E.get(t);return E.delete(t),E.size===0&&((L=l.filteredSubscriptions)===null||L===void 0||L.delete(x)),A}).reduce(function(w,L){var x;return L?(x=w).concat.apply(x,L):w},[]);if(!r||!this.filteredSubscriptions.has(r))return[];var i=this.filteredSubscriptions.get(r);if(!t){var y=Array.from(i.values()).reduce(function(w,L){return w.concat.apply(w,L)},[]);return this.filteredSubscriptions.delete(r),y}var U=i.get(t);return i.delete(t),U||[]},a.prototype.unsubscribe=function(){for(var t=this,r,l=[],i=0;i<arguments.length;i++)l[i]=arguments[i];var y=a.processListenerArgs(l),U=y[0],w=y[1];if(typeof U=="object"&&!w||!((r=this.filteredSubscriptions)===null||r===void 0)&&r.has(w)){this._getAndDeleteFilteredSubscriptions(U,w).forEach(function(L){return t.subscriptions.off(L)});return}this.subscriptions.off(U,w)},a.prototype.sync=function(){switch(this.state){case"initialized":case"detaching":case"detached":throw new u.PartialErrorInfo("Unable to sync to channel; not attached",4e4)}var t=this.connectionManager;if(!t.activeState())throw t.getError();var r=c.default.fromValues({action:O.SYNC,channel:this.name});this.syncChannelSerial&&(r.channelSerial=this.syncChannelSerial),t.send(r)},a.prototype.sendMessage=function(t,r){this.connectionManager.send(t,this.realtime.options.queueMessages,r)},a.prototype.sendPresence=function(t,r){var l=c.default.fromValues({action:O.PRESENCE,channel:this.name,presence:D.isArray(t)?h.default.fromValuesArray(t):[h.default.fromValues(t)]});this.sendMessage(l,r)},a.prototype.onMessage=function(t){(t.action===O.ATTACHED||t.action===O.MESSAGE||t.action===O.PRESENCE)&&this.setChannelSerial(t.channelSerial);var r,l=!1;switch(t.action){case O.ATTACHED:{this.properties.attachSerial=t.channelSerial,this._mode=t.getMode(),this.params=t.params||{};var i=t.decodeModesFromFlags();this.modes=i&&D.allToLowerCase(i)||void 0;var y=t.hasFlag("RESUMED"),U=t.hasFlag("HAS_PRESENCE"),w=t.hasFlag("HAS_BACKLOG");if(this.state==="attached"){y||this.presence.onAttached(U);var L=new M.default(this.state,this.state,y,w,t.error);this._allChannelChanges.emit("update",L),(!y||this.channelOptions.updateOnAttached)&&this.emit("update",L)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",t.error,y,U,w);break}case O.DETACHED:{var x=t.error?u.default.fromValues(t.error):new u.default("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",x):this.state==="attaching"?this.notifyState("suspended",x):this.requestState("attaching",x);break}case O.SYNC:if(l=!0,r=this.syncChannelSerial=t.channelSerial,!t.presence)break;case O.PRESENCE:{for(var E=t.presence,A=t.id,W=t.connectionId,V=t.timestamp,X=this.channelOptions,ot=void 0,at=0;at<E.length;at++)try{ot=E[at],h.default.decode(ot,X),ot.connectionId||(ot.connectionId=W),ot.timestamp||(ot.timestamp=V),ot.id||(ot.id=A+":"+at)}catch(et){H.default.logAction(H.default.LOG_ERROR,"RealtimeChannel.onMessage()",et.toString())}this.presence.setPresence(E,l,r);break}case O.MESSAGE:{if(this.state!=="attached"){H.default.logAction(H.default.LOG_MAJOR,"RealtimeChannel.onMessage()",'Message "'+t.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}var $=t.messages,R=$[0],B=$[$.length-1],A=t.id,W=t.connectionId,V=t.timestamp;if(R.extras&&R.extras.delta&&R.extras.delta.from!==this._lastPayload.messageId){var k='Delta message decode failure - previous message not available for message "'+t.id+'" on this channel "'+this.name+'".';H.default.logAction(H.default.LOG_ERROR,"RealtimeChannel.onMessage()",k),this._startDecodeFailureRecovery(new u.default(k,40018,400));break}for(var at=0;at<$.length;at++){var k=$[at];try{b.default.decode(k,this._decodingContext)}catch(Mt){switch(H.default.logAction(H.default.LOG_ERROR,"RealtimeChannel.onMessage()",Mt.toString()),Mt.code){case 40018:this._startDecodeFailureRecovery(Mt);return;case 40019:case 40021:this.notifyState("failed",Mt);return}}k.connectionId||(k.connectionId=W),k.timestamp||(k.timestamp=V),k.id||(k.id=A+":"+at)}this._lastPayload.messageId=B.id,this._lastPayload.protocolMessageChannelSerial=t.channelSerial,this.onEvent($);break}case O.ERROR:{var z=t.error;z&&z.code==80016?this.checkPendingState():this.notifyState("failed",u.default.fromValues(z));break}default:H.default.logAction(H.default.LOG_ERROR,"RealtimeChannel.onMessage()","Fatal protocol error: unrecognised action ("+t.action+")"),this.connectionManager.abort(P.default.unknownChannelErr())}},a.prototype._startDecodeFailureRecovery=function(t){var r=this;this._lastPayload.decodeFailureRecoveryInProgress||(H.default.logAction(H.default.LOG_MAJOR,"RealtimeChannel.onMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,t,function(){r._lastPayload.decodeFailureRecoveryInProgress=!1}))},a.prototype.onAttached=function(){H.default.logAction(H.default.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)},a.prototype.notifyState=function(t,r,l,i,y){if(H.default.logAction(H.default.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+t),this.clearStateTimer(),D.arrIn(["detached","suspended","failed"],t)&&(this.properties.channelSerial=null),t!==this.state){this.presence.actOnChannelState(t,i,r),t==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),r&&(this.errorReason=r);var U=new M.default(this.state,t,l,y,r),w=t==="failed"?H.default.LOG_ERROR:H.default.LOG_MAJOR;H.default.logAction(w,'Channel state for channel "'+this.name+'"',t+(r?"; reason: "+r:"")),t!=="attaching"&&t!=="suspended"&&(this.retryCount=0),t==="attached"&&this.onAttached(),t==="attached"?this._attachResume=!0:(t==="detaching"||t==="failed")&&(this._attachResume=!1),this.state=t,this._allChannelChanges.emit(t,U),this.emit(t,U)}},a.prototype.requestState=function(t,r){H.default.logAction(H.default.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+t),this.notifyState(t,r),this.checkPendingState()},a.prototype.checkPendingState=function(){var t=this.connectionManager.state;if(!(t.sendEvents||t.forceQueueEvents)){H.default.logAction(H.default.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(H.default.logAction(H.default.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}},a.prototype.timeoutPendingState=function(){switch(this.state){case"attaching":{var t=new u.default("Channel attach timed out",90007,408);this.notifyState("suspended",t);break}case"detaching":{var t=new u.default("Channel detach timed out",90007,408);this.notifyState("attached",t);break}default:this.checkPendingState();break}},a.prototype.startStateTimerIfNotRunning=function(){var t=this;this.stateTimer||(this.stateTimer=setTimeout(function(){H.default.logAction(H.default.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),t.stateTimer=null,t.timeoutPendingState()},this.realtime.options.timeouts.realtimeRequestTimeout))},a.prototype.clearStateTimer=function(){var t=this.stateTimer;t&&(clearTimeout(t),this.stateTimer=null)},a.prototype.startRetryTimer=function(){var t=this;if(!this.retryTimer){this.retryCount++;var r=D.getRetryTime(this.realtime.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(function(){t.state==="suspended"&&t.connectionManager.state.sendEvents&&(t.retryTimer=null,H.default.logAction(H.default.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),t.requestState("attaching"))},r)}},a.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},a.prototype.getReleaseErr=function(){var t=this.state;return t==="initialized"||t==="detached"||t==="failed"?null:new u.default("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+t,90001,400)},a.prototype.setChannelSerial=function(t){H.default.logAction(H.default.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+t+"; previous = "+this.properties.channelSerial),t&&(this.properties.channelSerial=t)},a}(N.default);S.default=C},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=function(){function c(G,D,N,H,j){this.previous=G,this.current=D,D==="attached"&&(this.resumed=N,this.hasBacklog=H),j&&(this.reason=j)}return c}();S.default=T},function(ut,S,g){(function(T,c){ut.exports=c(g(6))})(this,function(T){return function(){var c=T,G=c.lib,D=G.WordArray,N=G.Hasher,H=c.algo,j=[],b=H.SHA1=N.extend({_doReset:function(){this._hash=new D.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(M,u){for(var h=this._hash.words,P=h[0],O=h[1],d=h[2],p=h[3],C=h[4],s=0;s<80;s++){if(s<16)j[s]=M[u+s]|0;else{var a=j[s-3]^j[s-8]^j[s-14]^j[s-16];j[s]=a<<1|a>>>31}var t=(P<<5|P>>>27)+C+j[s];s<20?t+=(O&d|~O&p)+1518500249:s<40?t+=(O^d^p)+1859775393:s<60?t+=(O&d|O&p|d&p)-1894007588:t+=(O^d^p)-899497514,C=p,p=d,d=O<<30|O>>>2,O=P,P=t}h[0]=h[0]+P|0,h[1]=h[1]+O|0,h[2]=h[2]+d|0,h[3]=h[3]+p|0,h[4]=h[4]+C|0},_doFinalize:function(){var M=this._data,u=M.words,h=this._nDataBytes*8,P=M.sigBytes*8;return u[P>>>5]|=128<<24-P%32,u[(P+64>>>9<<4)+14]=Math.floor(h/4294967296),u[(P+64>>>9<<4)+15]=h,M.sigBytes=u.length*4,this._process(),this._hash},clone:function(){var M=N.clone.call(this);return M._hash=this._hash.clone(),M}});c.SHA1=N._createHelper(b),c.HmacSHA1=N._createHmacHelper(b)}(),T.SHA1})},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});function T(s){if(s===void 0)return"undefined";var a,t;if(s instanceof ArrayBuffer?(t="ArrayBuffer",a=new DataView(s)):s instanceof DataView&&(t="DataView",a=s),!a)return JSON.stringify(s);for(var r=[],l=0;l<s.byteLength;l++){if(l>20){r.push("...");break}var i=a.getUint8(l).toString(16);i.length===1&&(i="0"+i),r.push(i)}return"<"+t+" "+r.join(" ")+">"}function c(s,a,t){for(var r=0,l=t.length;r<l;r++){var i=t.charCodeAt(r);if(i<128){s.setUint8(a++,i>>>0&127|0);continue}if(i<2048){s.setUint8(a++,i>>>6&31|192),s.setUint8(a++,i>>>0&63|128);continue}if(i<65536){s.setUint8(a++,i>>>12&15|224),s.setUint8(a++,i>>>6&63|128),s.setUint8(a++,i>>>0&63|128);continue}if(i<1114112){s.setUint8(a++,i>>>18&7|240),s.setUint8(a++,i>>>12&63|128),s.setUint8(a++,i>>>6&63|128),s.setUint8(a++,i>>>0&63|128);continue}throw new Error("bad codepoint "+i)}}function G(s,a,t){for(var r="",l=a,i=a+t;l<i;l++){var y=s.getUint8(l);if(!(y&128)){r+=String.fromCharCode(y);continue}if((y&224)===192){r+=String.fromCharCode((y&15)<<6|s.getUint8(++l)&63);continue}if((y&240)===224){r+=String.fromCharCode((y&15)<<12|(s.getUint8(++l)&63)<<6|(s.getUint8(++l)&63)<<0);continue}if((y&248)===240){r+=String.fromCharCode((y&7)<<18|(s.getUint8(++l)&63)<<12|(s.getUint8(++l)&63)<<6|(s.getUint8(++l)&63)<<0);continue}throw new Error("Invalid byte "+y.toString(16))}return r}function D(s){for(var a=0,t=0,r=s.length;t<r;t++){var l=s.charCodeAt(t);if(l<128){a+=1;continue}if(l<2048){a+=2;continue}if(l<65536){a+=3;continue}if(l<1114112){a+=4;continue}throw new Error("bad codepoint "+l)}return a}function N(s,a){var t=C(s,a);if(t!==0){var r=new ArrayBuffer(t),l=new DataView(r);return p(s,l,0,a),r}}var H=65536*65536,j=1/H;function b(s,a){return a=a||0,s.getInt32(a)*H+s.getUint32(a+4)}function M(s,a){return a=a||0,s.getUint32(a)*H+s.getUint32(a+4)}function u(s,a,t){t<9223372036854776e3?(s.setInt32(a,Math.floor(t*j)),s.setInt32(a+4,t&-1)):(s.setUint32(a,2147483647),s.setUint32(a+4,2147483647))}function h(s,a,t){t<18446744073709552e3?(s.setUint32(a,Math.floor(t*j)),s.setInt32(a+4,t&-1)):(s.setUint32(a,4294967295),s.setUint32(a+4,4294967295))}var P=function(){function s(a,t){var r=this;this.map=function(l){for(var i={},y=0;y<l;y++){var U=r.parse();i[U]=r.parse()}return i},this.bin=function(l){var i=new ArrayBuffer(l);return new Uint8Array(i).set(new Uint8Array(r.view.buffer,r.offset,l),0),r.offset+=l,i},this.buf=this.bin,this.str=function(l){var i=G(r.view,r.offset,l);return r.offset+=l,i},this.array=function(l){for(var i=new Array(l),y=0;y<l;y++)i[y]=r.parse();return i},this.ext=function(l){return r.offset+=l,{type:r.view.getInt8(r.offset),data:r.buf(l)}},this.parse=function(){var l=r.view.getUint8(r.offset),i,y;if(!(l&128))return r.offset++,l;if((l&240)===128)return y=l&15,r.offset++,r.map(y);if((l&240)===144)return y=l&15,r.offset++,r.array(y);if((l&224)===160)return y=l&31,r.offset++,r.str(y);if((l&224)===224)return i=r.view.getInt8(r.offset),r.offset++,i;switch(l){case 192:return r.offset++,null;case 193:r.offset++;return;case 194:return r.offset++,!1;case 195:return r.offset++,!0;case 196:return y=r.view.getUint8(r.offset+1),r.offset+=2,r.bin(y);case 197:return y=r.view.getUint16(r.offset+1),r.offset+=3,r.bin(y);case 198:return y=r.view.getUint32(r.offset+1),r.offset+=5,r.bin(y);case 199:return y=r.view.getUint8(r.offset+1),r.offset+=2,r.ext(y);case 200:return y=r.view.getUint16(r.offset+1),r.offset+=3,r.ext(y);case 201:return y=r.view.getUint32(r.offset+1),r.offset+=5,r.ext(y);case 202:return i=r.view.getFloat32(r.offset+1),r.offset+=5,i;case 203:return i=r.view.getFloat64(r.offset+1),r.offset+=9,i;case 204:return i=r.view.getUint8(r.offset+1),r.offset+=2,i;case 205:return i=r.view.getUint16(r.offset+1),r.offset+=3,i;case 206:return i=r.view.getUint32(r.offset+1),r.offset+=5,i;case 207:return i=M(r.view,r.offset+1),r.offset+=9,i;case 208:return i=r.view.getInt8(r.offset+1),r.offset+=2,i;case 209:return i=r.view.getInt16(r.offset+1),r.offset+=3,i;case 210:return i=r.view.getInt32(r.offset+1),r.offset+=5,i;case 211:return i=b(r.view,r.offset+1),r.offset+=9,i;case 212:return y=1,r.offset++,r.ext(y);case 213:return y=2,r.offset++,r.ext(y);case 214:return y=4,r.offset++,r.ext(y);case 215:return y=8,r.offset++,r.ext(y);case 216:return y=16,r.offset++,r.ext(y);case 217:return y=r.view.getUint8(r.offset+1),r.offset+=2,r.str(y);case 218:return y=r.view.getUint16(r.offset+1),r.offset+=3,r.str(y);case 219:return y=r.view.getUint32(r.offset+1),r.offset+=5,r.str(y);case 220:return y=r.view.getUint16(r.offset+1),r.offset+=3,r.array(y);case 221:return y=r.view.getUint32(r.offset+1),r.offset+=5,r.array(y);case 222:return y=r.view.getUint16(r.offset+1),r.offset+=3,r.map(y);case 223:return y=r.view.getUint32(r.offset+1),r.offset+=5,r.map(y)}throw new Error("Unknown type 0x"+l.toString(16))},this.offset=t||0,this.view=a}return s}();function O(s){var a=new DataView(s),t=new P(a),r=t.parse();if(t.offset!==s.byteLength)throw new Error(s.byteLength-t.offset+" trailing bytes");return r}function d(s,a){return Object.keys(s).filter(function(t){var r=s[t],l=typeof r;return(!a||r!=null)&&(l!=="function"||!!r.toJSON)})}function p(s,a,t,r){var l=typeof s;if(typeof s=="string"){var i=D(s);if(i<32)return a.setUint8(t,i|160),c(a,t+1,s),1+i;if(i<256)return a.setUint8(t,217),a.setUint8(t+1,i),c(a,t+2,s),2+i;if(i<65536)return a.setUint8(t,218),a.setUint16(t+1,i),c(a,t+3,s),3+i;if(i<4294967296)return a.setUint8(t,219),a.setUint32(t+1,i),c(a,t+5,s),5+i}if(ArrayBuffer.isView&&ArrayBuffer.isView(s)&&(s=s.buffer),s instanceof ArrayBuffer){var y=s.byteLength;if(y<256)return a.setUint8(t,196),a.setUint8(t+1,y),new Uint8Array(a.buffer).set(new Uint8Array(s),t+2),2+y;if(y<65536)return a.setUint8(t,197),a.setUint16(t+1,y),new Uint8Array(a.buffer).set(new Uint8Array(s),t+3),3+y;if(y<4294967296)return a.setUint8(t,198),a.setUint32(t+1,y),new Uint8Array(a.buffer).set(new Uint8Array(s),t+5),5+y}if(typeof s=="number"){if(Math.floor(s)!==s)return a.setUint8(t,203),a.setFloat64(t+1,s),9;if(s>=0){if(s<128)return a.setUint8(t,s),1;if(s<256)return a.setUint8(t,204),a.setUint8(t+1,s),2;if(s<65536)return a.setUint8(t,205),a.setUint16(t+1,s),3;if(s<4294967296)return a.setUint8(t,206),a.setUint32(t+1,s),5;if(s<18446744073709552e3)return a.setUint8(t,207),h(a,t+1,s),9;throw new Error("Number too big 0x"+s.toString(16))}if(s>=-32)return a.setInt8(t,s),1;if(s>=-128)return a.setUint8(t,208),a.setInt8(t+1,s),2;if(s>=-32768)return a.setUint8(t,209),a.setInt16(t+1,s),3;if(s>=-2147483648)return a.setUint8(t,210),a.setInt32(t+1,s),5;if(s>=-9223372036854776e3)return a.setUint8(t,211),u(a,t+1,s),9;throw new Error("Number too small -0x"+(-s).toString(16).substr(1))}if(l==="undefined")return r?0:(a.setUint8(t,212),a.setUint8(t+1,0),a.setUint8(t+2,0),3);if(s===null)return r?0:(a.setUint8(t,192),1);if(l==="boolean")return a.setUint8(t,s?195:194),1;if(typeof s.toJSON=="function")return p(s.toJSON(),a,t,r);if(l==="object"){var U,w=0,L=void 0,x=Array.isArray(s);if(x?U=s.length:(L=d(s,r),U=L.length),U<16?(a.setUint8(t,U|(x?144:128)),w=1):U<65536?(a.setUint8(t,x?220:222),a.setUint16(t+1,U),w=3):U<4294967296&&(a.setUint8(t,x?221:223),a.setUint32(t+1,U),w=5),x)for(var E=0;E<U;E++)w+=p(s[E],a,t+w,r);else if(L)for(var E=0;E<U;E++){var A=L[E];w+=p(A,a,t+w),w+=p(s[A],a,t+w,r)}return w}if(l==="function")return 0;throw new Error("Unknown type "+l)}function C(s,a){var t=typeof s;if(t==="string"){var r=D(s);if(r<32)return 1+r;if(r<256)return 2+r;if(r<65536)return 3+r;if(r<4294967296)return 5+r}if(ArrayBuffer.isView&&ArrayBuffer.isView(s)&&(s=s.buffer),s instanceof ArrayBuffer){var l=s.byteLength;if(l<256)return 2+l;if(l<65536)return 3+l;if(l<4294967296)return 5+l}if(typeof s=="number"){if(Math.floor(s)!==s)return 9;if(s>=0){if(s<128)return 1;if(s<256)return 2;if(s<65536)return 3;if(s<4294967296)return 5;if(s<18446744073709552e3)return 9;throw new Error("Number too big 0x"+s.toString(16))}if(s>=-32)return 1;if(s>=-128)return 2;if(s>=-32768)return 3;if(s>=-2147483648)return 5;if(s>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+s.toString(16).substr(1))}if(t==="boolean")return 1;if(s===null)return a?0:1;if(s===void 0)return a?0:3;if(typeof s.toJSON=="function")return C(s.toJSON(),a);if(t==="object"){var i,y=0;if(Array.isArray(s)){i=s.length;for(var U=0;U<i;U++)y+=C(s[U],a)}else{var w=d(s,a);i=w.length;for(var U=0;U<i;U++){var L=w[U];y+=C(L)+C(s[L],a)}}if(i<16)return 1+y;if(i<65536)return 3+y;if(i<4294967296)return 5+y;throw new Error("Array or object too long 0x"+i.toString(16))}if(t==="function")return 0;throw new Error("Unknown type "+t)}S.default={encode:N,decode:O,inspect:T,utf8Write:c,utf8Read:G,utf8ByteCount:D}},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importDefault(g(30)),G=T.__importDefault(g(50)),D=T.__importDefault(g(3)),N=T.__importDefault(g(4)),H=T.__importDefault(g(55)),j=T.__importDefault(g(57)),b=T.__importDefault(g(62)),M=T.__importDefault(g(64)),u=T.__importDefault(g(68)),h=T.__importDefault(g(2)),P=g(8),O=T.__importDefault(g(65)),d=T.__importDefault(g(66)),p=T.__importDefault(g(41)),C=(0,j.default)(M.default,H.default);D.default.Crypto=C,D.default.BufferUtils=H.default,D.default.Http=b.default,D.default.Config=M.default,D.default.Transports=u.default,D.default.WebStorage=O.default,c.default.Crypto=C,G.default.Crypto=C,h.default.initLogHandlers(),D.default.Defaults=(0,P.getDefaults)(d.default),D.default.Config.agent&&(D.default.Defaults.agent+=" "+D.default.Config.agent),D.default.Config.noUpgrade&&(D.default.Defaults.upgradeTransports=[]),S.default={ErrorInfo:N.default,Rest:c.default,Realtime:G.default,msgpack:p.default}},function(ut){ut.exports=JSON.parse('{"name":"ably","description":"Realtime client library for Ably, the realtime messaging service","version":"1.2.46","license":"Apache-2.0","bugs":{"url":"https://github.com/ably/ably-js/issues","email":"support@ably.com"},"main":"./build/ably-node.js","typings":"./ably.d.ts","react-native":{"./build/ably-node.js":"./build/ably-reactnative.js"},"browser":{"./build/ably-node.js":"./build/ably-commonjs.js"},"files":["build/**","ably.d.ts","callbacks.d.ts","callbacks.js","promises.d.ts","promises.js","resources/**","src/**","react/**"],"dependencies":{"@ably/msgpack-js":"^0.4.0","got":"^11.8.5","ws":"^8.14.2"},"peerDependencies":{"react":">=16.8.0","react-dom":">=16.8.0"},"peerDependenciesMeta":{"react":{"optional":true},"react-dom":{"optional":true}},"devDependencies":{"@ably/vcdiff-decoder":"1.0.4","@testing-library/react":"^13.3.0","@types/crypto-js":"^4.0.1","@types/node":"^15.0.0","@types/request":"^2.48.7","@types/ws":"^8.2.0","@typescript-eslint/eslint-plugin":"^5.14.0","@typescript-eslint/parser":"^5.14.0","@vitejs/plugin-react":"^1.3.2","async":"ably-forks/async#requirejs","aws-sdk":"^2.1413.0","chai":"^4.2.0","copy-webpack-plugin":"^6.4.1","cors":"^2.8.5","crypto-js":"ably-forks/crypto-js#crypto-lite","eslint":"^7.13.0","eslint-plugin-import":"^2.28.0","eslint-plugin-jsdoc":"^40.0.0","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-security":"^1.4.0","express":"^4.17.1","glob":"~4.4","google-closure-compiler":"^20180610.0.1","grunt":"^1.6.1","grunt-bump":"^0.3.1","grunt-cli":"~1.2.0","grunt-closure-tools":"^1.0.0","grunt-contrib-concat":"~0.5","grunt-shell":"~1.1","grunt-webpack":"^4.0.2","hexy":"~0.2","jsdom":"^20.0.0","kexec":"ably-forks/node-kexec#update-for-node-12","minimist":"^1.2.5","mocha":"^8.1.3","null-loader":"^4.0.1","playwright":"^1.10.0","prettier":"^2.5.1","react":">=18.1.0","react-dom":">=18.1.0","requirejs":"~2.1","shelljs":"~0.8","source-map-explorer":"^2.5.2","ts-loader":"^8.2.0","tsconfig-paths-webpack-plugin":"^4.0.1","tslib":"^2.3.1","typedoc":"^0.23.8","typescript":"^4.6.4","vite":"^4.4.9","vitest":"^0.18.0","webpack":"^4.44.2","webpack-cli":"^4.2.0"},"engines":{"node":">=5.10.x"},"repository":"ably/ably-js","jspm":{"registry":"npm","directories":{"lib":"build"},"main":"ably"},"scripts":{"start:react":"npx vite serve","grunt":"grunt","test":"grunt test","test:node":"grunt test:node","test:node:skip-build":"grunt mocha","test:webserver":"grunt test:webserver","test:playwright":"node test/support/runPlaywrightTests.js","test:react":"vitest run","concat":"grunt concat","build":"grunt build:all && npm run build:react","build:node":"grunt build:node","build:browser":"grunt build:browser","build:react":"npm run build:react:mjs && npm run build:react:cjs && cp src/platform/react-hooks/res/package.react.json react/package.json","build:react:mjs":"tsc --project src/platform/react-hooks/tsconfig.mjs.json && cp src/platform/react-hooks/res/package.mjs.json react/mjs/package.json","build:react:cjs":"tsc --project src/platform/react-hooks/tsconfig.cjs.json && cp src/platform/react-hooks/res/package.cjs.json react/cjs/package.json","requirejs":"grunt requirejs","lint":"eslint .","lint:fix":"eslint --fix .","check-closure-compiler":"grunt check-closure-compiler","prepare":"npm run build","format":"prettier --write --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js docs/chrome-mv3.md","format:check":"prettier --check --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js","sourcemap":"source-map-explorer build/ably.min.js","sourcemap:noencryption":"source-map-explorer build/ably.noencryption.min.js","docs":"typedoc --entryPoints ably.d.ts --out docs/generated/default --readme docs/landing-pages/default.md && typedoc --entryPoints promises.d.ts --out docs/generated/promises --name \\"ably (Promise-based)\\" --readme docs/landing-pages/promises.md && cp docs/landing-pages/choose-library.html docs/generated/index.html"}}')},function(ut,S){},function(ut,S,g){(function(T,c){ut.exports=c(g(6),g(32),g(24))})(this,function(T){return T.HmacSHA256})},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importStar(g(1)),G=T.__importDefault(g(47)),D=T.__importDefault(g(14)),N=T.__importDefault(g(19)),H=T.__importDefault(g(4)),j=T.__importDefault(g(48)),b=function(){},M=function(){function O(d){this.rest=d,this.admin=new u(d)}return O}(),u=function(){function O(d){this.rest=d,this.deviceRegistrations=new h(d),this.channelSubscriptions=new P(d)}return O.prototype.publish=function(d,p,C){var s=this.rest,a=s.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,t=c.defaultPostHeaders(s.options,a),r={},l=c.mixin({recipient:d},p);if(typeof C!="function"){if(this.rest.options.promises)return c.promisify(this,"publish",arguments);C=b}s.options.headers&&c.mixin(t,s.options.headers),s.options.pushFullWait&&c.mixin(r,{fullWait:"true"});var i=c.encodeBody(l,a);D.default.post(s,"/push/publish",i,t,r,null,function(y){return C(y)})},O}(),h=function(){function O(d){this.rest=d}return O.prototype.save=function(d,p){var C=this.rest,s=G.default.fromValues(d),a=C.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,t=c.defaultPostHeaders(C.options,a),r={};if(typeof p!="function"){if(this.rest.options.promises)return c.promisify(this,"save",arguments);p=b}C.options.headers&&c.mixin(t,C.options.headers),C.options.pushFullWait&&c.mixin(r,{fullWait:"true"});var l=c.encodeBody(s,a);D.default.put(C,"/push/deviceRegistrations/"+encodeURIComponent(d.id),l,t,r,null,function(i,y,U,w){p(i,i?void 0:G.default.fromResponseBody(y,w?void 0:a))})},O.prototype.get=function(d,p){var C=this.rest,s=C.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,a=c.defaultGetHeaders(C.options,s),t=d.id||d;if(typeof p!="function"){if(this.rest.options.promises)return c.promisify(this,"get",arguments);p=b}if(typeof t!="string"||!t.length){p(new H.default("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400));return}C.options.headers&&c.mixin(a,C.options.headers),D.default.get(C,"/push/deviceRegistrations/"+encodeURIComponent(t),a,{},null,function(r,l,i,y){p(r,r?void 0:G.default.fromResponseBody(l,y?void 0:s))})},O.prototype.list=function(d,p){var C=this.rest,s=C.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,a=this.rest.http.supportsLinkHeaders?void 0:s,t=c.defaultGetHeaders(C.options,s);if(typeof p!="function"){if(this.rest.options.promises)return c.promisify(this,"list",arguments);p=b}C.options.headers&&c.mixin(t,C.options.headers),new N.default(C,"/push/deviceRegistrations",t,a,function(r,l,i){return G.default.fromResponseBody(r,i?void 0:s)}).get(d,p)},O.prototype.remove=function(d,p){var C=this.rest,s=C.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,a=c.defaultGetHeaders(C.options,s),t={},r=d.id||d;if(typeof p!="function"){if(this.rest.options.promises)return c.promisify(this,"remove",arguments);p=b}if(typeof r!="string"||!r.length){p(new H.default("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400));return}C.options.headers&&c.mixin(a,C.options.headers),C.options.pushFullWait&&c.mixin(t,{fullWait:"true"}),D.default.delete(C,"/push/deviceRegistrations/"+encodeURIComponent(r),a,t,null,function(l){return p(l)})},O.prototype.removeWhere=function(d,p){var C=this.rest,s=C.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,a=c.defaultGetHeaders(C.options,s);if(typeof p!="function"){if(this.rest.options.promises)return c.promisify(this,"removeWhere",arguments);p=b}C.options.headers&&c.mixin(a,C.options.headers),C.options.pushFullWait&&c.mixin(d,{fullWait:"true"}),D.default.delete(C,"/push/deviceRegistrations",a,d,null,function(t){return p(t)})},O}(),P=function(){function O(d){this.remove=O.prototype.removeWhere,this.rest=d}return O.prototype.save=function(d,p){var C=this.rest,s=j.default.fromValues(d),a=C.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,t=c.defaultPostHeaders(C.options,a),r={};if(typeof p!="function"){if(this.rest.options.promises)return c.promisify(this,"save",arguments);p=b}C.options.headers&&c.mixin(t,C.options.headers),C.options.pushFullWait&&c.mixin(r,{fullWait:"true"});var l=c.encodeBody(s,a);D.default.post(C,"/push/channelSubscriptions",l,t,r,null,function(i,y,U,w){p(i,!i&&j.default.fromResponseBody(y,w?void 0:a))})},O.prototype.list=function(d,p){var C=this.rest,s=C.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,a=this.rest.http.supportsLinkHeaders?void 0:s,t=c.defaultGetHeaders(C.options,s);if(typeof p!="function"){if(this.rest.options.promises)return c.promisify(this,"list",arguments);p=b}C.options.headers&&c.mixin(t,C.options.headers),new N.default(C,"/push/channelSubscriptions",t,a,function(r,l,i){return j.default.fromResponseBody(r,i?void 0:s)}).get(d,p)},O.prototype.removeWhere=function(d,p){var C=this.rest,s=C.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,a=c.defaultGetHeaders(C.options,s);if(typeof p!="function"){if(this.rest.options.promises)return c.promisify(this,"removeWhere",arguments);p=b}C.options.headers&&c.mixin(a,C.options.headers),C.options.pushFullWait&&c.mixin(d,{fullWait:"true"}),D.default.delete(C,"/push/channelSubscriptions",a,d,null,function(t){return p(t)})},O.prototype.listChannels=function(d,p){var C=this.rest,s=C.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,a=this.rest.http.supportsLinkHeaders?void 0:s,t=c.defaultGetHeaders(C.options,s);if(typeof p!="function"){if(this.rest.options.promises)return c.promisify(this,"listChannels",arguments);p=b}C.options.headers&&c.mixin(t,C.options.headers),C.options.pushFullWait&&c.mixin(d,{fullWait:"true"}),new N.default(C,"/push/channels",t,a,function(r,l,i){for(var y=!i&&s?c.decodeBody(r,s):r,U=0;U<y.length;U++)y[U]=String(y[U]);return y}).get(d,p)},O}();S.default=M},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importStar(g(1)),G=T.__importDefault(g(4)),D;(function(j){j.Phone="phone",j.Tablet="tablet",j.Desktop="desktop",j.TV="tv",j.Watch="watch",j.Car="car",j.Embedded="embedded",j.Other="other"})(D||(D={}));var N;(function(j){j.Android="android",j.IOS="ios",j.Browser="browser"})(N||(N={}));var H=function(){function j(){}return j.prototype.toJSON=function(){var b,M,u;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(b=this.push)===null||b===void 0?void 0:b.recipient,state:(M=this.push)===null||M===void 0?void 0:M.state,error:(u=this.push)===null||u===void 0?void 0:u.error}}},j.prototype.toString=function(){var b,M,u,h,P="[DeviceDetails";return this.id&&(P+="; id="+this.id),this.platform&&(P+="; platform="+this.platform),this.formFactor&&(P+="; formFactor="+this.formFactor),this.clientId&&(P+="; clientId="+this.clientId),this.metadata&&(P+="; metadata="+this.metadata),this.deviceIdentityToken&&(P+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),!((b=this.push)===null||b===void 0)&&b.recipient&&(P+="; push.recipient="+JSON.stringify(this.push.recipient)),!((M=this.push)===null||M===void 0)&&M.state&&(P+="; push.state="+this.push.state),!((u=this.push)===null||u===void 0)&&u.error&&(P+="; push.error="+JSON.stringify(this.push.error)),!((h=this.push)===null||h===void 0)&&h.metadata&&(P+="; push.metadata="+this.push.metadata),P+="]",P},j.fromResponseBody=function(b,M){return M&&(b=c.decodeBody(b,M)),c.isArray(b)?j.fromValuesArray(b):j.fromValues(b)},j.fromValues=function(b){return b.error=b.error&&G.default.fromValues(b.error),Object.assign(new j,b)},j.fromValuesArray=function(b){for(var M=b.length,u=new Array(M),h=0;h<M;h++)u[h]=j.fromValues(b[h]);return u},j.toRequestBody=c.encodeBody,j}();S.default=H},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importStar(g(1)),G=function(){function D(){}return D.prototype.toJSON=function(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}},D.prototype.toString=function(){var N="[PushChannelSubscription";return this.channel&&(N+="; channel="+this.channel),this.deviceId&&(N+="; deviceId="+this.deviceId),this.clientId&&(N+="; clientId="+this.clientId),N+="]",N},D.fromResponseBody=function(N,H){return H&&(N=c.decodeBody(N,H)),c.isArray(N)?D.fromValuesArray(N):D.fromValues(N)},D.fromValues=function(N){return Object.assign(new D,N)},D.fromValuesArray=function(N){for(var H=N.length,j=new Array(H),b=0;b<H;b++)j[b]=D.fromValues(N[b]);return j},D.toRequestBody=c.encodeBody,D}();S.default=G},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importStar(g(1)),G=function(){function C(s){this.count=s&&s.count||0,this.data=s&&s.data||0,this.uncompressedData=s&&s.uncompressedData||0,this.failed=s&&s.failed||0,this.refused=s&&s.refused||0}return C}(),D=function(C){T.__extends(s,C);function s(a){var t=C.call(this,a)||this;return a&&a.category&&(t.category={},c.forInOwnNonNullProperties(a.category,function(r){t.category[r]=new G(a.category[r])})),t}return s}(G),N=function(){function C(s){this.peak=s&&s.peak||0,this.min=s&&s.min||0,this.mean=s&&s.mean||0,this.opened=s&&s.opened||0,this.refused=s&&s.refused||0}return C}(),H=function(){function C(s){this.succeeded=s&&s.succeeded||0,this.failed=s&&s.failed||0,this.refused=s&&s.refused||0}return C}(),j=function(){function C(s){this.plain=new N(s&&s.plain),this.tls=new N(s&&s.tls),this.all=new N(s&&s.all)}return C}(),b=function(){function C(s){this.messages=new D(s&&s.messages),this.presence=new D(s&&s.presence),this.all=new D(s&&s.all)}return C}(),M=function(){function C(s){this.realtime=new b(s&&s.realtime),this.rest=new b(s&&s.rest),this.webhook=new b(s&&s.webhook),this.sharedQueue=new b(s&&s.sharedQueue),this.externalQueue=new b(s&&s.externalQueue),this.httpEvent=new b(s&&s.httpEvent),this.push=new b(s&&s.push),this.all=new b(s&&s.all)}return C}(),u=function(){function C(s){this.all=new b(s&&s.all),this.inbound=new M(s&&s.inbound),this.outbound=new M(s&&s.outbound)}return C}(),h=function(){function C(s){this.all=new b(s&&s.all),this.producerPaid=new u(s&&s.producerPaid),this.consumerPaid=new u(s&&s.consumerPaid)}return C}(),P=function(){function C(s){this.messages=s&&s.messages||0;var a=s&&s.notifications;this.notifications={invalid:a&&a.invalid||0,attempted:a&&a.attempted||0,successful:a&&a.successful||0,failed:a&&a.failed||0},this.directPublishes=s&&s.directPublishes||0}return C}(),O=function(){function C(s){this.succeeded=s&&s.succeeded||0,this.skipped=s&&s.skipped||0,this.failed=s&&s.failed||0}return C}(),d=function(){function C(s){var a=this;this.delta=void 0,s&&s.delta&&(this.delta={},c.forInOwnNonNullProperties(s.delta,function(t){a.delta[t]=new O(s.delta[t])}))}return C}(),p=function(C){T.__extends(s,C);function s(a){var t=C.call(this,a)||this;return t.persisted=new b(a&&a.persisted),t.connections=new j(a&&a.connections),t.channels=new N(a&&a.channels),t.apiRequests=new H(a&&a.apiRequests),t.tokenRequests=new H(a&&a.tokenRequests),t.xchgProducer=new h(a&&a.xchgProducer),t.xchgConsumer=new h(a&&a.xchgConsumer),t.push=new P(a&&a.pushStats),t.processed=new d(a&&a.processed),t.inProgress=a&&a.inProgress||void 0,t.unit=a&&a.unit||void 0,t.intervalId=a&&a.intervalId||void 0,t}return s.fromValues=function(a){return new s(a)},s}(u);S.default=p},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importStar(g(1)),G=T.__importDefault(g(30)),D=T.__importDefault(g(7)),N=T.__importDefault(g(2)),H=T.__importDefault(g(51)),j=T.__importDefault(g(38)),b=T.__importDefault(g(8)),M=T.__importDefault(g(4)),u=T.__importDefault(g(10)),h=T.__importDefault(g(35)),P=T.__importDefault(g(3)),O=T.__importDefault(g(9)),d=function(C){T.__extends(s,C);function s(a){var t=C.call(this,a)||this;return N.default.logAction(N.default.LOG_MINOR,"Realtime()",""),t.connection=new H.default(t,t.options),t.channels=new p(t),a.autoConnect!==!1&&t.connect(),t}return s.prototype.connect=function(){N.default.logAction(N.default.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()},s.prototype.close=function(){N.default.logAction(N.default.LOG_MINOR,"Realtime.close()",""),this.connection.close()},s.Promise=function(a){return a=b.default.objectifyOptions(a),a.promises=!0,new s(a)},s.Callbacks=s,s.Utils=c,s.ConnectionManager=h.default,s.Platform=P.default,s.ProtocolMessage=u.default,s.Message=O.default,s}(G.default),p=function(C){T.__extends(s,C);function s(a){var t=C.call(this)||this;return t.realtime=a,t.all=Object.create(null),a.connection.connectionManager.on("transport.active",function(){t.onTransportActive()}),t}return s.prototype.channelSerials=function(){for(var a={},t=0,r=c.keysArray(this.all,!0);t<r.length;t++){var l=r[t],i=this.all[l];i.properties.channelSerial&&(a[l]=i.properties.channelSerial)}return a},s.prototype.recoverChannels=function(a){for(var t=0,r=c.keysArray(a,!0);t<r.length;t++){var l=r[t],i=this.get(l);i.properties.channelSerial=a[l]}},s.prototype.onChannelMessage=function(a){var t=a.channel;if(t===void 0){N.default.logAction(N.default.LOG_ERROR,"Channels.onChannelMessage()","received event unspecified channel, action = "+a.action);return}var r=this.all[t];if(!r){N.default.logAction(N.default.LOG_ERROR,"Channels.onChannelMessage()","received event for non-existent channel: "+t);return}r.onMessage(a)},s.prototype.onTransportActive=function(){for(var a in this.all){var t=this.all[a];t.state==="attaching"||t.state==="detaching"?t.checkPendingState():t.state==="suspended"?t._attach(!1,null):t.state==="attached"&&t.requestState("attaching")}},s.prototype.propogateConnectionInterruption=function(a,t){var r={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},l=["attaching","attached","detaching","suspended"],i=r[a];for(var y in this.all){var U=this.all[y];c.arrIn(l,U.state)&&U.notifyState(i,t)}},s.prototype.get=function(a,t){a=String(a);var r=this.all[a];if(!r)r=this.all[a]=new j.default(this.realtime,a,t);else if(t){if(r._shouldReattachToSetOptions(t))throw new M.default("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);r.setOptions(t)}return r},s.prototype.getDerived=function(a,t,r){if(t.filter){var l=c.toBase64(t.filter),i=c.matchDerivedChannel(a);a="[filter=".concat(l).concat(i.qualifierParam,"]").concat(i.channelName)}return this.get(a,r)},s.prototype.release=function(a){a=String(a);var t=this.all[a];if(t){var r=t.getReleaseErr();if(r)throw r;delete this.all[a]}},s}(D.default);S.default=d},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importStar(g(1)),G=T.__importDefault(g(7)),D=T.__importDefault(g(35)),N=T.__importDefault(g(2)),H=T.__importDefault(g(37)),j=T.__importDefault(g(3));function b(){}var M=function(u){T.__extends(h,u);function h(P,O){var d=u.call(this)||this;return d.whenState=function(p,C){return G.default.prototype.whenState.call(d,p,d.state,C,new H.default(void 0,p))},d.ably=P,d.connectionManager=new D.default(P,O),d.state=d.connectionManager.state.state,d.key=void 0,d.id=void 0,d.errorReason=null,d.connectionManager.on("connectionstate",function(p){var C=d.state=p.current;j.default.Config.nextTick(function(){d.emit(C,p)})}),d.connectionManager.on("update",function(p){j.default.Config.nextTick(function(){d.emit("update",p)})}),d}return h.prototype.connect=function(){N.default.logAction(N.default.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})},h.prototype.ping=function(P){if(N.default.logAction(N.default.LOG_MINOR,"Connection.ping()",""),!P){if(this.ably.options.promises)return c.promisify(this,"ping",arguments);P=b}this.connectionManager.ping(null,P)},h.prototype.close=function(){N.default.logAction(N.default.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})},Object.defineProperty(h.prototype,"recoveryKey",{get:function(){return this.createRecoveryKey()},enumerable:!1,configurable:!0}),h.prototype.createRecoveryKey=function(){return this.connectionManager.createRecoveryKey()},h}(G.default);S.default=M},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0}),S.PendingMessage=void 0;var T=g(0),c=T.__importDefault(g(10)),G=T.__importStar(g(1)),D=T.__importDefault(g(7)),N=T.__importDefault(g(2)),H=T.__importDefault(g(36)),j=T.__importDefault(g(4)),b=c.default.Action,M=function(){function h(P,O){this.message=P,this.callback=O,this.merged=!1;var d=P.action;this.sendAttempted=!1,this.ackRequired=d==b.MESSAGE||d==b.PRESENCE}return h}();S.PendingMessage=M;var u=function(h){T.__extends(P,h);function P(O){var d=h.call(this)||this;return d.transport=O,d.messageQueue=new H.default,O.on("ack",function(p,C){d.onAck(p,C)}),O.on("nack",function(p,C,s){d.onNack(p,C,s)}),d}return P.prototype.onAck=function(O,d){N.default.logAction(N.default.LOG_MICRO,"Protocol.onAck()","serial = "+O+"; count = "+d),this.messageQueue.completeMessages(O,d)},P.prototype.onNack=function(O,d,p){N.default.logAction(N.default.LOG_ERROR,"Protocol.onNack()","serial = "+O+"; count = "+d+"; err = "+G.inspectError(p)),p||(p=new j.default("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(O,d,p)},P.prototype.onceIdle=function(O){var d=this.messageQueue;if(d.count()===0){O();return}d.once("idle",O)},P.prototype.send=function(O){O.ackRequired&&this.messageQueue.push(O),N.default.shouldLog(N.default.LOG_MICRO)&&N.default.logAction(N.default.LOG_MICRO,"Protocol.send()","sending msg; "+c.default.stringify(O.message)),O.sendAttempted=!0,this.transport.send(O.message)},P.prototype.getTransport=function(){return this.transport},P.prototype.getPendingMessages=function(){return this.messageQueue.copyAll()},P.prototype.clearPendingMessages=function(){return this.messageQueue.clear()},P.prototype.finish=function(){var O=this.transport;this.onceIdle(function(){O.disconnect()})},P}(D.default);S.default=u},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importDefault(g(3)),G=T.__importStar(g(1)),D=T.__importDefault(g(26)),N=T.__importDefault(g(8)),H=T.__importDefault(g(2)),j=T.__importDefault(g(10)),b=T.__importDefault(g(4)),M="web_socket";function u(O){return!!O.on}var h=function(O){T.__extends(d,O);function d(p,C,s){var a=O.call(this,p,C,s)||this;return a.shortName=M,s.heartbeats=c.default.Config.useProtocolHeartbeats,a.wsHost=N.default.getHost(s.options,s.host,!0),a}return d.isAvailable=function(){return!!c.default.Config.WebSocket},d.prototype.createWebSocket=function(p,C){return this.uri=p+G.toQueryString(C),new c.default.Config.WebSocket(this.uri)},d.prototype.toString=function(){return"WebSocketTransport; uri="+this.uri},d.prototype.connect=function(){H.default.logAction(H.default.LOG_MINOR,"WebSocketTransport.connect()","starting"),D.default.prototype.connect.call(this);var p=this,C=this.params,s=C.options,a=s.tls?"wss://":"ws://",t=a+this.wsHost+":"+N.default.getPort(s)+"/";H.default.logAction(H.default.LOG_MINOR,"WebSocketTransport.connect()","uri: "+t),this.auth.getAuthParams(function(r,l){if(!p.isDisposed){var i="";for(var y in l)i+=" "+y+": "+l[y]+";";if(H.default.logAction(H.default.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+i+" err: "+r),r){p.disconnect(r);return}var U=C.getConnectParams(l);try{var w=p.wsConnection=p.createWebSocket(t,U);w.binaryType=c.default.Config.binaryType,w.onopen=function(){p.onWsOpen()},w.onclose=function(L){p.onWsClose(L)},w.onmessage=function(L){p.onWsData(L.data)},w.onerror=function(L){p.onWsError(L)},u(w)&&w.on("ping",function(){p.onActivity()})}catch(L){H.default.logAction(H.default.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(L.stack||L.message)),p.disconnect(L)}}})},d.prototype.send=function(p){var C=this.wsConnection;if(!C){H.default.logAction(H.default.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{C.send(j.default.serialize(p,this.params.format))}catch(a){var s="Exception from ws connection when trying to send: "+G.inspectError(a);H.default.logAction(H.default.LOG_ERROR,"WebSocketTransport.send()",s),this.finish("disconnected",new b.default(s,5e4,500))}},d.prototype.onWsData=function(p){H.default.logAction(H.default.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+p.length+"; type = "+typeof p);try{this.onProtocolMessage(j.default.deserialize(p,this.format))}catch(C){H.default.logAction(H.default.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+C.stack)}},d.prototype.onWsOpen=function(){H.default.logAction(H.default.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")},d.prototype.onWsClose=function(p){var C,s;if(typeof p=="object"?(s=p.code,C=p.wasClean||s===1e3):(s=p,C=s==1e3),delete this.wsConnection,C){H.default.logAction(H.default.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");var a=new b.default("Websocket closed",80003,400);this.finish("disconnected",a)}else{var t="Unclean disconnection of WebSocket ; code = "+s,a=new b.default(t,80003,400);H.default.logAction(H.default.LOG_MINOR,"WebSocketTransport.onWsClose()",t),this.finish("disconnected",a)}this.emit("disposed")},d.prototype.onWsError=function(p){var C=this;H.default.logAction(H.default.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+p.message),c.default.Config.nextTick(function(){C.disconnect(Error(p.message))})},d.prototype.dispose=function(){H.default.logAction(H.default.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;var p=this.wsConnection;p&&(p.onmessage=function(){},delete this.wsConnection,c.default.Config.nextTick(function(){if(H.default.logAction(H.default.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!p)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");p.close()}))},d}(D.default);function P(O){return h.isAvailable()&&(O.supportedTransports[M]=h),h}S.default=P},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importStar(g(1)),G=T.__importDefault(g(34)),D=T.__importDefault(g(7)),N=T.__importDefault(g(2)),H=T.__importDefault(g(15)),j=T.__importStar(g(4)),b=T.__importDefault(g(38)),M=T.__importDefault(g(23)),u=T.__importDefault(g(39)),h=function(){};function P(a){return a.channel.realtime.auth.clientId}function O(a){var t=a.channel.realtime,r=t.auth.clientId;return(!r||r==="*")&&t.connection.state==="connected"}function d(a,t,r){switch(a.state){case"attached":case"suspended":r();break;case"initialized":case"detached":case"detaching":case"attaching":a.attach(function(l){l?t(l):r()});break;default:t(j.default.fromValues(a.invalidStateError()))}}function p(a,t){if(a.isSynthesized()||t.isSynthesized())return a.timestamp>=t.timestamp;var r=a.parseId(),l=t.parseId();return r.msgSerial===l.msgSerial?r.index>l.index:r.msgSerial>l.msgSerial}var C=function(a){T.__extends(t,a);function t(r){var l=a.call(this,r)||this;return l.channel=r,l.syncComplete=!1,l.members=new s(l,function(i){return i.clientId+":"+i.connectionId}),l._myMembers=new s(l,function(i){return i.clientId}),l.subscriptions=new D.default,l.pendingPresence=[],l}return t.prototype.enter=function(r,l){if(O(this))throw new j.default("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,r,"enter",l)},t.prototype.update=function(r,l){if(O(this))throw new j.default("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,r,"update",l)},t.prototype.enterClient=function(r,l,i){return this._enterOrUpdateClient(void 0,r,l,"enter",i)},t.prototype.updateClient=function(r,l,i){return this._enterOrUpdateClient(void 0,r,l,"update",i)},t.prototype._enterOrUpdateClient=function(r,l,i,y,U){var w=this;if(!U)if(typeof i=="function")U=i,i=null;else{if(this.channel.realtime.options.promises)return c.promisify(this,"_enterOrUpdateClient",[r,l,i,y]);U=h}var L=this.channel;if(!L.connectionManager.activeState()){U(L.connectionManager.getError());return}N.default.logAction(N.default.LOG_MICRO,"RealtimePresence."+y+"Client()","channel = "+L.name+", id = "+r+", client = "+(l||"(implicit) "+P(this)));var x=H.default.fromData(i);x.action=y,r&&(x.id=r),l&&(x.clientId=l),H.default.encode(x,L.channelOptions,function(E){if(E){U(E);return}switch(L.state){case"attached":L.sendPresence(x,U);break;case"initialized":case"detached":L.attach();case"attaching":w.pendingPresence.push({presence:x,callback:U});break;default:E=new j.PartialErrorInfo("Unable to "+y+" presence channel while in "+L.state+" state",90001),E.code=90001,U(E)}})},t.prototype.leave=function(r,l){if(O(this))throw new j.default("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,r,l)},t.prototype.leaveClient=function(r,l,i){if(!i)if(typeof l=="function")i=l,l=null;else{if(this.channel.realtime.options.promises)return c.promisify(this,"leaveClient",[r,l]);i=h}var y=this.channel;if(!y.connectionManager.activeState()){i==null||i(y.connectionManager.getError());return}N.default.logAction(N.default.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+r);var U=H.default.fromData(l);switch(U.action="leave",r&&(U.clientId=r),y.state){case"attached":y.sendPresence(U,i);break;case"attaching":this.pendingPresence.push({presence:U,callback:i});break;case"initialized":case"failed":{var w=new j.PartialErrorInfo("Unable to leave presence channel (incompatible state)",90001);i==null||i(w);break}default:i==null||i(y.invalidStateError())}},t.prototype.get=function(r,l){var i=this,y=Array.prototype.slice.call(arguments);y.length==1&&typeof y[0]=="function"&&y.unshift(null),r=y[0],l=y[1];var U=!r||("waitForSync"in r?r.waitForSync:!0);if(!l){if(this.channel.realtime.options.promises)return c.promisify(this,"get",y);l=h}function w(L){l(null,r?L.list(r):L.values())}if(this.channel.state==="suspended"){U?l(j.default.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):w(this.members);return}d(this.channel,l,function(){var L=i.members;U?L.waitSync(function(){w(L)}):w(L)})},t.prototype.history=function(r,l){if(N.default.logAction(N.default.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name),l===void 0)if(typeof r=="function")l=r,r=null;else{if(this.channel.realtime.options.promises)return c.promisify(this,"history",arguments);l=h}r&&r.untilAttach&&(this.channel.state==="attached"?(delete r.untilAttach,r.from_serial=this.channel.properties.attachSerial):l(new j.default("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400))),G.default.prototype._history.call(this,r,l)},t.prototype.setPresence=function(r,l,i){N.default.logAction(N.default.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+r.length+" participants; syncChannelSerial = "+i);var y,U,w=this.members,L=this._myMembers,x=[],E=this.channel.connectionManager.connectionId;l&&(this.members.startSync(),i&&(U=i.match(/^[\w-]+:(.*)$/))&&(y=U[1]));for(var A=0;A<r.length;A++){var W=H.default.fromValues(r[A]);switch(W.action){case"leave":w.remove(W)&&x.push(W),W.connectionId===E&&!W.isSynthesized()&&L.remove(W);break;case"enter":case"present":case"update":w.put(W)&&x.push(W),W.connectionId===E&&L.put(W);break}}l&&!y&&(w.endSync(),this.channel.syncChannelSerial=null);for(var A=0;A<x.length;A++){var W=x[A];this.subscriptions.emit(W.action,W)}},t.prototype.onAttached=function(r){N.default.logAction(N.default.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+r),r?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();var l=this.pendingPresence,i=l.length;if(i){this.pendingPresence=[];var y=[],U=M.default.create();N.default.logAction(N.default.LOG_MICRO,"RealtimePresence.onAttached","sending "+i+" queued presence messages");for(var w=0;w<i;w++){var L=l[w];y.push(L.presence),U.push(L.callback)}this.channel.sendPresence(y,U)}},t.prototype.actOnChannelState=function(r,l,i){switch(r){case"attached":this.onAttached(l);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(i);break}},t.prototype.failPendingPresence=function(r){if(this.pendingPresence.length){N.default.logAction(N.default.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+c.inspectError(r));for(var l=0;l<this.pendingPresence.length;l++)try{this.pendingPresence[l].callback(r)}catch{}this.pendingPresence=[]}},t.prototype._clearMyMembers=function(){this._myMembers.clear()},t.prototype._ensureMyMembersPresent=function(){var r=this,l=this._myMembers,i=function(w){if(w){var L="Presence auto-re-enter failed: "+w.toString(),x=new j.default(L,91004,400);N.default.logAction(N.default.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()",L);var E=new u.default(r.channel.state,r.channel.state,!0,!1,x);r.channel.emit("update",E)}};for(var y in l.map){var U=l.map[y];N.default.logAction(N.default.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+U.clientId+'" into the presence set'),this._enterOrUpdateClient(U.id,U.clientId,U.data,"enter",i)}},t.prototype._synthesizeLeaves=function(r){var l=this.subscriptions;c.arrForEach(r,function(i){var y=H.default.fromValues({action:"leave",connectionId:i.connectionId,clientId:i.clientId,data:i.data,encoding:i.encoding,timestamp:c.now()});l.emit("leave",y)})},t.prototype.on=function(){for(var r=[],l=0;l<arguments.length;l++)r[l]=arguments[l];N.default.deprecated("presence.on","presence.subscribe"),this.subscribe.apply(this,r)},t.prototype.off=function(){for(var r=[],l=0;l<arguments.length;l++)r[l]=arguments[l];N.default.deprecated("presence.off","presence.unsubscribe"),this.unsubscribe.apply(this,r)},t.prototype.subscribe=function(){for(var r=[],l=0;l<arguments.length;l++)r[l]=arguments[l];var i=b.default.processListenerArgs(r),y=i[0],U=i[1],w=i[2],L=this.channel;if(!w){if(this.channel.realtime.options.promises)return c.promisify(this,"subscribe",[y,U]);w=h}if(L.state==="failed"){w(j.default.fromValues(L.invalidStateError()));return}this.subscriptions.on(y,U),L.attach(w)},t.prototype.unsubscribe=function(){for(var r=[],l=0;l<arguments.length;l++)r[l]=arguments[l];var i=b.default.processListenerArgs(r),y=i[0],U=i[1];this.subscriptions.off(y,U)},t}(G.default),s=function(a){T.__extends(t,a);function t(r,l){var i=a.call(this)||this;return i.presence=r,i.map=Object.create(null),i.syncInProgress=!1,i.residualMembers=null,i.memberKey=l,i}return t.prototype.get=function(r){return this.map[r]},t.prototype.getClient=function(r){var l=this.map,i=[];for(var y in l){var U=l[y];U.clientId==r&&U.action!="absent"&&i.push(U)}return i},t.prototype.list=function(r){var l=this.map,i=r&&r.clientId,y=r&&r.connectionId,U=[];for(var w in l){var L=l[w];L.action!=="absent"&&(i&&i!=L.clientId||y&&y!=L.connectionId||U.push(L))}return U},t.prototype.put=function(r){(r.action==="enter"||r.action==="update")&&(r=H.default.fromValues(r),r.action="present");var l=this.map,i=this.memberKey(r);this.residualMembers&&delete this.residualMembers[i];var y=l[i];return y&&!p(r,y)?!1:(l[i]=r,!0)},t.prototype.values=function(){var r=this.map,l=[];for(var i in r){var y=r[i];y.action!="absent"&&l.push(y)}return l},t.prototype.remove=function(r){var l=this.map,i=this.memberKey(r),y=l[i];return y&&!p(r,y)?!1:(this.syncInProgress?(r=H.default.fromValues(r),r.action="absent",l[i]=r):delete l[i],!0)},t.prototype.startSync=function(){var r=this.map,l=this.syncInProgress;N.default.logAction(N.default.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+l),this.syncInProgress||(this.residualMembers=c.copy(r),this.setInProgress(!0))},t.prototype.endSync=function(){var r=this.map,l=this.syncInProgress;if(N.default.logAction(N.default.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+l),l){for(var i in r){var y=r[i];y.action==="absent"&&delete r[i]}this.presence._synthesizeLeaves(c.valuesArray(this.residualMembers));for(var i in this.residualMembers)delete r[i];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")},t.prototype.waitSync=function(r){var l=this.syncInProgress;if(N.default.logAction(N.default.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+l),!l){r();return}this.once("sync",r)},t.prototype.clear=function(){this.map={},this.setInProgress(!1),this.residualMembers=null},t.prototype.setInProgress=function(r){N.default.logAction(N.default.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+r),this.syncInProgress=r,this.presence.syncComplete=!r},t}(D.default);S.default=C},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=g(56),G=g(31),D=g(11),N=T.__importDefault(g(5)),H=T.__importDefault(g(3)),j=function(){function b(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}return b.prototype.isWordArray=function(M){return M!=null&&M.sigBytes!==void 0},b.prototype.isArrayBuffer=function(M){return M!=null&&M.constructor===ArrayBuffer},b.prototype.isTypedArray=function(M){return!!ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(M)},b.prototype.uint8ViewToBase64=function(M){for(var u="",h=this.base64CharSet,P=M.byteLength,O=P%3,d=P-O,p,C,s,a,t,r=0;r<d;r=r+3)t=M[r]<<16|M[r+1]<<8|M[r+2],p=(t&16515072)>>18,C=(t&258048)>>12,s=(t&4032)>>6,a=t&63,u+=h[p]+h[C]+h[s]+h[a];return O==1?(t=M[d],p=(t&252)>>2,C=(t&3)<<4,u+=h[p]+h[C]+"=="):O==2&&(t=M[d]<<8|M[d+1],p=(t&64512)>>10,C=(t&1008)>>4,s=(t&15)<<2,u+=h[p]+h[C]+h[s]+"="),u},b.prototype.base64ToArrayBuffer=function(M){for(var u=atob==null?void 0:atob(M),h=u.length,P=new Uint8Array(h),O=0;O<h;O++){var d=u.charCodeAt(O);P[O]=d}return P.buffer},b.prototype.isBuffer=function(M){return this.isArrayBuffer(M)||this.isWordArray(M)||this.isTypedArray(M)},b.prototype.toBuffer=function(M){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(this.isArrayBuffer(M))return new Uint8Array(M);if(this.isTypedArray(M))return new Uint8Array(M.buffer);if(this.isWordArray(M)){for(var u=new ArrayBuffer(M.sigBytes),h=new Uint8Array(u),P=0;P<M.sigBytes;P++)h[P]=M.words[P>>>2]>>>24-P%4*8&255;return h}throw new Error("BufferUtils.toBuffer expected an arraybuffer, typed array, or CryptoJS wordarray")},b.prototype.toArrayBuffer=function(M){return this.isArrayBuffer(M)?M:this.toBuffer(M).buffer},b.prototype.toWordArray=function(M){return this.isTypedArray(M)&&(M=M.buffer),this.isWordArray(M)?M:N.default.create(M)},b.prototype.base64Encode=function(M){return this.isWordArray(M)?(0,D.stringify)(M):this.uint8ViewToBase64(this.toBuffer(M))},b.prototype.base64Decode=function(M){return ArrayBuffer&&H.default.Config.atob?this.base64ToArrayBuffer(M):(0,D.parse)(M)},b.prototype.hexEncode=function(M){return(0,c.stringify)(this.toWordArray(M))},b.prototype.hexDecode=function(M){var u=(0,c.parse)(M);return ArrayBuffer?this.toArrayBuffer(u):u},b.prototype.utf8Encode=function(M){return H.default.Config.TextEncoder?new H.default.Config.TextEncoder().encode(M).buffer:(0,G.parse)(M)},b.prototype.utf8Decode=function(M){if(!this.isBuffer(M))throw new Error("Expected input of utf8decode to be an arraybuffer, typed array, or CryptoJS wordarray");return TextDecoder&&!this.isWordArray(M)?new TextDecoder().decode(M):(M=this.toWordArray(M),(0,G.stringify)(M))},b.prototype.bufferCompare=function(M,u){if(!M)return-1;if(!u)return 1;var h=this.toWordArray(M),P=this.toWordArray(u);h.clamp(),P.clamp();var O=h.sigBytes-P.sigBytes;if(O!=0)return O;for(var d=h.words,p=P.words,C=0;C<d.length;C++)if(O=d[C]-p[C],O!=0)return O;return 0},b.prototype.byteLength=function(M){return this.isArrayBuffer(M)||this.isTypedArray(M)?M.byteLength:this.isWordArray(M)?M.sigBytes:-1},b.prototype.typedArrayToBuffer=function(M){return M.buffer},b}();S.default=new j},function(ut,S,g){(function(T,c){ut.exports=c(g(6))})(this,function(T){return T.enc.Hex})},function(ut,S,g){g.r(S);var T=g(5),c=g.n(T),G=g(11),D=g(22),N=g.n(D),H=g(2),j=g.n(H),b=g(4),M=g.n(b),u=function(h,P){var O="aes",d=256,p="cbc",C=16,s=4,a=4294967296,t=2147483648,r;if(h.getRandomWordArray)r=h.getRandomWordArray;else if(typeof Uint32Array<"u"&&h.getRandomValues){var l=new Uint32Array(s);r=function(A,W){var V=A/4,X=V==s?l:new Uint32Array(V);h.getRandomValues(X,function(ot){typeof W<"u"&&W(ot,P.toWordArray(X))})}}else r=function(A,W){j.a.logAction(j.a.LOG_MAJOR,"Ably.Crypto.generateRandom()","Warning: the browser you are using does not support secure cryptographically secure randomness generation; falling back to insecure Math.random()");for(var V=A/4,X=new Array(V),ot=0;ot<V;ot++)X[ot]=Math.floor(Math.random()*a)-t;W(null,c.a.create(X))};function i(A){return A+C&-C}function y(A){if(A.algorithm==="aes"&&A.mode==="cbc"){if(A.keyLength===128||A.keyLength===256)return;throw new Error("Unsupported key length "+A.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function U(A){return A.replace("_","/").replace("-","+")}var w=[c.a.create([269488144,269488144,269488144,269488144],16),c.a.create([16777216],1),c.a.create([33685504],2),c.a.create([50529024],3),c.a.create([67372036],4),c.a.create([84215045,83886080],5),c.a.create([101058054,101056512],6),c.a.create([117901063,117901056],7),c.a.create([134744072,134744072],8),c.a.create([151587081,151587081,150994944],9),c.a.create([168430090,168430090,168427520],10),c.a.create([185273099,185273099,185273088],11),c.a.create([202116108,202116108,202116108],12),c.a.create([218959117,218959117,218959117,218103808],13),c.a.create([235802126,235802126,235802126,235798528],14),c.a.create([252645135,252645135,252645135,252645135],15),c.a.create([269488144,269488144,269488144,269488144],16)];function L(){}function x(){this.algorithm=null,this.keyLength=null,this.mode=null,this.key=null}L.CipherParams=x,L.getDefaultParams=function(A){var W;if(typeof A=="function"||typeof A=="string"){if(j.a.deprecated("Crypto.getDefaultParams(key, callback)","Crypto.getDefaultParams({key: key})"),typeof A=="function")L.generateRandomKey(function(X){A(null,L.getDefaultParams({key:X}))});else if(typeof arguments[1]=="function")arguments[1](null,L.getDefaultParams({key:A}));else throw new Error("Invalid arguments for Crypto.getDefaultParams");return}if(!A.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof A.key=="string"?W=Object(G.parse)(U(A.key)):W=P.toWordArray(A.key);var V=new x;if(V.key=W,V.algorithm=A.algorithm||O,V.keyLength=W.words.length*(4*8),V.mode=A.mode||p,A.keyLength&&A.keyLength!==V.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+A.keyLength+" was specified, but the key actually has length "+V.keyLength);return y(V),V},L.generateRandomKey=function(A,W){arguments.length==1&&typeof A=="function"&&(W=A,A=void 0),r((A||d)/8,function(V,X){W!==void 0&&W(V?M.a.fromValues(V):null,X)})},L.getCipher=function(A){var W=A instanceof x?A:L.getDefaultParams(A);return{cipherParams:W,cipher:new E(W,s,A.iv)}};function E(A,W,V){this.algorithm=A.algorithm+"-"+String(A.keyLength)+"-"+A.mode,this.cjsAlgorithm=A.algorithm.toUpperCase().replace(/-\d+$/,""),this.key=P.toWordArray(A.key),V&&(this.iv=P.toWordArray(V).clone()),this.blockLengthWords=W}return E.prototype.encrypt=function(A,W){j.a.logAction(j.a.LOG_MICRO,"CBCCipher.encrypt()",""),A=P.toWordArray(A);var V=A.sigBytes,X=i(V),ot=this,at=function(){ot.getIv(function($,R){if($){W($);return}var B=ot.encryptCipher.process(A.concat(w[X-V])),k=R.concat(B);W(null,k)})};this.encryptCipher?at():this.iv?(this.encryptCipher=N.a.algo[this.cjsAlgorithm].createEncryptor(this.key,{iv:this.iv}),at()):r(C,function($,R){if($){W($);return}ot.encryptCipher=N.a.algo[ot.cjsAlgorithm].createEncryptor(ot.key,{iv:R}),ot.iv=R,at()})},E.prototype.decrypt=function(A){j.a.logAction(j.a.LOG_MICRO,"CBCCipher.decrypt()",""),A=P.toWordArray(A);var W=this.blockLengthWords,V=A.words,X=c.a.create(V.slice(0,W)),ot=c.a.create(V.slice(W)),at=N.a.algo[this.cjsAlgorithm].createDecryptor(this.key,{iv:X}),$=at.process(ot),R=at.finalize();return at.reset(),R&&R.sigBytes&&$.concat(R),$},E.prototype.getIv=function(A){if(this.iv){var W=this.iv;this.iv=null,A(null,W);return}var V=this;r(C,function(X,ot){if(X){A(X);return}A(null,V.encryptCipher.process(ot))})},L};S.default=u},function(ut,S,g){(function(T,c){ut.exports=c(g(6))})(this,function(T){return function(){var c=T,G=c.lib,D=G.WordArray,N=c.enc;N.Utf16=N.Utf16BE={stringify:function(j){for(var b=j.words,M=j.sigBytes,u=[],h=0;h<M;h+=2){var P=b[h>>>2]>>>16-h%4*8&65535;u.push(String.fromCharCode(P))}return u.join("")},parse:function(j){for(var b=j.length,M=[],u=0;u<b;u++)M[u>>>1]|=j.charCodeAt(u)<<16-u%2*16;return D.create(M,b*2)}},N.Utf16LE={stringify:function(j){for(var b=j.words,M=j.sigBytes,u=[],h=0;h<M;h+=2){var P=H(b[h>>>2]>>>16-h%4*8&65535);u.push(String.fromCharCode(P))}return u.join("")},parse:function(j){for(var b=j.length,M=[],u=0;u<b;u++)M[u>>>1]|=H(j.charCodeAt(u)<<16-u%2*16);return D.create(M,b*2)}};function H(j){return j<<8&4278255360|j>>>8&16711935}}(),T.enc.Utf16})},function(ut,S,g){(function(T,c){ut.exports=c(g(6),g(28))})(this,function(T){return function(c){var G=T,D=G.lib,N=D.CipherParams,H=G.enc,j=H.Hex,b=G.format;b.Hex={stringify:function(M){return M.ciphertext.toString(j)},parse:function(M){var u=j.parse(M);return N.create({ciphertext:u})}}}(),T.format.Hex})},function(ut,S,g){(function(T,c){ut.exports=c(g(6),g(11),g(61),g(27),g(28))})(this,function(T){return function(){var c=T,G=c.lib,D=G.BlockCipher,N=c.algo,H=[],j=[],b=[],M=[],u=[],h=[],P=[],O=[],d=[],p=[];(function(){for(var a=[],t=0;t<256;t++)t<128?a[t]=t<<1:a[t]=t<<1^283;for(var r=0,l=0,t=0;t<256;t++){var i=l^l<<1^l<<2^l<<3^l<<4;i=i>>>8^i&255^99,H[r]=i,j[i]=r;var y=a[r],U=a[y],w=a[U],L=a[i]*257^i*16843008;b[r]=L<<24|L>>>8,M[r]=L<<16|L>>>16,u[r]=L<<8|L>>>24,h[r]=L;var L=w*16843009^U*65537^y*257^r*16843008;P[i]=L<<24|L>>>8,O[i]=L<<16|L>>>16,d[i]=L<<8|L>>>24,p[i]=L,r?(r=y^a[a[a[w^y]]],l^=a[a[l]]):r=l=1}})();var C=[0,1,2,4,8,16,32,64,128,27,54],s=N.AES=D.extend({_doReset:function(){var a;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var t=this._keyPriorReset=this._key,r=t.words,l=t.sigBytes/4,i=this._nRounds=l+6,y=(i+1)*4,U=this._keySchedule=[],w=0;w<y;w++)w<l?U[w]=r[w]:(a=U[w-1],w%l?l>6&&w%l==4&&(a=H[a>>>24]<<24|H[a>>>16&255]<<16|H[a>>>8&255]<<8|H[a&255]):(a=a<<8|a>>>24,a=H[a>>>24]<<24|H[a>>>16&255]<<16|H[a>>>8&255]<<8|H[a&255],a^=C[w/l|0]<<24),U[w]=U[w-l]^a);for(var L=this._invKeySchedule=[],x=0;x<y;x++){var w=y-x;if(x%4)var a=U[w];else var a=U[w-4];x<4||w<=4?L[x]=a:L[x]=P[H[a>>>24]]^O[H[a>>>16&255]]^d[H[a>>>8&255]]^p[H[a&255]]}}},encryptBlock:function(a,t){this._doCryptBlock(a,t,this._keySchedule,b,M,u,h,H)},decryptBlock:function(a,t){var r=a[t+1];a[t+1]=a[t+3],a[t+3]=r,this._doCryptBlock(a,t,this._invKeySchedule,P,O,d,p,j);var r=a[t+1];a[t+1]=a[t+3],a[t+3]=r},_doCryptBlock:function(a,t,r,l,i,y,U,w){for(var L=this._nRounds,x=a[t]^r[0],E=a[t+1]^r[1],A=a[t+2]^r[2],W=a[t+3]^r[3],V=4,X=1;X<L;X++){var ot=l[x>>>24]^i[E>>>16&255]^y[A>>>8&255]^U[W&255]^r[V++],at=l[E>>>24]^i[A>>>16&255]^y[W>>>8&255]^U[x&255]^r[V++],$=l[A>>>24]^i[W>>>16&255]^y[x>>>8&255]^U[E&255]^r[V++],R=l[W>>>24]^i[x>>>16&255]^y[E>>>8&255]^U[A&255]^r[V++];x=ot,E=at,A=$,W=R}var ot=(w[x>>>24]<<24|w[E>>>16&255]<<16|w[A>>>8&255]<<8|w[W&255])^r[V++],at=(w[E>>>24]<<24|w[A>>>16&255]<<16|w[W>>>8&255]<<8|w[x&255])^r[V++],$=(w[A>>>24]<<24|w[W>>>16&255]<<16|w[x>>>8&255]<<8|w[E&255])^r[V++],R=(w[W>>>24]<<24|w[x>>>16&255]<<16|w[E>>>8&255]<<8|w[A&255])^r[V++];a[t]=ot,a[t+1]=at,a[t+2]=$,a[t+3]=R},keySize:256/32});c.AES=D._createHelper(s)}(),T.AES})},function(ut,S,g){(function(T,c){ut.exports=c(g(6))})(this,function(T){return function(c){var G=T,D=G.lib,N=D.WordArray,H=D.Hasher,j=G.algo,b=[];(function(){for(var d=0;d<64;d++)b[d]=c.abs(c.sin(d+1))*4294967296|0})();var M=j.MD5=H.extend({_doReset:function(){this._hash=new N.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(d,p){for(var C=0;C<16;C++){var s=p+C,a=d[s];d[s]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360}var t=this._hash.words,r=d[p+0],l=d[p+1],i=d[p+2],y=d[p+3],U=d[p+4],w=d[p+5],L=d[p+6],x=d[p+7],E=d[p+8],A=d[p+9],W=d[p+10],V=d[p+11],X=d[p+12],ot=d[p+13],at=d[p+14],$=d[p+15],R=t[0],B=t[1],k=t[2],z=t[3];R=u(R,B,k,z,r,7,b[0]),z=u(z,R,B,k,l,12,b[1]),k=u(k,z,R,B,i,17,b[2]),B=u(B,k,z,R,y,22,b[3]),R=u(R,B,k,z,U,7,b[4]),z=u(z,R,B,k,w,12,b[5]),k=u(k,z,R,B,L,17,b[6]),B=u(B,k,z,R,x,22,b[7]),R=u(R,B,k,z,E,7,b[8]),z=u(z,R,B,k,A,12,b[9]),k=u(k,z,R,B,W,17,b[10]),B=u(B,k,z,R,V,22,b[11]),R=u(R,B,k,z,X,7,b[12]),z=u(z,R,B,k,ot,12,b[13]),k=u(k,z,R,B,at,17,b[14]),B=u(B,k,z,R,$,22,b[15]),R=h(R,B,k,z,l,5,b[16]),z=h(z,R,B,k,L,9,b[17]),k=h(k,z,R,B,V,14,b[18]),B=h(B,k,z,R,r,20,b[19]),R=h(R,B,k,z,w,5,b[20]),z=h(z,R,B,k,W,9,b[21]),k=h(k,z,R,B,$,14,b[22]),B=h(B,k,z,R,U,20,b[23]),R=h(R,B,k,z,A,5,b[24]),z=h(z,R,B,k,at,9,b[25]),k=h(k,z,R,B,y,14,b[26]),B=h(B,k,z,R,E,20,b[27]),R=h(R,B,k,z,ot,5,b[28]),z=h(z,R,B,k,i,9,b[29]),k=h(k,z,R,B,x,14,b[30]),B=h(B,k,z,R,X,20,b[31]),R=P(R,B,k,z,w,4,b[32]),z=P(z,R,B,k,E,11,b[33]),k=P(k,z,R,B,V,16,b[34]),B=P(B,k,z,R,at,23,b[35]),R=P(R,B,k,z,l,4,b[36]),z=P(z,R,B,k,U,11,b[37]),k=P(k,z,R,B,x,16,b[38]),B=P(B,k,z,R,W,23,b[39]),R=P(R,B,k,z,ot,4,b[40]),z=P(z,R,B,k,r,11,b[41]),k=P(k,z,R,B,y,16,b[42]),B=P(B,k,z,R,L,23,b[43]),R=P(R,B,k,z,A,4,b[44]),z=P(z,R,B,k,X,11,b[45]),k=P(k,z,R,B,$,16,b[46]),B=P(B,k,z,R,i,23,b[47]),R=O(R,B,k,z,r,6,b[48]),z=O(z,R,B,k,x,10,b[49]),k=O(k,z,R,B,at,15,b[50]),B=O(B,k,z,R,w,21,b[51]),R=O(R,B,k,z,X,6,b[52]),z=O(z,R,B,k,y,10,b[53]),k=O(k,z,R,B,W,15,b[54]),B=O(B,k,z,R,l,21,b[55]),R=O(R,B,k,z,E,6,b[56]),z=O(z,R,B,k,$,10,b[57]),k=O(k,z,R,B,L,15,b[58]),B=O(B,k,z,R,ot,21,b[59]),R=O(R,B,k,z,U,6,b[60]),z=O(z,R,B,k,V,10,b[61]),k=O(k,z,R,B,i,15,b[62]),B=O(B,k,z,R,A,21,b[63]),t[0]=t[0]+R|0,t[1]=t[1]+B|0,t[2]=t[2]+k|0,t[3]=t[3]+z|0},_doFinalize:function(){var d=this._data,p=d.words,C=this._nDataBytes*8,s=d.sigBytes*8;p[s>>>5]|=128<<24-s%32;var a=c.floor(C/4294967296),t=C;p[(s+64>>>9<<4)+15]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360,p[(s+64>>>9<<4)+14]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360,d.sigBytes=(p.length+1)*4,this._process();for(var r=this._hash,l=r.words,i=0;i<4;i++){var y=l[i];l[i]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360}return r},clone:function(){var d=H.clone.call(this);return d._hash=this._hash.clone(),d}});function u(d,p,C,s,a,t,r){var l=d+(p&C|~p&s)+a+r;return(l<<t|l>>>32-t)+p}function h(d,p,C,s,a,t,r){var l=d+(p&s|C&~s)+a+r;return(l<<t|l>>>32-t)+p}function P(d,p,C,s,a,t,r){var l=d+(p^C^s)+a+r;return(l<<t|l>>>32-t)+p}function O(d,p,C,s,a,t,r){var l=d+(C^(p|~s))+a+r;return(l<<t|l>>>32-t)+p}G.MD5=H._createHelper(M),G.HmacMD5=H._createHmacHelper(M)}(Math),T.MD5})},function(ut,S,g){var T;Object.defineProperty(S,"__esModule",{value:!0});var c=g(0),G=c.__importDefault(g(3)),D=c.__importStar(g(1)),N=c.__importDefault(g(8)),H=g(4),j=c.__importDefault(g(18)),b=c.__importDefault(g(16)),M=c.__importDefault(g(21)),u=c.__importDefault(g(2)),h=g(29),P=c.__importDefault(g(63)),O=g(25);function d(s){var a=s.statusCode;return a===408&&!s.code||a===400&&!s.code||a>=500&&a<=504}function p(s){var a=s.connection,t=a&&a.connectionManager.host;return t?[t].concat(N.default.getFallbackHosts(s.options)):N.default.getHosts(s.options)}var C=(T=function(){function s(a){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this._getHosts=p,this.options=a||{};var t=this.options.connectivityCheckUrl||N.default.connectivityCheckUrl,r=this.options.connectivityCheckParams,l=!this.options.connectivityCheckUrl;G.default.Config.xhrSupported?(this.supportsAuthHeaders=!0,this.Request=function(i,y,U,w,L,x,E){var A=b.default.createRequest(U,w,L,x,M.default.REQ_SEND,y&&y.options.timeouts,i);return A.once("complete",E),A.exec(),A},this.options.disableConnectivityCheck?this.checkConnectivity=function(i){i(null,!0)}:this.checkConnectivity=function(i){u.default.logAction(u.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+t),this.doUri(j.default.Get,null,t,null,null,r,function(y,U,w,L,x){var E=!1;l?E=!y&&(U==null?void 0:U.replace(/\n/,""))=="yes":E=!y&&(0,O.isSuccessCode)(x),u.default.logAction(u.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+E),i(null,E)})}):G.default.Config.jsonpSupported?(this.Request=function(i,y,U,w,L,x,E){var A=(0,h.createRequest)(U,w,L,x,M.default.REQ_SEND,y&&y.options.timeouts,i);return A.once("complete",E),G.default.Config.nextTick(function(){A.exec()}),A},this.options.disableConnectivityCheck?this.checkConnectivity=function(i){i(null,!0)}:this.checkConnectivity=function(i){var y=this,U=N.default.jsonpInternetUpUrl;if(this.checksInProgress){this.checksInProgress.push(i);return}this.checksInProgress=[i],u.default.logAction(u.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Sending; "+U);var w=new h.Request("isTheInternetUp",U,null,null,null,M.default.REQ_SEND,N.default.TIMEOUTS);w.once("complete",function(L,x){var E=!L&&x;u.default.logAction(u.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Result: "+E);for(var A=0;A<y.checksInProgress.length;A++)y.checksInProgress[A](null,E);y.checksInProgress=null}),G.default.Config.nextTick(function(){w.exec()})}):G.default.Config.fetchSupported?(this.supportsAuthHeaders=!0,this.Request=P.default,this.checkConnectivity=function(i){u.default.logAction(u.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+t),this.doUri(j.default.Get,null,t,null,null,null,function(y,U){var w=!y&&(U==null?void 0:U.replace(/\n/,""))=="yes";u.default.logAction(u.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+w),i(null,w)})}):this.Request=function(i,y,U,w,L,x,E){E(new H.PartialErrorInfo("no supported HTTP transports available",null,400),null)}}return s.prototype.do=function(a,t,r,l,i,y,U){var w=this,L=typeof r=="function"?r:function(W){return t.baseUri(W)+r},x=t._currentFallback;if(x)if(x.validUntil>D.now()){if(!this.Request){U==null||U(new H.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(a,t,L(x.host),l,y,i,function(W){for(var V=[],X=1;X<arguments.length;X++)V[X-1]=arguments[X];if(W&&d(W)){t._currentFallback=null,w.do(a,t,r,l,i,y,U);return}U==null||U.apply(void 0,c.__spreadArray([W],V,!1))});return}else t._currentFallback=null;var E=p(t);if(E.length===1){this.doUri(a,t,L(E[0]),l,i,y,U);return}var A=function(W,V){var X=W.shift();w.doUri(a,t,L(X),l,i,y,function(ot){for(var at=[],$=1;$<arguments.length;$++)at[$-1]=arguments[$];if(ot&&d(ot)&&W.length){A(W,!0);return}V&&(t._currentFallback={host:X,validUntil:D.now()+t.options.timeouts.fallbackRetryTimeout}),U==null||U.apply(void 0,c.__spreadArray([ot],at,!1))})};A(E)},s.prototype.doUri=function(a,t,r,l,i,y,U){if(!this.Request){U(new H.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(a,t,r,l,y,i,U)},s}(),T.methods=[j.default.Get,j.default.Delete,j.default.Post,j.default.Put,j.default.Patch],T.methodsWithoutBody=[j.default.Get,j.default.Delete],T.methodsWithBody=[j.default.Post,j.default.Put,j.default.Patch],T);S.default=C},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importStar(g(4)),G=T.__importDefault(g(3)),D=T.__importDefault(g(8)),N=T.__importStar(g(1)),H=g(1);function j(u,h){return!!h.get("x-ably-errorcode")}function b(u,h){if(j(u,h))return u.error&&c.default.fromValues(u.error)}function M(u,h,P,O,d,p,C){var s=new Headers(O||{}),a=u?u.toUpperCase():N.isEmptyArg(p)?"GET":"POST",t=new AbortController,r=setTimeout(function(){t.abort(),C(new c.PartialErrorInfo("Request timed out",null,408))},h?h.options.timeouts.httpRequestTimeout:D.default.TIMEOUTS.httpRequestTimeout),l={method:a,headers:s,body:p};G.default.Config.isWebworker||(l.credentials=s.has("authorization")?"include":"same-origin"),(0,H.getGlobalObject)().fetch(P+"?"+new URLSearchParams(d||{}),l).then(function(i){clearTimeout(r);var y=i.headers.get("Content-Type"),U;y&&y.indexOf("application/x-msgpack")>-1?U=i.arrayBuffer():y&&y.indexOf("application/json")>-1?U=i.json():U=i.text(),U.then(function(w){var L=!!y&&y.indexOf("application/x-msgpack")===-1;if(i.ok)C(null,w,i.headers,L,i.status);else{var x=b(w,i.headers)||new c.PartialErrorInfo("Error response received from server: "+i.status+" body was: "+G.default.Config.inspect(w),null,i.status);C(x,w,i.headers,L,i.status)}})}).catch(function(i){clearTimeout(r),C(i)})}S.default=M},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importDefault(g(41)),G=T.__importStar(g(1)),D=G.getGlobalObject();typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function N(){var M=D.location;return!D.WebSocket||!M||!M.origin||M.origin.indexOf("http")>-1}var H=D.navigator&&D.navigator.userAgent.toString(),j=D.location&&D.location.href,b={agent:"browser",logTimestamps:!0,userAgent:H,currentUrl:j,noUpgrade:H&&!!H.match(/MSIE\s8\.0/),binaryType:"arraybuffer",WebSocket:D.WebSocket,fetchSupported:!!D.fetch,xhrSupported:D.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,jsonpSupported:typeof document<"u",allowComet:N(),streamingSupported:!0,useProtocolHeartbeats:!0,createHmac:null,msgpack:c.default,supportsBinary:!!D.TextDecoder,preferBinary:!1,ArrayBuffer:D.ArrayBuffer,atob:D.atob,nextTick:typeof D.setImmediate<"u"?D.setImmediate.bind(D):function(M){setTimeout(M,0)},addEventListener:D.addEventListener,inspect:JSON.stringify,stringByteSize:function(M){return D.TextDecoder&&new D.TextEncoder().encode(M).length||M.length},TextEncoder:D.TextEncoder,TextDecoder:D.TextDecoder,Promise:D.Promise,getRandomValues:function(M){if(M!==void 0)return function(u,h){M.getRandomValues(u),h&&h(null)}}(D.crypto||msCrypto)};S.default=b},function(ut,S,g){(function(T){Object.defineProperty(S,"__esModule",{value:!0});var c=g(0),G=c.__importStar(g(1)),D="ablyjs-storage-test",N=function(){function H(){try{T.sessionStorage.setItem(D,D),T.sessionStorage.removeItem(D),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{T.localStorage.setItem(D,D),T.localStorage.removeItem(D),this.localSupported=!0}catch{this.localSupported=!1}}return H.prototype.get=function(j){return this._get(j,!1)},H.prototype.getSession=function(j){return this._get(j,!0)},H.prototype.remove=function(j){return this._remove(j,!1)},H.prototype.removeSession=function(j){return this._remove(j,!0)},H.prototype.set=function(j,b,M){return this._set(j,b,M,!1)},H.prototype.setSession=function(j,b,M){return this._set(j,b,M,!0)},H.prototype._set=function(j,b,M,u){var h={value:b};return M&&(h.expires=G.now()+M),this.storageInterface(u).setItem(j,JSON.stringify(h))},H.prototype._get=function(j,b){if(b&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!b&&!this.localSupported)throw new Error("Local Storage not supported");var M=this.storageInterface(b).getItem(j);if(!M)return null;var u=JSON.parse(M);return u.expires&&u.expires<G.now()?(this.storageInterface(b).removeItem(j),null):u.value},H.prototype._remove=function(j,b){return this.storageInterface(b).removeItem(j)},H.prototype.storageInterface=function(j){return j?T.sessionStorage:T.localStorage},H}();S.default=new N}).call(this,g(13))},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T=g(0),c=T.__importDefault(g(67)),G={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",jsonpInternetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up-0-9.js",defaultTransports:[c.default.XhrPolling,c.default.XhrStreaming,c.default.JsonP,c.default.WebSocket],baseTransportOrder:[c.default.XhrPolling,c.default.XhrStreaming,c.default.JsonP,c.default.WebSocket],transportPreferenceOrder:[c.default.JsonP,c.default.XhrPolling,c.default.XhrStreaming,c.default.WebSocket],upgradeTransports:[c.default.XhrStreaming,c.default.WebSocket]};S.default=G},function(ut,S,g){Object.defineProperty(S,"__esModule",{value:!0});var T;(function(c){c.WebSocket="web_socket",c.Comet="comet",c.XhrStreaming="xhr_streaming",c.XhrPolling="xhr_polling",c.JsonP="jsonp"})(T||(T={})),S.default=T},function(ut,S,g){g.r(S);var T=g(29),c=g.n(T),G=g(1),D=g(3),N=g.n(D),H=g(12),j=g.n(H),b=g(16),M=g.n(b),u=function(d){var p="xhr_polling";function C(s,a,t){t.stream=!1,j.a.call(this,s,a,t),this.shortName=p}return G.inherits(C,j.a),C.isAvailable=function(){return N.a.Config.xhrSupported&&N.a.Config.allowComet},C.prototype.toString=function(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},C.prototype.createRequest=function(s,a,t,r,l){return M.a.createRequest(s,a,t,r,l,this.timeouts)},typeof d<"u"&&C.isAvailable()&&(d.supportedTransports[p]=C),C},h=u,P=function(d){var p="xhr_streaming";function C(s,a,t){j.a.call(this,s,a,t),this.shortName=p}return G.inherits(C,j.a),C.isAvailable=function(){return N.a.Config.xhrSupported&&N.a.Config.streamingSupported&&N.a.Config.allowComet},C.prototype.toString=function(){return"XHRStreamingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},C.prototype.createRequest=function(s,a,t,r,l){return M.a.createRequest(s,a,t,r,l,this.timeouts)},typeof d<"u"&&C.isAvailable()&&(d.supportedTransports[p]=C),C},O=P;S.default=[c.a,h,O]}]).default})})(Yn);var Kr=Yn.exports,Zn={exports:{}},mn={exports:{}};/*!
 * jQuery JavaScript Library v3.7.1
 * https://jquery.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2023-08-28T13:37Z
 */var $n;function Qr(){return $n||($n=1,function(zt){(function(bt,ut){zt.exports=bt.document?ut(bt,!0):function(S){if(!S.document)throw new Error("jQuery requires a window with a document");return ut(S)}})(typeof window<"u"?window:zr,function(bt,ut){var S=[],g=Object.getPrototypeOf,T=S.slice,c=S.flat?function(e){return S.flat.call(e)}:function(e){return S.concat.apply([],e)},G=S.push,D=S.indexOf,N={},H=N.toString,j=N.hasOwnProperty,b=j.toString,M=b.call(Object),u={},h=function(n){return typeof n=="function"&&typeof n.nodeType!="number"&&typeof n.item!="function"},P=function(n){return n!=null&&n===n.window},O=bt.document,d={type:!0,src:!0,nonce:!0,noModule:!0};function p(e,n,o){o=o||O;var f,v,m=o.createElement("script");if(m.text=e,n)for(f in d)v=n[f]||n.getAttribute&&n.getAttribute(f),v&&m.setAttribute(f,v);o.head.appendChild(m).parentNode.removeChild(m)}function C(e){return e==null?e+"":typeof e=="object"||typeof e=="function"?N[H.call(e)]||"object":typeof e}var s="3.7.1",a=/HTML$/i,t=function(e,n){return new t.fn.init(e,n)};t.fn=t.prototype={jquery:s,constructor:t,length:0,toArray:function(){return T.call(this)},get:function(e){return e==null?T.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var n=t.merge(this.constructor(),e);return n.prevObject=this,n},each:function(e){return t.each(this,e)},map:function(e){return this.pushStack(t.map(this,function(n,o){return e.call(n,o,n)}))},slice:function(){return this.pushStack(T.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(t.grep(this,function(e,n){return(n+1)%2}))},odd:function(){return this.pushStack(t.grep(this,function(e,n){return n%2}))},eq:function(e){var n=this.length,o=+e+(e<0?n:0);return this.pushStack(o>=0&&o<n?[this[o]]:[])},end:function(){return this.prevObject||this.constructor()},push:G,sort:S.sort,splice:S.splice},t.extend=t.fn.extend=function(){var e,n,o,f,v,m,I=arguments[0]||{},q=1,_=arguments.length,J=!1;for(typeof I=="boolean"&&(J=I,I=arguments[q]||{},q++),typeof I!="object"&&!h(I)&&(I={}),q===_&&(I=this,q--);q<_;q++)if((e=arguments[q])!=null)for(n in e)f=e[n],!(n==="__proto__"||I===f)&&(J&&f&&(t.isPlainObject(f)||(v=Array.isArray(f)))?(o=I[n],v&&!Array.isArray(o)?m=[]:!v&&!t.isPlainObject(o)?m={}:m=o,v=!1,I[n]=t.extend(J,m,f)):f!==void 0&&(I[n]=f));return I},t.extend({expando:"jQuery"+(s+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var n,o;return!e||H.call(e)!=="[object Object]"?!1:(n=g(e),n?(o=j.call(n,"constructor")&&n.constructor,typeof o=="function"&&b.call(o)===M):!0)},isEmptyObject:function(e){var n;for(n in e)return!1;return!0},globalEval:function(e,n,o){p(e,{nonce:n&&n.nonce},o)},each:function(e,n){var o,f=0;if(r(e))for(o=e.length;f<o&&n.call(e[f],f,e[f])!==!1;f++);else for(f in e)if(n.call(e[f],f,e[f])===!1)break;return e},text:function(e){var n,o="",f=0,v=e.nodeType;if(!v)for(;n=e[f++];)o+=t.text(n);return v===1||v===11?e.textContent:v===9?e.documentElement.textContent:v===3||v===4?e.nodeValue:o},makeArray:function(e,n){var o=n||[];return e!=null&&(r(Object(e))?t.merge(o,typeof e=="string"?[e]:e):G.call(o,e)),o},inArray:function(e,n,o){return n==null?-1:D.call(n,e,o)},isXMLDoc:function(e){var n=e&&e.namespaceURI,o=e&&(e.ownerDocument||e).documentElement;return!a.test(n||o&&o.nodeName||"HTML")},merge:function(e,n){for(var o=+n.length,f=0,v=e.length;f<o;f++)e[v++]=n[f];return e.length=v,e},grep:function(e,n,o){for(var f,v=[],m=0,I=e.length,q=!o;m<I;m++)f=!n(e[m],m),f!==q&&v.push(e[m]);return v},map:function(e,n,o){var f,v,m=0,I=[];if(r(e))for(f=e.length;m<f;m++)v=n(e[m],m,o),v!=null&&I.push(v);else for(m in e)v=n(e[m],m,o),v!=null&&I.push(v);return c(I)},guid:1,support:u}),typeof Symbol=="function"&&(t.fn[Symbol.iterator]=S[Symbol.iterator]),t.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,n){N["[object "+n+"]"]=n.toLowerCase()});function r(e){var n=!!e&&"length"in e&&e.length,o=C(e);return h(e)||P(e)?!1:o==="array"||n===0||typeof n=="number"&&n>0&&n-1 in e}function l(e,n){return e.nodeName&&e.nodeName.toLowerCase()===n.toLowerCase()}var i=S.pop,y=S.sort,U=S.splice,w="[\\x20\\t\\r\\n\\f]",L=new RegExp("^"+w+"+|((?:^|[^\\\\])(?:\\\\.)*)"+w+"+$","g");t.contains=function(e,n){var o=n&&n.parentNode;return e===o||!!(o&&o.nodeType===1&&(e.contains?e.contains(o):e.compareDocumentPosition&&e.compareDocumentPosition(o)&16))};var x=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function E(e,n){return n?e==="\0"?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}t.escapeSelector=function(e){return(e+"").replace(x,E)};var A=O,W=G;(function(){var e,n,o,f,v,m=W,I,q,_,J,nt,it=t.expando,Z=0,lt=0,Et=ze(),jt=ze(),wt=ze(),Vt=ze(),_t=function(F,K){return F===K&&(v=!0),0},se="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ue="(?:\\\\[\\da-fA-F]{1,6}"+w+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",Lt="\\["+w+"*("+ue+")(?:"+w+"*([*^$|!~]?=)"+w+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+ue+"))|)"+w+"*\\]",Te=":("+ue+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Lt+")*)|.*)\\)|)",Ut=new RegExp(w+"+","g"),Wt=new RegExp("^"+w+"*,"+w+"*"),Be=new RegExp("^"+w+"*([>+~]|"+w+")"+w+"*"),cn=new RegExp(w+"|>"),fe=new RegExp(Te),He=new RegExp("^"+ue+"$"),le={ID:new RegExp("^#("+ue+")"),CLASS:new RegExp("^\\.("+ue+")"),TAG:new RegExp("^("+ue+"|[*])"),ATTR:new RegExp("^"+Lt),PSEUDO:new RegExp("^"+Te),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+w+"*(even|odd|(([+-]|)(\\d*)n|)"+w+"*(?:([+-]|)"+w+"*(\\d+)|))"+w+"*\\)|)","i"),bool:new RegExp("^(?:"+se+")$","i"),needsContext:new RegExp("^"+w+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+w+"*((?:-\\d)?\\d*)"+w+"*\\)|)(?=[^-]|$)","i")},ye=/^(?:input|select|textarea|button)$/i,me=/^h\d$/i,re=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,dn=/[+~]/,pe=new RegExp("\\\\[\\da-fA-F]{1,6}"+w+"?|\\\\([^\\r\\n\\f])","g"),ge=function(F,K){var Y="0x"+F.slice(1)-65536;return K||(Y<0?String.fromCharCode(Y+65536):String.fromCharCode(Y>>10|55296,Y&1023|56320))},Hr=function(){Ce()},Gr=Ke(function(F){return F.disabled===!0&&l(F,"fieldset")},{dir:"parentNode",next:"legend"});function kr(){try{return I.activeElement}catch{}}try{m.apply(S=T.call(A.childNodes),A.childNodes),S[A.childNodes.length].nodeType}catch{m={apply:function(K,Y){W.apply(K,T.call(Y))},call:function(K){W.apply(K,T.call(arguments,1))}}}function Bt(F,K,Y,tt){var rt,ht,pt,mt,gt,Pt,Rt,xt=K&&K.ownerDocument,Dt=K?K.nodeType:9;if(Y=Y||[],typeof F!="string"||!F||Dt!==1&&Dt!==9&&Dt!==11)return Y;if(!tt&&(Ce(K),K=K||I,_)){if(Dt!==11&&(gt=re.exec(F)))if(rt=gt[1]){if(Dt===9)if(pt=K.getElementById(rt)){if(pt.id===rt)return m.call(Y,pt),Y}else return Y;else if(xt&&(pt=xt.getElementById(rt))&&Bt.contains(K,pt)&&pt.id===rt)return m.call(Y,pt),Y}else{if(gt[2])return m.apply(Y,K.getElementsByTagName(F)),Y;if((rt=gt[3])&&K.getElementsByClassName)return m.apply(Y,K.getElementsByClassName(rt)),Y}if(!Vt[F+" "]&&(!J||!J.test(F))){if(Rt=F,xt=K,Dt===1&&(cn.test(F)||Be.test(F))){for(xt=dn.test(F)&&hn(K.parentNode)||K,(xt!=K||!u.scope)&&((mt=K.getAttribute("id"))?mt=t.escapeSelector(mt):K.setAttribute("id",mt=it)),Pt=Ge(F),ht=Pt.length;ht--;)Pt[ht]=(mt?"#"+mt:":scope")+" "+qe(Pt[ht]);Rt=Pt.join(",")}try{return m.apply(Y,xt.querySelectorAll(Rt)),Y}catch{Vt(F,!0)}finally{mt===it&&K.removeAttribute("id")}}}return Xn(F.replace(L,"$1"),K,Y,tt)}function ze(){var F=[];function K(Y,tt){return F.push(Y+" ")>n.cacheLength&&delete K[F.shift()],K[Y+" "]=tt}return K}function ae(F){return F[it]=!0,F}function we(F){var K=I.createElement("fieldset");try{return!!F(K)}catch{return!1}finally{K.parentNode&&K.parentNode.removeChild(K),K=null}}function Fr(F){return function(K){return l(K,"input")&&K.type===F}}function Wr(F){return function(K){return(l(K,"input")||l(K,"button"))&&K.type===F}}function Qn(F){return function(K){return"form"in K?K.parentNode&&K.disabled===!1?"label"in K?"label"in K.parentNode?K.parentNode.disabled===F:K.disabled===F:K.isDisabled===F||K.isDisabled!==!F&&Gr(K)===F:K.disabled===F:"label"in K?K.disabled===F:!1}}function Ae(F){return ae(function(K){return K=+K,ae(function(Y,tt){for(var rt,ht=F([],Y.length,K),pt=ht.length;pt--;)Y[rt=ht[pt]]&&(Y[rt]=!(tt[rt]=Y[rt]))})})}function hn(F){return F&&typeof F.getElementsByTagName<"u"&&F}function Ce(F){var K,Y=F?F.ownerDocument||F:A;return Y==I||Y.nodeType!==9||!Y.documentElement||(I=Y,q=I.documentElement,_=!t.isXMLDoc(I),nt=q.matches||q.webkitMatchesSelector||q.msMatchesSelector,q.msMatchesSelector&&A!=I&&(K=I.defaultView)&&K.top!==K&&K.addEventListener("unload",Hr),u.getById=we(function(tt){return q.appendChild(tt).id=t.expando,!I.getElementsByName||!I.getElementsByName(t.expando).length}),u.disconnectedMatch=we(function(tt){return nt.call(tt,"*")}),u.scope=we(function(){return I.querySelectorAll(":scope")}),u.cssHas=we(function(){try{return I.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),u.getById?(n.filter.ID=function(tt){var rt=tt.replace(pe,ge);return function(ht){return ht.getAttribute("id")===rt}},n.find.ID=function(tt,rt){if(typeof rt.getElementById<"u"&&_){var ht=rt.getElementById(tt);return ht?[ht]:[]}}):(n.filter.ID=function(tt){var rt=tt.replace(pe,ge);return function(ht){var pt=typeof ht.getAttributeNode<"u"&&ht.getAttributeNode("id");return pt&&pt.value===rt}},n.find.ID=function(tt,rt){if(typeof rt.getElementById<"u"&&_){var ht,pt,mt,gt=rt.getElementById(tt);if(gt){if(ht=gt.getAttributeNode("id"),ht&&ht.value===tt)return[gt];for(mt=rt.getElementsByName(tt),pt=0;gt=mt[pt++];)if(ht=gt.getAttributeNode("id"),ht&&ht.value===tt)return[gt]}return[]}}),n.find.TAG=function(tt,rt){return typeof rt.getElementsByTagName<"u"?rt.getElementsByTagName(tt):rt.querySelectorAll(tt)},n.find.CLASS=function(tt,rt){if(typeof rt.getElementsByClassName<"u"&&_)return rt.getElementsByClassName(tt)},J=[],we(function(tt){var rt;q.appendChild(tt).innerHTML="<a id='"+it+"' href='' disabled='disabled'></a><select id='"+it+"-\r\\' disabled='disabled'><option selected=''></option></select>",tt.querySelectorAll("[selected]").length||J.push("\\["+w+"*(?:value|"+se+")"),tt.querySelectorAll("[id~="+it+"-]").length||J.push("~="),tt.querySelectorAll("a#"+it+"+*").length||J.push(".#.+[+~]"),tt.querySelectorAll(":checked").length||J.push(":checked"),rt=I.createElement("input"),rt.setAttribute("type","hidden"),tt.appendChild(rt).setAttribute("name","D"),q.appendChild(tt).disabled=!0,tt.querySelectorAll(":disabled").length!==2&&J.push(":enabled",":disabled"),rt=I.createElement("input"),rt.setAttribute("name",""),tt.appendChild(rt),tt.querySelectorAll("[name='']").length||J.push("\\["+w+"*name"+w+"*="+w+`*(?:''|"")`)}),u.cssHas||J.push(":has"),J=J.length&&new RegExp(J.join("|")),_t=function(tt,rt){if(tt===rt)return v=!0,0;var ht=!tt.compareDocumentPosition-!rt.compareDocumentPosition;return ht||(ht=(tt.ownerDocument||tt)==(rt.ownerDocument||rt)?tt.compareDocumentPosition(rt):1,ht&1||!u.sortDetached&&rt.compareDocumentPosition(tt)===ht?tt===I||tt.ownerDocument==A&&Bt.contains(A,tt)?-1:rt===I||rt.ownerDocument==A&&Bt.contains(A,rt)?1:f?D.call(f,tt)-D.call(f,rt):0:ht&4?-1:1)}),I}Bt.matches=function(F,K){return Bt(F,null,null,K)},Bt.matchesSelector=function(F,K){if(Ce(F),_&&!Vt[K+" "]&&(!J||!J.test(K)))try{var Y=nt.call(F,K);if(Y||u.disconnectedMatch||F.document&&F.document.nodeType!==11)return Y}catch{Vt(K,!0)}return Bt(K,I,null,[F]).length>0},Bt.contains=function(F,K){return(F.ownerDocument||F)!=I&&Ce(F),t.contains(F,K)},Bt.attr=function(F,K){(F.ownerDocument||F)!=I&&Ce(F);var Y=n.attrHandle[K.toLowerCase()],tt=Y&&j.call(n.attrHandle,K.toLowerCase())?Y(F,K,!_):void 0;return tt!==void 0?tt:F.getAttribute(K)},Bt.error=function(F){throw new Error("Syntax error, unrecognized expression: "+F)},t.uniqueSort=function(F){var K,Y=[],tt=0,rt=0;if(v=!u.sortStable,f=!u.sortStable&&T.call(F,0),y.call(F,_t),v){for(;K=F[rt++];)K===F[rt]&&(tt=Y.push(rt));for(;tt--;)U.call(F,Y[tt],1)}return f=null,F},t.fn.uniqueSort=function(){return this.pushStack(t.uniqueSort(T.apply(this)))},n=t.expr={cacheLength:50,createPseudo:ae,match:le,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(F){return F[1]=F[1].replace(pe,ge),F[3]=(F[3]||F[4]||F[5]||"").replace(pe,ge),F[2]==="~="&&(F[3]=" "+F[3]+" "),F.slice(0,4)},CHILD:function(F){return F[1]=F[1].toLowerCase(),F[1].slice(0,3)==="nth"?(F[3]||Bt.error(F[0]),F[4]=+(F[4]?F[5]+(F[6]||1):2*(F[3]==="even"||F[3]==="odd")),F[5]=+(F[7]+F[8]||F[3]==="odd")):F[3]&&Bt.error(F[0]),F},PSEUDO:function(F){var K,Y=!F[6]&&F[2];return le.CHILD.test(F[0])?null:(F[3]?F[2]=F[4]||F[5]||"":Y&&fe.test(Y)&&(K=Ge(Y,!0))&&(K=Y.indexOf(")",Y.length-K)-Y.length)&&(F[0]=F[0].slice(0,K),F[2]=Y.slice(0,K)),F.slice(0,3))}},filter:{TAG:function(F){var K=F.replace(pe,ge).toLowerCase();return F==="*"?function(){return!0}:function(Y){return l(Y,K)}},CLASS:function(F){var K=Et[F+" "];return K||(K=new RegExp("(^|"+w+")"+F+"("+w+"|$)"))&&Et(F,function(Y){return K.test(typeof Y.className=="string"&&Y.className||typeof Y.getAttribute<"u"&&Y.getAttribute("class")||"")})},ATTR:function(F,K,Y){return function(tt){var rt=Bt.attr(tt,F);return rt==null?K==="!=":K?(rt+="",K==="="?rt===Y:K==="!="?rt!==Y:K==="^="?Y&&rt.indexOf(Y)===0:K==="*="?Y&&rt.indexOf(Y)>-1:K==="$="?Y&&rt.slice(-Y.length)===Y:K==="~="?(" "+rt.replace(Ut," ")+" ").indexOf(Y)>-1:K==="|="?rt===Y||rt.slice(0,Y.length+1)===Y+"-":!1):!0}},CHILD:function(F,K,Y,tt,rt){var ht=F.slice(0,3)!=="nth",pt=F.slice(-4)!=="last",mt=K==="of-type";return tt===1&&rt===0?function(gt){return!!gt.parentNode}:function(gt,Pt,Rt){var xt,Dt,At,Gt,Yt,Kt=ht!==pt?"nextSibling":"previousSibling",ie=gt.parentNode,ce=mt&&gt.nodeName.toLowerCase(),Pe=!Rt&&!mt,Jt=!1;if(ie){if(ht){for(;Kt;){for(At=gt;At=At[Kt];)if(mt?l(At,ce):At.nodeType===1)return!1;Yt=Kt=F==="only"&&!Yt&&"nextSibling"}return!0}if(Yt=[pt?ie.firstChild:ie.lastChild],pt&&Pe){for(Dt=ie[it]||(ie[it]={}),xt=Dt[F]||[],Gt=xt[0]===Z&&xt[1],Jt=Gt&&xt[2],At=Gt&&ie.childNodes[Gt];At=++Gt&&At&&At[Kt]||(Jt=Gt=0)||Yt.pop();)if(At.nodeType===1&&++Jt&&At===gt){Dt[F]=[Z,Gt,Jt];break}}else if(Pe&&(Dt=gt[it]||(gt[it]={}),xt=Dt[F]||[],Gt=xt[0]===Z&&xt[1],Jt=Gt),Jt===!1)for(;(At=++Gt&&At&&At[Kt]||(Jt=Gt=0)||Yt.pop())&&!((mt?l(At,ce):At.nodeType===1)&&++Jt&&(Pe&&(Dt=At[it]||(At[it]={}),Dt[F]=[Z,Jt]),At===gt)););return Jt-=rt,Jt===tt||Jt%tt===0&&Jt/tt>=0}}},PSEUDO:function(F,K){var Y,tt=n.pseudos[F]||n.setFilters[F.toLowerCase()]||Bt.error("unsupported pseudo: "+F);return tt[it]?tt(K):tt.length>1?(Y=[F,F,"",K],n.setFilters.hasOwnProperty(F.toLowerCase())?ae(function(rt,ht){for(var pt,mt=tt(rt,K),gt=mt.length;gt--;)pt=D.call(rt,mt[gt]),rt[pt]=!(ht[pt]=mt[gt])}):function(rt){return tt(rt,0,Y)}):tt}},pseudos:{not:ae(function(F){var K=[],Y=[],tt=yn(F.replace(L,"$1"));return tt[it]?ae(function(rt,ht,pt,mt){for(var gt,Pt=tt(rt,null,mt,[]),Rt=rt.length;Rt--;)(gt=Pt[Rt])&&(rt[Rt]=!(ht[Rt]=gt))}):function(rt,ht,pt){return K[0]=rt,tt(K,null,pt,Y),K[0]=null,!Y.pop()}}),has:ae(function(F){return function(K){return Bt(F,K).length>0}}),contains:ae(function(F){return F=F.replace(pe,ge),function(K){return(K.textContent||t.text(K)).indexOf(F)>-1}}),lang:ae(function(F){return He.test(F||"")||Bt.error("unsupported lang: "+F),F=F.replace(pe,ge).toLowerCase(),function(K){var Y;do if(Y=_?K.lang:K.getAttribute("xml:lang")||K.getAttribute("lang"))return Y=Y.toLowerCase(),Y===F||Y.indexOf(F+"-")===0;while((K=K.parentNode)&&K.nodeType===1);return!1}}),target:function(F){var K=bt.location&&bt.location.hash;return K&&K.slice(1)===F.id},root:function(F){return F===q},focus:function(F){return F===kr()&&I.hasFocus()&&!!(F.type||F.href||~F.tabIndex)},enabled:Qn(!1),disabled:Qn(!0),checked:function(F){return l(F,"input")&&!!F.checked||l(F,"option")&&!!F.selected},selected:function(F){return F.parentNode&&F.parentNode.selectedIndex,F.selected===!0},empty:function(F){for(F=F.firstChild;F;F=F.nextSibling)if(F.nodeType<6)return!1;return!0},parent:function(F){return!n.pseudos.empty(F)},header:function(F){return me.test(F.nodeName)},input:function(F){return ye.test(F.nodeName)},button:function(F){return l(F,"input")&&F.type==="button"||l(F,"button")},text:function(F){var K;return l(F,"input")&&F.type==="text"&&((K=F.getAttribute("type"))==null||K.toLowerCase()==="text")},first:Ae(function(){return[0]}),last:Ae(function(F,K){return[K-1]}),eq:Ae(function(F,K,Y){return[Y<0?Y+K:Y]}),even:Ae(function(F,K){for(var Y=0;Y<K;Y+=2)F.push(Y);return F}),odd:Ae(function(F,K){for(var Y=1;Y<K;Y+=2)F.push(Y);return F}),lt:Ae(function(F,K,Y){var tt;for(Y<0?tt=Y+K:Y>K?tt=K:tt=Y;--tt>=0;)F.push(tt);return F}),gt:Ae(function(F,K,Y){for(var tt=Y<0?Y+K:Y;++tt<K;)F.push(tt);return F})}},n.pseudos.nth=n.pseudos.eq;for(e in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[e]=Fr(e);for(e in{submit:!0,reset:!0})n.pseudos[e]=Wr(e);function Jn(){}Jn.prototype=n.filters=n.pseudos,n.setFilters=new Jn;function Ge(F,K){var Y,tt,rt,ht,pt,mt,gt,Pt=jt[F+" "];if(Pt)return K?0:Pt.slice(0);for(pt=F,mt=[],gt=n.preFilter;pt;){(!Y||(tt=Wt.exec(pt)))&&(tt&&(pt=pt.slice(tt[0].length)||pt),mt.push(rt=[])),Y=!1,(tt=Be.exec(pt))&&(Y=tt.shift(),rt.push({value:Y,type:tt[0].replace(L," ")}),pt=pt.slice(Y.length));for(ht in n.filter)(tt=le[ht].exec(pt))&&(!gt[ht]||(tt=gt[ht](tt)))&&(Y=tt.shift(),rt.push({value:Y,type:ht,matches:tt}),pt=pt.slice(Y.length));if(!Y)break}return K?pt.length:pt?Bt.error(F):jt(F,mt).slice(0)}function qe(F){for(var K=0,Y=F.length,tt="";K<Y;K++)tt+=F[K].value;return tt}function Ke(F,K,Y){var tt=K.dir,rt=K.next,ht=rt||tt,pt=Y&&ht==="parentNode",mt=lt++;return K.first?function(gt,Pt,Rt){for(;gt=gt[tt];)if(gt.nodeType===1||pt)return F(gt,Pt,Rt);return!1}:function(gt,Pt,Rt){var xt,Dt,At=[Z,mt];if(Rt){for(;gt=gt[tt];)if((gt.nodeType===1||pt)&&F(gt,Pt,Rt))return!0}else for(;gt=gt[tt];)if(gt.nodeType===1||pt)if(Dt=gt[it]||(gt[it]={}),rt&&l(gt,rt))gt=gt[tt]||gt;else{if((xt=Dt[ht])&&xt[0]===Z&&xt[1]===mt)return At[2]=xt[2];if(Dt[ht]=At,At[2]=F(gt,Pt,Rt))return!0}return!1}}function pn(F){return F.length>1?function(K,Y,tt){for(var rt=F.length;rt--;)if(!F[rt](K,Y,tt))return!1;return!0}:F[0]}function _r(F,K,Y){for(var tt=0,rt=K.length;tt<rt;tt++)Bt(F,K[tt],Y);return Y}function Qe(F,K,Y,tt,rt){for(var ht,pt=[],mt=0,gt=F.length,Pt=K!=null;mt<gt;mt++)(ht=F[mt])&&(!Y||Y(ht,tt,rt))&&(pt.push(ht),Pt&&K.push(mt));return pt}function gn(F,K,Y,tt,rt,ht){return tt&&!tt[it]&&(tt=gn(tt)),rt&&!rt[it]&&(rt=gn(rt,ht)),ae(function(pt,mt,gt,Pt){var Rt,xt,Dt,At,Gt=[],Yt=[],Kt=mt.length,ie=pt||_r(K||"*",gt.nodeType?[gt]:gt,[]),ce=F&&(pt||!K)?Qe(ie,Gt,F,gt,Pt):ie;if(Y?(At=rt||(pt?F:Kt||tt)?[]:mt,Y(ce,At,gt,Pt)):At=ce,tt)for(Rt=Qe(At,Yt),tt(Rt,[],gt,Pt),xt=Rt.length;xt--;)(Dt=Rt[xt])&&(At[Yt[xt]]=!(ce[Yt[xt]]=Dt));if(pt){if(rt||F){if(rt){for(Rt=[],xt=At.length;xt--;)(Dt=At[xt])&&Rt.push(ce[xt]=Dt);rt(null,At=[],Rt,Pt)}for(xt=At.length;xt--;)(Dt=At[xt])&&(Rt=rt?D.call(pt,Dt):Gt[xt])>-1&&(pt[Rt]=!(mt[Rt]=Dt))}}else At=Qe(At===mt?At.splice(Kt,At.length):At),rt?rt(null,mt,At,Pt):m.apply(mt,At)})}function vn(F){for(var K,Y,tt,rt=F.length,ht=n.relative[F[0].type],pt=ht||n.relative[" "],mt=ht?1:0,gt=Ke(function(xt){return xt===K},pt,!0),Pt=Ke(function(xt){return D.call(K,xt)>-1},pt,!0),Rt=[function(xt,Dt,At){var Gt=!ht&&(At||Dt!=o)||((K=Dt).nodeType?gt(xt,Dt,At):Pt(xt,Dt,At));return K=null,Gt}];mt<rt;mt++)if(Y=n.relative[F[mt].type])Rt=[Ke(pn(Rt),Y)];else{if(Y=n.filter[F[mt].type].apply(null,F[mt].matches),Y[it]){for(tt=++mt;tt<rt&&!n.relative[F[tt].type];tt++);return gn(mt>1&&pn(Rt),mt>1&&qe(F.slice(0,mt-1).concat({value:F[mt-2].type===" "?"*":""})).replace(L,"$1"),Y,mt<tt&&vn(F.slice(mt,tt)),tt<rt&&vn(F=F.slice(tt)),tt<rt&&qe(F))}Rt.push(Y)}return pn(Rt)}function Vr(F,K){var Y=K.length>0,tt=F.length>0,rt=function(ht,pt,mt,gt,Pt){var Rt,xt,Dt,At=0,Gt="0",Yt=ht&&[],Kt=[],ie=o,ce=ht||tt&&n.find.TAG("*",Pt),Pe=Z+=ie==null?1:Math.random()||.1,Jt=ce.length;for(Pt&&(o=pt==I||pt||Pt);Gt!==Jt&&(Rt=ce[Gt])!=null;Gt++){if(tt&&Rt){for(xt=0,!pt&&Rt.ownerDocument!=I&&(Ce(Rt),mt=!_);Dt=F[xt++];)if(Dt(Rt,pt||I,mt)){m.call(gt,Rt);break}Pt&&(Z=Pe)}Y&&((Rt=!Dt&&Rt)&&At--,ht&&Yt.push(Rt))}if(At+=Gt,Y&&Gt!==At){for(xt=0;Dt=K[xt++];)Dt(Yt,Kt,pt,mt);if(ht){if(At>0)for(;Gt--;)Yt[Gt]||Kt[Gt]||(Kt[Gt]=i.call(gt));Kt=Qe(Kt)}m.apply(gt,Kt),Pt&&!ht&&Kt.length>0&&At+K.length>1&&t.uniqueSort(gt)}return Pt&&(Z=Pe,o=ie),Yt};return Y?ae(rt):rt}function yn(F,K){var Y,tt=[],rt=[],ht=wt[F+" "];if(!ht){for(K||(K=Ge(F)),Y=K.length;Y--;)ht=vn(K[Y]),ht[it]?tt.push(ht):rt.push(ht);ht=wt(F,Vr(rt,tt)),ht.selector=F}return ht}function Xn(F,K,Y,tt){var rt,ht,pt,mt,gt,Pt=typeof F=="function"&&F,Rt=!tt&&Ge(F=Pt.selector||F);if(Y=Y||[],Rt.length===1){if(ht=Rt[0]=Rt[0].slice(0),ht.length>2&&(pt=ht[0]).type==="ID"&&K.nodeType===9&&_&&n.relative[ht[1].type]){if(K=(n.find.ID(pt.matches[0].replace(pe,ge),K)||[])[0],K)Pt&&(K=K.parentNode);else return Y;F=F.slice(ht.shift().value.length)}for(rt=le.needsContext.test(F)?0:ht.length;rt--&&(pt=ht[rt],!n.relative[mt=pt.type]);)if((gt=n.find[mt])&&(tt=gt(pt.matches[0].replace(pe,ge),dn.test(ht[0].type)&&hn(K.parentNode)||K))){if(ht.splice(rt,1),F=tt.length&&qe(ht),!F)return m.apply(Y,tt),Y;break}}return(Pt||yn(F,Rt))(tt,K,!_,Y,!K||dn.test(F)&&hn(K.parentNode)||K),Y}u.sortStable=it.split("").sort(_t).join("")===it,Ce(),u.sortDetached=we(function(F){return F.compareDocumentPosition(I.createElement("fieldset"))&1}),t.find=Bt,t.expr[":"]=t.expr.pseudos,t.unique=t.uniqueSort,Bt.compile=yn,Bt.select=Xn,Bt.setDocument=Ce,Bt.tokenize=Ge,Bt.escape=t.escapeSelector,Bt.getText=t.text,Bt.isXML=t.isXMLDoc,Bt.selectors=t.expr,Bt.support=t.support,Bt.uniqueSort=t.uniqueSort})();var V=function(e,n,o){for(var f=[],v=o!==void 0;(e=e[n])&&e.nodeType!==9;)if(e.nodeType===1){if(v&&t(e).is(o))break;f.push(e)}return f},X=function(e,n){for(var o=[];e;e=e.nextSibling)e.nodeType===1&&e!==n&&o.push(e);return o},ot=t.expr.match.needsContext,at=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function $(e,n,o){return h(n)?t.grep(e,function(f,v){return!!n.call(f,v,f)!==o}):n.nodeType?t.grep(e,function(f){return f===n!==o}):typeof n!="string"?t.grep(e,function(f){return D.call(n,f)>-1!==o}):t.filter(n,e,o)}t.filter=function(e,n,o){var f=n[0];return o&&(e=":not("+e+")"),n.length===1&&f.nodeType===1?t.find.matchesSelector(f,e)?[f]:[]:t.find.matches(e,t.grep(n,function(v){return v.nodeType===1}))},t.fn.extend({find:function(e){var n,o,f=this.length,v=this;if(typeof e!="string")return this.pushStack(t(e).filter(function(){for(n=0;n<f;n++)if(t.contains(v[n],this))return!0}));for(o=this.pushStack([]),n=0;n<f;n++)t.find(e,v[n],o);return f>1?t.uniqueSort(o):o},filter:function(e){return this.pushStack($(this,e||[],!1))},not:function(e){return this.pushStack($(this,e||[],!0))},is:function(e){return!!$(this,typeof e=="string"&&ot.test(e)?t(e):e||[],!1).length}});var R,B=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,k=t.fn.init=function(e,n,o){var f,v;if(!e)return this;if(o=o||R,typeof e=="string")if(e[0]==="<"&&e[e.length-1]===">"&&e.length>=3?f=[null,e,null]:f=B.exec(e),f&&(f[1]||!n))if(f[1]){if(n=n instanceof t?n[0]:n,t.merge(this,t.parseHTML(f[1],n&&n.nodeType?n.ownerDocument||n:O,!0)),at.test(f[1])&&t.isPlainObject(n))for(f in n)h(this[f])?this[f](n[f]):this.attr(f,n[f]);return this}else return v=O.getElementById(f[2]),v&&(this[0]=v,this.length=1),this;else return!n||n.jquery?(n||o).find(e):this.constructor(n).find(e);else{if(e.nodeType)return this[0]=e,this.length=1,this;if(h(e))return o.ready!==void 0?o.ready(e):e(t)}return t.makeArray(e,this)};k.prototype=t.fn,R=t(O);var z=/^(?:parents|prev(?:Until|All))/,et={children:!0,contents:!0,next:!0,prev:!0};t.fn.extend({has:function(e){var n=t(e,this),o=n.length;return this.filter(function(){for(var f=0;f<o;f++)if(t.contains(this,n[f]))return!0})},closest:function(e,n){var o,f=0,v=this.length,m=[],I=typeof e!="string"&&t(e);if(!ot.test(e)){for(;f<v;f++)for(o=this[f];o&&o!==n;o=o.parentNode)if(o.nodeType<11&&(I?I.index(o)>-1:o.nodeType===1&&t.find.matchesSelector(o,e))){m.push(o);break}}return this.pushStack(m.length>1?t.uniqueSort(m):m)},index:function(e){return e?typeof e=="string"?D.call(t(e),this[0]):D.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,n){return this.pushStack(t.uniqueSort(t.merge(this.get(),t(e,n))))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}});function ct(e,n){for(;(e=e[n])&&e.nodeType!==1;);return e}t.each({parent:function(e){var n=e.parentNode;return n&&n.nodeType!==11?n:null},parents:function(e){return V(e,"parentNode")},parentsUntil:function(e,n,o){return V(e,"parentNode",o)},next:function(e){return ct(e,"nextSibling")},prev:function(e){return ct(e,"previousSibling")},nextAll:function(e){return V(e,"nextSibling")},prevAll:function(e){return V(e,"previousSibling")},nextUntil:function(e,n,o){return V(e,"nextSibling",o)},prevUntil:function(e,n,o){return V(e,"previousSibling",o)},siblings:function(e){return X((e.parentNode||{}).firstChild,e)},children:function(e){return X(e.firstChild)},contents:function(e){return e.contentDocument!=null&&g(e.contentDocument)?e.contentDocument:(l(e,"template")&&(e=e.content||e),t.merge([],e.childNodes))}},function(e,n){t.fn[e]=function(o,f){var v=t.map(this,n,o);return e.slice(-5)!=="Until"&&(f=o),f&&typeof f=="string"&&(v=t.filter(f,v)),this.length>1&&(et[e]||t.uniqueSort(v),z.test(e)&&v.reverse()),this.pushStack(v)}});var dt=/[^\x20\t\r\n\f]+/g;function Ot(e){var n={};return t.each(e.match(dt)||[],function(o,f){n[f]=!0}),n}t.Callbacks=function(e){e=typeof e=="string"?Ot(e):t.extend({},e);var n,o,f,v,m=[],I=[],q=-1,_=function(){for(v=v||e.once,f=n=!0;I.length;q=-1)for(o=I.shift();++q<m.length;)m[q].apply(o[0],o[1])===!1&&e.stopOnFalse&&(q=m.length,o=!1);e.memory||(o=!1),n=!1,v&&(o?m=[]:m="")},J={add:function(){return m&&(o&&!n&&(q=m.length-1,I.push(o)),function nt(it){t.each(it,function(Z,lt){h(lt)?(!e.unique||!J.has(lt))&&m.push(lt):lt&&lt.length&&C(lt)!=="string"&&nt(lt)})}(arguments),o&&!n&&_()),this},remove:function(){return t.each(arguments,function(nt,it){for(var Z;(Z=t.inArray(it,m,Z))>-1;)m.splice(Z,1),Z<=q&&q--}),this},has:function(nt){return nt?t.inArray(nt,m)>-1:m.length>0},empty:function(){return m&&(m=[]),this},disable:function(){return v=I=[],m=o="",this},disabled:function(){return!m},lock:function(){return v=I=[],!o&&!n&&(m=o=""),this},locked:function(){return!!v},fireWith:function(nt,it){return v||(it=it||[],it=[nt,it.slice?it.slice():it],I.push(it),n||_()),this},fire:function(){return J.fireWith(this,arguments),this},fired:function(){return!!f}};return J};function St(e){return e}function Mt(e){throw e}function vt(e,n,o,f){var v;try{e&&h(v=e.promise)?v.call(e).done(n).fail(o):e&&h(v=e.then)?v.call(e,n,o):n.apply(void 0,[e].slice(f))}catch(m){o.apply(void 0,[m])}}t.extend({Deferred:function(e){var n=[["notify","progress",t.Callbacks("memory"),t.Callbacks("memory"),2],["resolve","done",t.Callbacks("once memory"),t.Callbacks("once memory"),0,"resolved"],["reject","fail",t.Callbacks("once memory"),t.Callbacks("once memory"),1,"rejected"]],o="pending",f={state:function(){return o},always:function(){return v.done(arguments).fail(arguments),this},catch:function(m){return f.then(null,m)},pipe:function(){var m=arguments;return t.Deferred(function(I){t.each(n,function(q,_){var J=h(m[_[4]])&&m[_[4]];v[_[1]](function(){var nt=J&&J.apply(this,arguments);nt&&h(nt.promise)?nt.promise().progress(I.notify).done(I.resolve).fail(I.reject):I[_[0]+"With"](this,J?[nt]:arguments)})}),m=null}).promise()},then:function(m,I,q){var _=0;function J(nt,it,Z,lt){return function(){var Et=this,jt=arguments,wt=function(){var _t,se;if(!(nt<_)){if(_t=Z.apply(Et,jt),_t===it.promise())throw new TypeError("Thenable self-resolution");se=_t&&(typeof _t=="object"||typeof _t=="function")&&_t.then,h(se)?lt?se.call(_t,J(_,it,St,lt),J(_,it,Mt,lt)):(_++,se.call(_t,J(_,it,St,lt),J(_,it,Mt,lt),J(_,it,St,it.notifyWith))):(Z!==St&&(Et=void 0,jt=[_t]),(lt||it.resolveWith)(Et,jt))}},Vt=lt?wt:function(){try{wt()}catch(_t){t.Deferred.exceptionHook&&t.Deferred.exceptionHook(_t,Vt.error),nt+1>=_&&(Z!==Mt&&(Et=void 0,jt=[_t]),it.rejectWith(Et,jt))}};nt?Vt():(t.Deferred.getErrorHook?Vt.error=t.Deferred.getErrorHook():t.Deferred.getStackHook&&(Vt.error=t.Deferred.getStackHook()),bt.setTimeout(Vt))}}return t.Deferred(function(nt){n[0][3].add(J(0,nt,h(q)?q:St,nt.notifyWith)),n[1][3].add(J(0,nt,h(m)?m:St)),n[2][3].add(J(0,nt,h(I)?I:Mt))}).promise()},promise:function(m){return m!=null?t.extend(m,f):f}},v={};return t.each(n,function(m,I){var q=I[2],_=I[5];f[I[1]]=q.add,_&&q.add(function(){o=_},n[3-m][2].disable,n[3-m][3].disable,n[0][2].lock,n[0][3].lock),q.add(I[3].fire),v[I[0]]=function(){return v[I[0]+"With"](this===v?void 0:this,arguments),this},v[I[0]+"With"]=q.fireWith}),f.promise(v),e&&e.call(v,v),v},when:function(e){var n=arguments.length,o=n,f=Array(o),v=T.call(arguments),m=t.Deferred(),I=function(q){return function(_){f[q]=this,v[q]=arguments.length>1?T.call(arguments):_,--n||m.resolveWith(f,v)}};if(n<=1&&(vt(e,m.done(I(o)).resolve,m.reject,!n),m.state()==="pending"||h(v[o]&&v[o].then)))return m.then();for(;o--;)vt(v[o],I(o),m.reject);return m.promise()}});var Ht=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;t.Deferred.exceptionHook=function(e,n){bt.console&&bt.console.warn&&e&&Ht.test(e.name)&&bt.console.warn("jQuery.Deferred exception: "+e.message,e.stack,n)},t.readyException=function(e){bt.setTimeout(function(){throw e})};var Ft=t.Deferred();t.fn.ready=function(e){return Ft.then(e).catch(function(n){t.readyException(n)}),this},t.extend({isReady:!1,readyWait:1,ready:function(e){(e===!0?--t.readyWait:t.isReady)||(t.isReady=!0,!(e!==!0&&--t.readyWait>0)&&Ft.resolveWith(O,[t]))}}),t.ready.then=Ft.then;function Tt(){O.removeEventListener("DOMContentLoaded",Tt),bt.removeEventListener("load",Tt),t.ready()}O.readyState==="complete"||O.readyState!=="loading"&&!O.documentElement.doScroll?bt.setTimeout(t.ready):(O.addEventListener("DOMContentLoaded",Tt),bt.addEventListener("load",Tt));var Nt=function(e,n,o,f,v,m,I){var q=0,_=e.length,J=o==null;if(C(o)==="object"){v=!0;for(q in o)Nt(e,n,q,o[q],!0,m,I)}else if(f!==void 0&&(v=!0,h(f)||(I=!0),J&&(I?(n.call(e,f),n=null):(J=n,n=function(nt,it,Z){return J.call(t(nt),Z)})),n))for(;q<_;q++)n(e[q],o,I?f:f.call(e[q],q,n(e[q],o)));return v?e:J?n.call(e):_?n(e[0],o):m},Zt=/^-ms-/,ve=/-([a-z])/g;function te(e,n){return n.toUpperCase()}function Qt(e){return e.replace(Zt,"ms-").replace(ve,te)}var de=function(e){return e.nodeType===1||e.nodeType===9||!+e.nodeType};function he(){this.expando=t.expando+he.uid++}he.uid=1,he.prototype={cache:function(e){var n=e[this.expando];return n||(n={},de(e)&&(e.nodeType?e[this.expando]=n:Object.defineProperty(e,this.expando,{value:n,configurable:!0}))),n},set:function(e,n,o){var f,v=this.cache(e);if(typeof n=="string")v[Qt(n)]=o;else for(f in n)v[Qt(f)]=n[f];return v},get:function(e,n){return n===void 0?this.cache(e):e[this.expando]&&e[this.expando][Qt(n)]},access:function(e,n,o){return n===void 0||n&&typeof n=="string"&&o===void 0?this.get(e,n):(this.set(e,n,o),o!==void 0?o:n)},remove:function(e,n){var o,f=e[this.expando];if(f!==void 0){if(n!==void 0)for(Array.isArray(n)?n=n.map(Qt):(n=Qt(n),n=n in f?[n]:n.match(dt)||[]),o=n.length;o--;)delete f[n[o]];(n===void 0||t.isEmptyObject(f))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var n=e[this.expando];return n!==void 0&&!t.isEmptyObject(n)}};var Ct=new he,qt=new he,Je=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Q=/[A-Z]/g;function st(e){return e==="true"?!0:e==="false"?!1:e==="null"?null:e===+e+""?+e:Je.test(e)?JSON.parse(e):e}function ft(e,n,o){var f;if(o===void 0&&e.nodeType===1)if(f="data-"+n.replace(Q,"-$&").toLowerCase(),o=e.getAttribute(f),typeof o=="string"){try{o=st(o)}catch{}qt.set(e,n,o)}else o=void 0;return o}t.extend({hasData:function(e){return qt.hasData(e)||Ct.hasData(e)},data:function(e,n,o){return qt.access(e,n,o)},removeData:function(e,n){qt.remove(e,n)},_data:function(e,n,o){return Ct.access(e,n,o)},_removeData:function(e,n){Ct.remove(e,n)}}),t.fn.extend({data:function(e,n){var o,f,v,m=this[0],I=m&&m.attributes;if(e===void 0){if(this.length&&(v=qt.get(m),m.nodeType===1&&!Ct.get(m,"hasDataAttrs"))){for(o=I.length;o--;)I[o]&&(f=I[o].name,f.indexOf("data-")===0&&(f=Qt(f.slice(5)),ft(m,f,v[f])));Ct.set(m,"hasDataAttrs",!0)}return v}return typeof e=="object"?this.each(function(){qt.set(this,e)}):Nt(this,function(q){var _;if(m&&q===void 0)return _=qt.get(m,e),_!==void 0||(_=ft(m,e),_!==void 0)?_:void 0;this.each(function(){qt.set(this,e,q)})},null,n,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){qt.remove(this,e)})}}),t.extend({queue:function(e,n,o){var f;if(e)return n=(n||"fx")+"queue",f=Ct.get(e,n),o&&(!f||Array.isArray(o)?f=Ct.access(e,n,t.makeArray(o)):f.push(o)),f||[]},dequeue:function(e,n){n=n||"fx";var o=t.queue(e,n),f=o.length,v=o.shift(),m=t._queueHooks(e,n),I=function(){t.dequeue(e,n)};v==="inprogress"&&(v=o.shift(),f--),v&&(n==="fx"&&o.unshift("inprogress"),delete m.stop,v.call(e,I,m)),!f&&m&&m.empty.fire()},_queueHooks:function(e,n){var o=n+"queueHooks";return Ct.get(e,o)||Ct.access(e,o,{empty:t.Callbacks("once memory").add(function(){Ct.remove(e,[n+"queue",o])})})}}),t.fn.extend({queue:function(e,n){var o=2;return typeof e!="string"&&(n=e,e="fx",o--),arguments.length<o?t.queue(this[0],e):n===void 0?this:this.each(function(){var f=t.queue(this,e,n);t._queueHooks(this,e),e==="fx"&&f[0]!=="inprogress"&&t.dequeue(this,e)})},dequeue:function(e){return this.each(function(){t.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var o,f=1,v=t.Deferred(),m=this,I=this.length,q=function(){--f||v.resolveWith(m,[m])};for(typeof e!="string"&&(n=e,e=void 0),e=e||"fx";I--;)o=Ct.get(m[I],e+"queueHooks"),o&&o.empty&&(f++,o.empty.add(q));return q(),v.promise(n)}});var yt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,It=new RegExp("^(?:([+-])=|)("+yt+")([a-z%]*)$","i"),kt=["Top","Right","Bottom","Left"],ee=O.documentElement,Re=function(e){return t.contains(e.ownerDocument,e)},nr={composed:!0};ee.getRootNode&&(Re=function(e){return t.contains(e.ownerDocument,e)||e.getRootNode(nr)===e.ownerDocument});var ke=function(e,n){return e=n||e,e.style.display==="none"||e.style.display===""&&Re(e)&&t.css(e,"display")==="none"};function Cn(e,n,o,f){var v,m,I=20,q=f?function(){return f.cur()}:function(){return t.css(e,n,"")},_=q(),J=o&&o[3]||(t.cssNumber[n]?"":"px"),nt=e.nodeType&&(t.cssNumber[n]||J!=="px"&&+_)&&It.exec(t.css(e,n));if(nt&&nt[3]!==J){for(_=_/2,J=J||nt[3],nt=+_||1;I--;)t.style(e,n,nt+J),(1-m)*(1-(m=q()/_||.5))<=0&&(I=0),nt=nt/m;nt=nt*2,t.style(e,n,nt+J),o=o||[]}return o&&(nt=+nt||+_||0,v=o[1]?nt+(o[1]+1)*o[2]:+o[2],f&&(f.unit=J,f.start=nt,f.end=v)),v}var On={};function rr(e){var n,o=e.ownerDocument,f=e.nodeName,v=On[f];return v||(n=o.body.appendChild(o.createElement(f)),v=t.css(n,"display"),n.parentNode.removeChild(n),v==="none"&&(v="block"),On[f]=v,v)}function be(e,n){for(var o,f,v=[],m=0,I=e.length;m<I;m++)f=e[m],f.style&&(o=f.style.display,n?(o==="none"&&(v[m]=Ct.get(f,"display")||null,v[m]||(f.style.display="")),f.style.display===""&&ke(f)&&(v[m]=rr(f))):o!=="none"&&(v[m]="none",Ct.set(f,"display",o)));for(m=0;m<I;m++)v[m]!=null&&(e[m].style.display=v[m]);return e}t.fn.extend({show:function(){return be(this,!0)},hide:function(){return be(this)},toggle:function(e){return typeof e=="boolean"?e?this.show():this.hide():this.each(function(){ke(this)?t(this).show():t(this).hide()})}});var De=/^(?:checkbox|radio)$/i,Sn=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Tn=/^$|^module$|\/(?:java|ecma)script/i;(function(){var e=O.createDocumentFragment(),n=e.appendChild(O.createElement("div")),o=O.createElement("input");o.setAttribute("type","radio"),o.setAttribute("checked","checked"),o.setAttribute("name","t"),n.appendChild(o),u.checkClone=n.cloneNode(!0).cloneNode(!0).lastChild.checked,n.innerHTML="<textarea>x</textarea>",u.noCloneChecked=!!n.cloneNode(!0).lastChild.defaultValue,n.innerHTML="<option></option>",u.option=!!n.lastChild})();var ne={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ne.tbody=ne.tfoot=ne.colgroup=ne.caption=ne.thead,ne.th=ne.td,u.option||(ne.optgroup=ne.option=[1,"<select multiple='multiple'>","</select>"]);function Xt(e,n){var o;return typeof e.getElementsByTagName<"u"?o=e.getElementsByTagName(n||"*"):typeof e.querySelectorAll<"u"?o=e.querySelectorAll(n||"*"):o=[],n===void 0||n&&l(e,n)?t.merge([e],o):o}function Xe(e,n){for(var o=0,f=e.length;o<f;o++)Ct.set(e[o],"globalEval",!n||Ct.get(n[o],"globalEval"))}var ir=/<|&#?\w+;/;function An(e,n,o,f,v){for(var m,I,q,_,J,nt,it=n.createDocumentFragment(),Z=[],lt=0,Et=e.length;lt<Et;lt++)if(m=e[lt],m||m===0)if(C(m)==="object")t.merge(Z,m.nodeType?[m]:m);else if(!ir.test(m))Z.push(n.createTextNode(m));else{for(I=I||it.appendChild(n.createElement("div")),q=(Sn.exec(m)||["",""])[1].toLowerCase(),_=ne[q]||ne._default,I.innerHTML=_[1]+t.htmlPrefilter(m)+_[2],nt=_[0];nt--;)I=I.lastChild;t.merge(Z,I.childNodes),I=it.firstChild,I.textContent=""}for(it.textContent="",lt=0;m=Z[lt++];){if(f&&t.inArray(m,f)>-1){v&&v.push(m);continue}if(J=Re(m),I=Xt(it.appendChild(m),"script"),J&&Xe(I),o)for(nt=0;m=I[nt++];)Tn.test(m.type||"")&&o.push(m)}return it}var Rn=/^([^.]*)(?:\.(.+)|)/;function Ee(){return!0}function xe(){return!1}function $e(e,n,o,f,v,m){var I,q;if(typeof n=="object"){typeof o!="string"&&(f=f||o,o=void 0);for(q in n)$e(e,q,o,f,n[q],m);return e}if(f==null&&v==null?(v=o,f=o=void 0):v==null&&(typeof o=="string"?(v=f,f=void 0):(v=f,f=o,o=void 0)),v===!1)v=xe;else if(!v)return e;return m===1&&(I=v,v=function(_){return t().off(_),I.apply(this,arguments)},v.guid=I.guid||(I.guid=t.guid++)),e.each(function(){t.event.add(this,n,v,f,o)})}t.event={global:{},add:function(e,n,o,f,v){var m,I,q,_,J,nt,it,Z,lt,Et,jt,wt=Ct.get(e);if(de(e))for(o.handler&&(m=o,o=m.handler,v=m.selector),v&&t.find.matchesSelector(ee,v),o.guid||(o.guid=t.guid++),(_=wt.events)||(_=wt.events=Object.create(null)),(I=wt.handle)||(I=wt.handle=function(Vt){return typeof t<"u"&&t.event.triggered!==Vt.type?t.event.dispatch.apply(e,arguments):void 0}),n=(n||"").match(dt)||[""],J=n.length;J--;)q=Rn.exec(n[J])||[],lt=jt=q[1],Et=(q[2]||"").split(".").sort(),lt&&(it=t.event.special[lt]||{},lt=(v?it.delegateType:it.bindType)||lt,it=t.event.special[lt]||{},nt=t.extend({type:lt,origType:jt,data:f,handler:o,guid:o.guid,selector:v,needsContext:v&&t.expr.match.needsContext.test(v),namespace:Et.join(".")},m),(Z=_[lt])||(Z=_[lt]=[],Z.delegateCount=0,(!it.setup||it.setup.call(e,f,Et,I)===!1)&&e.addEventListener&&e.addEventListener(lt,I)),it.add&&(it.add.call(e,nt),nt.handler.guid||(nt.handler.guid=o.guid)),v?Z.splice(Z.delegateCount++,0,nt):Z.push(nt),t.event.global[lt]=!0)},remove:function(e,n,o,f,v){var m,I,q,_,J,nt,it,Z,lt,Et,jt,wt=Ct.hasData(e)&&Ct.get(e);if(!(!wt||!(_=wt.events))){for(n=(n||"").match(dt)||[""],J=n.length;J--;){if(q=Rn.exec(n[J])||[],lt=jt=q[1],Et=(q[2]||"").split(".").sort(),!lt){for(lt in _)t.event.remove(e,lt+n[J],o,f,!0);continue}for(it=t.event.special[lt]||{},lt=(f?it.delegateType:it.bindType)||lt,Z=_[lt]||[],q=q[2]&&new RegExp("(^|\\.)"+Et.join("\\.(?:.*\\.|)")+"(\\.|$)"),I=m=Z.length;m--;)nt=Z[m],(v||jt===nt.origType)&&(!o||o.guid===nt.guid)&&(!q||q.test(nt.namespace))&&(!f||f===nt.selector||f==="**"&&nt.selector)&&(Z.splice(m,1),nt.selector&&Z.delegateCount--,it.remove&&it.remove.call(e,nt));I&&!Z.length&&((!it.teardown||it.teardown.call(e,Et,wt.handle)===!1)&&t.removeEvent(e,lt,wt.handle),delete _[lt])}t.isEmptyObject(_)&&Ct.remove(e,"handle events")}},dispatch:function(e){var n,o,f,v,m,I,q=new Array(arguments.length),_=t.event.fix(e),J=(Ct.get(this,"events")||Object.create(null))[_.type]||[],nt=t.event.special[_.type]||{};for(q[0]=_,n=1;n<arguments.length;n++)q[n]=arguments[n];if(_.delegateTarget=this,!(nt.preDispatch&&nt.preDispatch.call(this,_)===!1)){for(I=t.event.handlers.call(this,_,J),n=0;(v=I[n++])&&!_.isPropagationStopped();)for(_.currentTarget=v.elem,o=0;(m=v.handlers[o++])&&!_.isImmediatePropagationStopped();)(!_.rnamespace||m.namespace===!1||_.rnamespace.test(m.namespace))&&(_.handleObj=m,_.data=m.data,f=((t.event.special[m.origType]||{}).handle||m.handler).apply(v.elem,q),f!==void 0&&(_.result=f)===!1&&(_.preventDefault(),_.stopPropagation()));return nt.postDispatch&&nt.postDispatch.call(this,_),_.result}},handlers:function(e,n){var o,f,v,m,I,q=[],_=n.delegateCount,J=e.target;if(_&&J.nodeType&&!(e.type==="click"&&e.button>=1)){for(;J!==this;J=J.parentNode||this)if(J.nodeType===1&&!(e.type==="click"&&J.disabled===!0)){for(m=[],I={},o=0;o<_;o++)f=n[o],v=f.selector+" ",I[v]===void 0&&(I[v]=f.needsContext?t(v,this).index(J)>-1:t.find(v,this,null,[J]).length),I[v]&&m.push(f);m.length&&q.push({elem:J,handlers:m})}}return J=this,_<n.length&&q.push({elem:J,handlers:n.slice(_)}),q},addProp:function(e,n){Object.defineProperty(t.Event.prototype,e,{enumerable:!0,configurable:!0,get:h(n)?function(){if(this.originalEvent)return n(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(o){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:o})}})},fix:function(e){return e[t.expando]?e:new t.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var n=this||e;return De.test(n.type)&&n.click&&l(n,"input")&&Fe(n,"click",!0),!1},trigger:function(e){var n=this||e;return De.test(n.type)&&n.click&&l(n,"input")&&Fe(n,"click"),!0},_default:function(e){var n=e.target;return De.test(n.type)&&n.click&&l(n,"input")&&Ct.get(n,"click")||l(n,"a")}},beforeunload:{postDispatch:function(e){e.result!==void 0&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}};function Fe(e,n,o){if(!o){Ct.get(e,n)===void 0&&t.event.add(e,n,Ee);return}Ct.set(e,n,!1),t.event.add(e,n,{namespace:!1,handler:function(f){var v,m=Ct.get(this,n);if(f.isTrigger&1&&this[n]){if(m)(t.event.special[n]||{}).delegateType&&f.stopPropagation();else if(m=T.call(arguments),Ct.set(this,n,m),this[n](),v=Ct.get(this,n),Ct.set(this,n,!1),m!==v)return f.stopImmediatePropagation(),f.preventDefault(),v}else m&&(Ct.set(this,n,t.event.trigger(m[0],m.slice(1),this)),f.stopPropagation(),f.isImmediatePropagationStopped=Ee)}})}t.removeEvent=function(e,n,o){e.removeEventListener&&e.removeEventListener(n,o)},t.Event=function(e,n){if(!(this instanceof t.Event))return new t.Event(e,n);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===void 0&&e.returnValue===!1?Ee:xe,this.target=e.target&&e.target.nodeType===3?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,n&&t.extend(this,n),this.timeStamp=e&&e.timeStamp||Date.now(),this[t.expando]=!0},t.Event.prototype={constructor:t.Event,isDefaultPrevented:xe,isPropagationStopped:xe,isImmediatePropagationStopped:xe,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ee,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ee,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ee,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},t.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},t.event.addProp),t.each({focus:"focusin",blur:"focusout"},function(e,n){function o(f){if(O.documentMode){var v=Ct.get(this,"handle"),m=t.event.fix(f);m.type=f.type==="focusin"?"focus":"blur",m.isSimulated=!0,v(f),m.target===m.currentTarget&&v(m)}else t.event.simulate(n,f.target,t.event.fix(f))}t.event.special[e]={setup:function(){var f;if(Fe(this,e,!0),O.documentMode)f=Ct.get(this,n),f||this.addEventListener(n,o),Ct.set(this,n,(f||0)+1);else return!1},trigger:function(){return Fe(this,e),!0},teardown:function(){var f;if(O.documentMode)f=Ct.get(this,n)-1,f?Ct.set(this,n,f):(this.removeEventListener(n,o),Ct.remove(this,n));else return!1},_default:function(f){return Ct.get(f.target,e)},delegateType:n},t.event.special[n]={setup:function(){var f=this.ownerDocument||this.document||this,v=O.documentMode?this:f,m=Ct.get(v,n);m||(O.documentMode?this.addEventListener(n,o):f.addEventListener(e,o,!0)),Ct.set(v,n,(m||0)+1)},teardown:function(){var f=this.ownerDocument||this.document||this,v=O.documentMode?this:f,m=Ct.get(v,n)-1;m?Ct.set(v,n,m):(O.documentMode?this.removeEventListener(n,o):f.removeEventListener(e,o,!0),Ct.remove(v,n))}}}),t.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,n){t.event.special[e]={delegateType:n,bindType:n,handle:function(o){var f,v=this,m=o.relatedTarget,I=o.handleObj;return(!m||m!==v&&!t.contains(v,m))&&(o.type=I.origType,f=I.handler.apply(this,arguments),o.type=n),f}}}),t.fn.extend({on:function(e,n,o,f){return $e(this,e,n,o,f)},one:function(e,n,o,f){return $e(this,e,n,o,f,1)},off:function(e,n,o){var f,v;if(e&&e.preventDefault&&e.handleObj)return f=e.handleObj,t(e.delegateTarget).off(f.namespace?f.origType+"."+f.namespace:f.origType,f.selector,f.handler),this;if(typeof e=="object"){for(v in e)this.off(v,n,e[v]);return this}return(n===!1||typeof n=="function")&&(o=n,n=void 0),o===!1&&(o=xe),this.each(function(){t.event.remove(this,e,o,n)})}});var or=/<script|<style|<link/i,ar=/checked\s*(?:[^=]|=\s*.checked.)/i,sr=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function bn(e,n){return l(e,"table")&&l(n.nodeType!==11?n:n.firstChild,"tr")&&t(e).children("tbody")[0]||e}function ur(e){return e.type=(e.getAttribute("type")!==null)+"/"+e.type,e}function fr(e){return(e.type||"").slice(0,5)==="true/"?e.type=e.type.slice(5):e.removeAttribute("type"),e}function En(e,n){var o,f,v,m,I,q,_;if(n.nodeType===1){if(Ct.hasData(e)&&(m=Ct.get(e),_=m.events,_)){Ct.remove(n,"handle events");for(v in _)for(o=0,f=_[v].length;o<f;o++)t.event.add(n,v,_[v][o])}qt.hasData(e)&&(I=qt.access(e),q=t.extend({},I),qt.set(n,q))}}function lr(e,n){var o=n.nodeName.toLowerCase();o==="input"&&De.test(e.type)?n.checked=e.checked:(o==="input"||o==="textarea")&&(n.defaultValue=e.defaultValue)}function Me(e,n,o,f){n=c(n);var v,m,I,q,_,J,nt=0,it=e.length,Z=it-1,lt=n[0],Et=h(lt);if(Et||it>1&&typeof lt=="string"&&!u.checkClone&&ar.test(lt))return e.each(function(jt){var wt=e.eq(jt);Et&&(n[0]=lt.call(this,jt,wt.html())),Me(wt,n,o,f)});if(it&&(v=An(n,e[0].ownerDocument,!1,e,f),m=v.firstChild,v.childNodes.length===1&&(v=m),m||f)){for(I=t.map(Xt(v,"script"),ur),q=I.length;nt<it;nt++)_=v,nt!==Z&&(_=t.clone(_,!0,!0),q&&t.merge(I,Xt(_,"script"))),o.call(e[nt],_,nt);if(q)for(J=I[I.length-1].ownerDocument,t.map(I,fr),nt=0;nt<q;nt++)_=I[nt],Tn.test(_.type||"")&&!Ct.access(_,"globalEval")&&t.contains(J,_)&&(_.src&&(_.type||"").toLowerCase()!=="module"?t._evalUrl&&!_.noModule&&t._evalUrl(_.src,{nonce:_.nonce||_.getAttribute("nonce")},J):p(_.textContent.replace(sr,""),_,J))}return e}function xn(e,n,o){for(var f,v=n?t.filter(n,e):e,m=0;(f=v[m])!=null;m++)!o&&f.nodeType===1&&t.cleanData(Xt(f)),f.parentNode&&(o&&Re(f)&&Xe(Xt(f,"script")),f.parentNode.removeChild(f));return e}t.extend({htmlPrefilter:function(e){return e},clone:function(e,n,o){var f,v,m,I,q=e.cloneNode(!0),_=Re(e);if(!u.noCloneChecked&&(e.nodeType===1||e.nodeType===11)&&!t.isXMLDoc(e))for(I=Xt(q),m=Xt(e),f=0,v=m.length;f<v;f++)lr(m[f],I[f]);if(n)if(o)for(m=m||Xt(e),I=I||Xt(q),f=0,v=m.length;f<v;f++)En(m[f],I[f]);else En(e,q);return I=Xt(q,"script"),I.length>0&&Xe(I,!_&&Xt(e,"script")),q},cleanData:function(e){for(var n,o,f,v=t.event.special,m=0;(o=e[m])!==void 0;m++)if(de(o)){if(n=o[Ct.expando]){if(n.events)for(f in n.events)v[f]?t.event.remove(o,f):t.removeEvent(o,f,n.handle);o[Ct.expando]=void 0}o[qt.expando]&&(o[qt.expando]=void 0)}}}),t.fn.extend({detach:function(e){return xn(this,e,!0)},remove:function(e){return xn(this,e)},text:function(e){return Nt(this,function(n){return n===void 0?t.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=n)})},null,e,arguments.length)},append:function(){return Me(this,arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var n=bn(this,e);n.appendChild(e)}})},prepend:function(){return Me(this,arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var n=bn(this,e);n.insertBefore(e,n.firstChild)}})},before:function(){return Me(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return Me(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,n=0;(e=this[n])!=null;n++)e.nodeType===1&&(t.cleanData(Xt(e,!1)),e.textContent="");return this},clone:function(e,n){return e=e??!1,n=n??e,this.map(function(){return t.clone(this,e,n)})},html:function(e){return Nt(this,function(n){var o=this[0]||{},f=0,v=this.length;if(n===void 0&&o.nodeType===1)return o.innerHTML;if(typeof n=="string"&&!or.test(n)&&!ne[(Sn.exec(n)||["",""])[1].toLowerCase()]){n=t.htmlPrefilter(n);try{for(;f<v;f++)o=this[f]||{},o.nodeType===1&&(t.cleanData(Xt(o,!1)),o.innerHTML=n);o=0}catch{}}o&&this.empty().append(n)},null,e,arguments.length)},replaceWith:function(){var e=[];return Me(this,arguments,function(n){var o=this.parentNode;t.inArray(this,e)<0&&(t.cleanData(Xt(this)),o&&o.replaceChild(n,this))},e)}}),t.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,n){t.fn[e]=function(o){for(var f,v=[],m=t(o),I=m.length-1,q=0;q<=I;q++)f=q===I?this:this.clone(!0),t(m[q])[n](f),G.apply(v,f.get());return this.pushStack(v)}});var Ye=new RegExp("^("+yt+")(?!px)[a-z%]+$","i"),Ze=/^--/,We=function(e){var n=e.ownerDocument.defaultView;return(!n||!n.opener)&&(n=bt),n.getComputedStyle(e)},Mn=function(e,n,o){var f,v,m={};for(v in n)m[v]=e.style[v],e.style[v]=n[v];f=o.call(e);for(v in n)e.style[v]=m[v];return f},cr=new RegExp(kt.join("|"),"i");(function(){function e(){if(J){_.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",J.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ee.appendChild(_).appendChild(J);var nt=bt.getComputedStyle(J);o=nt.top!=="1%",q=n(nt.marginLeft)===12,J.style.right="60%",m=n(nt.right)===36,f=n(nt.width)===36,J.style.position="absolute",v=n(J.offsetWidth/3)===12,ee.removeChild(_),J=null}}function n(nt){return Math.round(parseFloat(nt))}var o,f,v,m,I,q,_=O.createElement("div"),J=O.createElement("div");J.style&&(J.style.backgroundClip="content-box",J.cloneNode(!0).style.backgroundClip="",u.clearCloneStyle=J.style.backgroundClip==="content-box",t.extend(u,{boxSizingReliable:function(){return e(),f},pixelBoxStyles:function(){return e(),m},pixelPosition:function(){return e(),o},reliableMarginLeft:function(){return e(),q},scrollboxSize:function(){return e(),v},reliableTrDimensions:function(){var nt,it,Z,lt;return I==null&&(nt=O.createElement("table"),it=O.createElement("tr"),Z=O.createElement("div"),nt.style.cssText="position:absolute;left:-11111px;border-collapse:separate",it.style.cssText="box-sizing:content-box;border:1px solid",it.style.height="1px",Z.style.height="9px",Z.style.display="block",ee.appendChild(nt).appendChild(it).appendChild(Z),lt=bt.getComputedStyle(it),I=parseInt(lt.height,10)+parseInt(lt.borderTopWidth,10)+parseInt(lt.borderBottomWidth,10)===it.offsetHeight,ee.removeChild(nt)),I}}))})();function Le(e,n,o){var f,v,m,I,q=Ze.test(n),_=e.style;return o=o||We(e),o&&(I=o.getPropertyValue(n)||o[n],q&&I&&(I=I.replace(L,"$1")||void 0),I===""&&!Re(e)&&(I=t.style(e,n)),!u.pixelBoxStyles()&&Ye.test(I)&&cr.test(n)&&(f=_.width,v=_.minWidth,m=_.maxWidth,_.minWidth=_.maxWidth=_.width=I,I=o.width,_.width=f,_.minWidth=v,_.maxWidth=m)),I!==void 0?I+"":I}function In(e,n){return{get:function(){if(e()){delete this.get;return}return(this.get=n).apply(this,arguments)}}}var wn=["Webkit","Moz","ms"],Pn=O.createElement("div").style,Dn={};function dr(e){for(var n=e[0].toUpperCase()+e.slice(1),o=wn.length;o--;)if(e=wn[o]+n,e in Pn)return e}function tn(e){var n=t.cssProps[e]||Dn[e];return n||(e in Pn?e:Dn[e]=dr(e)||e)}var hr=/^(none|table(?!-c[ea]).+)/,pr={position:"absolute",visibility:"hidden",display:"block"},Ln={letterSpacing:"0",fontWeight:"400"};function Nn(e,n,o){var f=It.exec(n);return f?Math.max(0,f[2]-(o||0))+(f[3]||"px"):n}function en(e,n,o,f,v,m){var I=n==="width"?1:0,q=0,_=0,J=0;if(o===(f?"border":"content"))return 0;for(;I<4;I+=2)o==="margin"&&(J+=t.css(e,o+kt[I],!0,v)),f?(o==="content"&&(_-=t.css(e,"padding"+kt[I],!0,v)),o!=="margin"&&(_-=t.css(e,"border"+kt[I]+"Width",!0,v))):(_+=t.css(e,"padding"+kt[I],!0,v),o!=="padding"?_+=t.css(e,"border"+kt[I]+"Width",!0,v):q+=t.css(e,"border"+kt[I]+"Width",!0,v));return!f&&m>=0&&(_+=Math.max(0,Math.ceil(e["offset"+n[0].toUpperCase()+n.slice(1)]-m-_-q-.5))||0),_+J}function jn(e,n,o){var f=We(e),v=!u.boxSizingReliable()||o,m=v&&t.css(e,"boxSizing",!1,f)==="border-box",I=m,q=Le(e,n,f),_="offset"+n[0].toUpperCase()+n.slice(1);if(Ye.test(q)){if(!o)return q;q="auto"}return(!u.boxSizingReliable()&&m||!u.reliableTrDimensions()&&l(e,"tr")||q==="auto"||!parseFloat(q)&&t.css(e,"display",!1,f)==="inline")&&e.getClientRects().length&&(m=t.css(e,"boxSizing",!1,f)==="border-box",I=_ in e,I&&(q=e[_])),q=parseFloat(q)||0,q+en(e,n,o||(m?"border":"content"),I,f,q)+"px"}t.extend({cssHooks:{opacity:{get:function(e,n){if(n){var o=Le(e,"opacity");return o===""?"1":o}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,n,o,f){if(!(!e||e.nodeType===3||e.nodeType===8||!e.style)){var v,m,I,q=Qt(n),_=Ze.test(n),J=e.style;if(_||(n=tn(q)),I=t.cssHooks[n]||t.cssHooks[q],o!==void 0){if(m=typeof o,m==="string"&&(v=It.exec(o))&&v[1]&&(o=Cn(e,n,v),m="number"),o==null||o!==o)return;m==="number"&&!_&&(o+=v&&v[3]||(t.cssNumber[q]?"":"px")),!u.clearCloneStyle&&o===""&&n.indexOf("background")===0&&(J[n]="inherit"),(!I||!("set"in I)||(o=I.set(e,o,f))!==void 0)&&(_?J.setProperty(n,o):J[n]=o)}else return I&&"get"in I&&(v=I.get(e,!1,f))!==void 0?v:J[n]}},css:function(e,n,o,f){var v,m,I,q=Qt(n),_=Ze.test(n);return _||(n=tn(q)),I=t.cssHooks[n]||t.cssHooks[q],I&&"get"in I&&(v=I.get(e,!0,o)),v===void 0&&(v=Le(e,n,f)),v==="normal"&&n in Ln&&(v=Ln[n]),o===""||o?(m=parseFloat(v),o===!0||isFinite(m)?m||0:v):v}}),t.each(["height","width"],function(e,n){t.cssHooks[n]={get:function(o,f,v){if(f)return hr.test(t.css(o,"display"))&&(!o.getClientRects().length||!o.getBoundingClientRect().width)?Mn(o,pr,function(){return jn(o,n,v)}):jn(o,n,v)},set:function(o,f,v){var m,I=We(o),q=!u.scrollboxSize()&&I.position==="absolute",_=q||v,J=_&&t.css(o,"boxSizing",!1,I)==="border-box",nt=v?en(o,n,v,J,I):0;return J&&q&&(nt-=Math.ceil(o["offset"+n[0].toUpperCase()+n.slice(1)]-parseFloat(I[n])-en(o,n,"border",!1,I)-.5)),nt&&(m=It.exec(f))&&(m[3]||"px")!=="px"&&(o.style[n]=f,f=t.css(o,n)),Nn(o,f,nt)}}}),t.cssHooks.marginLeft=In(u.reliableMarginLeft,function(e,n){if(n)return(parseFloat(Le(e,"marginLeft"))||e.getBoundingClientRect().left-Mn(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),t.each({margin:"",padding:"",border:"Width"},function(e,n){t.cssHooks[e+n]={expand:function(o){for(var f=0,v={},m=typeof o=="string"?o.split(" "):[o];f<4;f++)v[e+kt[f]+n]=m[f]||m[f-2]||m[0];return v}},e!=="margin"&&(t.cssHooks[e+n].set=Nn)}),t.fn.extend({css:function(e,n){return Nt(this,function(o,f,v){var m,I,q={},_=0;if(Array.isArray(f)){for(m=We(o),I=f.length;_<I;_++)q[f[_]]=t.css(o,f[_],!1,m);return q}return v!==void 0?t.style(o,f,v):t.css(o,f)},e,n,arguments.length>1)}});function $t(e,n,o,f,v){return new $t.prototype.init(e,n,o,f,v)}t.Tween=$t,$t.prototype={constructor:$t,init:function(e,n,o,f,v,m){this.elem=e,this.prop=o,this.easing=v||t.easing._default,this.options=n,this.start=this.now=this.cur(),this.end=f,this.unit=m||(t.cssNumber[o]?"":"px")},cur:function(){var e=$t.propHooks[this.prop];return e&&e.get?e.get(this):$t.propHooks._default.get(this)},run:function(e){var n,o=$t.propHooks[this.prop];return this.options.duration?this.pos=n=t.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=n=e,this.now=(this.end-this.start)*n+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),o&&o.set?o.set(this):$t.propHooks._default.set(this),this}},$t.prototype.init.prototype=$t.prototype,$t.propHooks={_default:{get:function(e){var n;return e.elem.nodeType!==1||e.elem[e.prop]!=null&&e.elem.style[e.prop]==null?e.elem[e.prop]:(n=t.css(e.elem,e.prop,""),!n||n==="auto"?0:n)},set:function(e){t.fx.step[e.prop]?t.fx.step[e.prop](e):e.elem.nodeType===1&&(t.cssHooks[e.prop]||e.elem.style[tn(e.prop)]!=null)?t.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},$t.propHooks.scrollTop=$t.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},t.easing={linear:function(e){return e},swing:function(e){return .5-Math.cos(e*Math.PI)/2},_default:"swing"},t.fx=$t.prototype.init,t.fx.step={};var Ie,_e,gr=/^(?:toggle|show|hide)$/,vr=/queueHooks$/;function nn(){_e&&(O.hidden===!1&&bt.requestAnimationFrame?bt.requestAnimationFrame(nn):bt.setTimeout(nn,t.fx.interval),t.fx.tick())}function Un(){return bt.setTimeout(function(){Ie=void 0}),Ie=Date.now()}function Ve(e,n){var o,f=0,v={height:e};for(n=n?1:0;f<4;f+=2-n)o=kt[f],v["margin"+o]=v["padding"+o]=e;return n&&(v.opacity=v.width=e),v}function Bn(e,n,o){for(var f,v=(oe.tweeners[n]||[]).concat(oe.tweeners["*"]),m=0,I=v.length;m<I;m++)if(f=v[m].call(o,n,e))return f}function yr(e,n,o){var f,v,m,I,q,_,J,nt,it="width"in n||"height"in n,Z=this,lt={},Et=e.style,jt=e.nodeType&&ke(e),wt=Ct.get(e,"fxshow");o.queue||(I=t._queueHooks(e,"fx"),I.unqueued==null&&(I.unqueued=0,q=I.empty.fire,I.empty.fire=function(){I.unqueued||q()}),I.unqueued++,Z.always(function(){Z.always(function(){I.unqueued--,t.queue(e,"fx").length||I.empty.fire()})}));for(f in n)if(v=n[f],gr.test(v)){if(delete n[f],m=m||v==="toggle",v===(jt?"hide":"show"))if(v==="show"&&wt&&wt[f]!==void 0)jt=!0;else continue;lt[f]=wt&&wt[f]||t.style(e,f)}if(_=!t.isEmptyObject(n),!(!_&&t.isEmptyObject(lt))){it&&e.nodeType===1&&(o.overflow=[Et.overflow,Et.overflowX,Et.overflowY],J=wt&&wt.display,J==null&&(J=Ct.get(e,"display")),nt=t.css(e,"display"),nt==="none"&&(J?nt=J:(be([e],!0),J=e.style.display||J,nt=t.css(e,"display"),be([e]))),(nt==="inline"||nt==="inline-block"&&J!=null)&&t.css(e,"float")==="none"&&(_||(Z.done(function(){Et.display=J}),J==null&&(nt=Et.display,J=nt==="none"?"":nt)),Et.display="inline-block")),o.overflow&&(Et.overflow="hidden",Z.always(function(){Et.overflow=o.overflow[0],Et.overflowX=o.overflow[1],Et.overflowY=o.overflow[2]})),_=!1;for(f in lt)_||(wt?"hidden"in wt&&(jt=wt.hidden):wt=Ct.access(e,"fxshow",{display:J}),m&&(wt.hidden=!jt),jt&&be([e],!0),Z.done(function(){jt||be([e]),Ct.remove(e,"fxshow");for(f in lt)t.style(e,f,lt[f])})),_=Bn(jt?wt[f]:0,f,Z),f in wt||(wt[f]=_.start,jt&&(_.end=_.start,_.start=0))}}function mr(e,n){var o,f,v,m,I;for(o in e)if(f=Qt(o),v=n[f],m=e[o],Array.isArray(m)&&(v=m[1],m=e[o]=m[0]),o!==f&&(e[f]=m,delete e[o]),I=t.cssHooks[f],I&&"expand"in I){m=I.expand(m),delete e[f];for(o in m)o in e||(e[o]=m[o],n[o]=v)}else n[f]=v}function oe(e,n,o){var f,v,m=0,I=oe.prefilters.length,q=t.Deferred().always(function(){delete _.elem}),_=function(){if(v)return!1;for(var it=Ie||Un(),Z=Math.max(0,J.startTime+J.duration-it),lt=Z/J.duration||0,Et=1-lt,jt=0,wt=J.tweens.length;jt<wt;jt++)J.tweens[jt].run(Et);return q.notifyWith(e,[J,Et,Z]),Et<1&&wt?Z:(wt||q.notifyWith(e,[J,1,0]),q.resolveWith(e,[J]),!1)},J=q.promise({elem:e,props:t.extend({},n),opts:t.extend(!0,{specialEasing:{},easing:t.easing._default},o),originalProperties:n,originalOptions:o,startTime:Ie||Un(),duration:o.duration,tweens:[],createTween:function(it,Z){var lt=t.Tween(e,J.opts,it,Z,J.opts.specialEasing[it]||J.opts.easing);return J.tweens.push(lt),lt},stop:function(it){var Z=0,lt=it?J.tweens.length:0;if(v)return this;for(v=!0;Z<lt;Z++)J.tweens[Z].run(1);return it?(q.notifyWith(e,[J,1,0]),q.resolveWith(e,[J,it])):q.rejectWith(e,[J,it]),this}}),nt=J.props;for(mr(nt,J.opts.specialEasing);m<I;m++)if(f=oe.prefilters[m].call(J,e,nt,J.opts),f)return h(f.stop)&&(t._queueHooks(J.elem,J.opts.queue).stop=f.stop.bind(f)),f;return t.map(nt,Bn,J),h(J.opts.start)&&J.opts.start.call(e,J),J.progress(J.opts.progress).done(J.opts.done,J.opts.complete).fail(J.opts.fail).always(J.opts.always),t.fx.timer(t.extend(_,{elem:e,anim:J,queue:J.opts.queue})),J}t.Animation=t.extend(oe,{tweeners:{"*":[function(e,n){var o=this.createTween(e,n);return Cn(o.elem,e,It.exec(n),o),o}]},tweener:function(e,n){h(e)?(n=e,e=["*"]):e=e.match(dt);for(var o,f=0,v=e.length;f<v;f++)o=e[f],oe.tweeners[o]=oe.tweeners[o]||[],oe.tweeners[o].unshift(n)},prefilters:[yr],prefilter:function(e,n){n?oe.prefilters.unshift(e):oe.prefilters.push(e)}}),t.speed=function(e,n,o){var f=e&&typeof e=="object"?t.extend({},e):{complete:o||!o&&n||h(e)&&e,duration:e,easing:o&&n||n&&!h(n)&&n};return t.fx.off?f.duration=0:typeof f.duration!="number"&&(f.duration in t.fx.speeds?f.duration=t.fx.speeds[f.duration]:f.duration=t.fx.speeds._default),(f.queue==null||f.queue===!0)&&(f.queue="fx"),f.old=f.complete,f.complete=function(){h(f.old)&&f.old.call(this),f.queue&&t.dequeue(this,f.queue)},f},t.fn.extend({fadeTo:function(e,n,o,f){return this.filter(ke).css("opacity",0).show().end().animate({opacity:n},e,o,f)},animate:function(e,n,o,f){var v=t.isEmptyObject(e),m=t.speed(n,o,f),I=function(){var q=oe(this,t.extend({},e),m);(v||Ct.get(this,"finish"))&&q.stop(!0)};return I.finish=I,v||m.queue===!1?this.each(I):this.queue(m.queue,I)},stop:function(e,n,o){var f=function(v){var m=v.stop;delete v.stop,m(o)};return typeof e!="string"&&(o=n,n=e,e=void 0),n&&this.queue(e||"fx",[]),this.each(function(){var v=!0,m=e!=null&&e+"queueHooks",I=t.timers,q=Ct.get(this);if(m)q[m]&&q[m].stop&&f(q[m]);else for(m in q)q[m]&&q[m].stop&&vr.test(m)&&f(q[m]);for(m=I.length;m--;)I[m].elem===this&&(e==null||I[m].queue===e)&&(I[m].anim.stop(o),v=!1,I.splice(m,1));(v||!o)&&t.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var n,o=Ct.get(this),f=o[e+"queue"],v=o[e+"queueHooks"],m=t.timers,I=f?f.length:0;for(o.finish=!0,t.queue(this,e,[]),v&&v.stop&&v.stop.call(this,!0),n=m.length;n--;)m[n].elem===this&&m[n].queue===e&&(m[n].anim.stop(!0),m.splice(n,1));for(n=0;n<I;n++)f[n]&&f[n].finish&&f[n].finish.call(this);delete o.finish})}}),t.each(["toggle","show","hide"],function(e,n){var o=t.fn[n];t.fn[n]=function(f,v,m){return f==null||typeof f=="boolean"?o.apply(this,arguments):this.animate(Ve(n,!0),f,v,m)}}),t.each({slideDown:Ve("show"),slideUp:Ve("hide"),slideToggle:Ve("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,n){t.fn[e]=function(o,f,v){return this.animate(n,o,f,v)}}),t.timers=[],t.fx.tick=function(){var e,n=0,o=t.timers;for(Ie=Date.now();n<o.length;n++)e=o[n],!e()&&o[n]===e&&o.splice(n--,1);o.length||t.fx.stop(),Ie=void 0},t.fx.timer=function(e){t.timers.push(e),t.fx.start()},t.fx.interval=13,t.fx.start=function(){_e||(_e=!0,nn())},t.fx.stop=function(){_e=null},t.fx.speeds={slow:600,fast:200,_default:400},t.fn.delay=function(e,n){return e=t.fx&&t.fx.speeds[e]||e,n=n||"fx",this.queue(n,function(o,f){var v=bt.setTimeout(o,e);f.stop=function(){bt.clearTimeout(v)}})},function(){var e=O.createElement("input"),n=O.createElement("select"),o=n.appendChild(O.createElement("option"));e.type="checkbox",u.checkOn=e.value!=="",u.optSelected=o.selected,e=O.createElement("input"),e.value="t",e.type="radio",u.radioValue=e.value==="t"}();var Hn,Ne=t.expr.attrHandle;t.fn.extend({attr:function(e,n){return Nt(this,t.attr,e,n,arguments.length>1)},removeAttr:function(e){return this.each(function(){t.removeAttr(this,e)})}}),t.extend({attr:function(e,n,o){var f,v,m=e.nodeType;if(!(m===3||m===8||m===2)){if(typeof e.getAttribute>"u")return t.prop(e,n,o);if((m!==1||!t.isXMLDoc(e))&&(v=t.attrHooks[n.toLowerCase()]||(t.expr.match.bool.test(n)?Hn:void 0)),o!==void 0){if(o===null){t.removeAttr(e,n);return}return v&&"set"in v&&(f=v.set(e,o,n))!==void 0?f:(e.setAttribute(n,o+""),o)}return v&&"get"in v&&(f=v.get(e,n))!==null?f:(f=t.find.attr(e,n),f??void 0)}},attrHooks:{type:{set:function(e,n){if(!u.radioValue&&n==="radio"&&l(e,"input")){var o=e.value;return e.setAttribute("type",n),o&&(e.value=o),n}}}},removeAttr:function(e,n){var o,f=0,v=n&&n.match(dt);if(v&&e.nodeType===1)for(;o=v[f++];)e.removeAttribute(o)}}),Hn={set:function(e,n,o){return n===!1?t.removeAttr(e,o):e.setAttribute(o,o),o}},t.each(t.expr.match.bool.source.match(/\w+/g),function(e,n){var o=Ne[n]||t.find.attr;Ne[n]=function(f,v,m){var I,q,_=v.toLowerCase();return m||(q=Ne[_],Ne[_]=I,I=o(f,v,m)!=null?_:null,Ne[_]=q),I}});var Cr=/^(?:input|select|textarea|button)$/i,Or=/^(?:a|area)$/i;t.fn.extend({prop:function(e,n){return Nt(this,t.prop,e,n,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[t.propFix[e]||e]})}}),t.extend({prop:function(e,n,o){var f,v,m=e.nodeType;if(!(m===3||m===8||m===2))return(m!==1||!t.isXMLDoc(e))&&(n=t.propFix[n]||n,v=t.propHooks[n]),o!==void 0?v&&"set"in v&&(f=v.set(e,o,n))!==void 0?f:e[n]=o:v&&"get"in v&&(f=v.get(e,n))!==null?f:e[n]},propHooks:{tabIndex:{get:function(e){var n=t.find.attr(e,"tabindex");return n?parseInt(n,10):Cr.test(e.nodeName)||Or.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),u.optSelected||(t.propHooks.selected={get:function(e){var n=e.parentNode;return n&&n.parentNode&&n.parentNode.selectedIndex,null},set:function(e){var n=e.parentNode;n&&(n.selectedIndex,n.parentNode&&n.parentNode.selectedIndex)}}),t.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){t.propFix[this.toLowerCase()]=this});function Oe(e){var n=e.match(dt)||[];return n.join(" ")}function Se(e){return e.getAttribute&&e.getAttribute("class")||""}function rn(e){return Array.isArray(e)?e:typeof e=="string"?e.match(dt)||[]:[]}t.fn.extend({addClass:function(e){var n,o,f,v,m,I;return h(e)?this.each(function(q){t(this).addClass(e.call(this,q,Se(this)))}):(n=rn(e),n.length?this.each(function(){if(f=Se(this),o=this.nodeType===1&&" "+Oe(f)+" ",o){for(m=0;m<n.length;m++)v=n[m],o.indexOf(" "+v+" ")<0&&(o+=v+" ");I=Oe(o),f!==I&&this.setAttribute("class",I)}}):this)},removeClass:function(e){var n,o,f,v,m,I;return h(e)?this.each(function(q){t(this).removeClass(e.call(this,q,Se(this)))}):arguments.length?(n=rn(e),n.length?this.each(function(){if(f=Se(this),o=this.nodeType===1&&" "+Oe(f)+" ",o){for(m=0;m<n.length;m++)for(v=n[m];o.indexOf(" "+v+" ")>-1;)o=o.replace(" "+v+" "," ");I=Oe(o),f!==I&&this.setAttribute("class",I)}}):this):this.attr("class","")},toggleClass:function(e,n){var o,f,v,m,I=typeof e,q=I==="string"||Array.isArray(e);return h(e)?this.each(function(_){t(this).toggleClass(e.call(this,_,Se(this),n),n)}):typeof n=="boolean"&&q?n?this.addClass(e):this.removeClass(e):(o=rn(e),this.each(function(){if(q)for(m=t(this),v=0;v<o.length;v++)f=o[v],m.hasClass(f)?m.removeClass(f):m.addClass(f);else(e===void 0||I==="boolean")&&(f=Se(this),f&&Ct.set(this,"__className__",f),this.setAttribute&&this.setAttribute("class",f||e===!1?"":Ct.get(this,"__className__")||""))}))},hasClass:function(e){var n,o,f=0;for(n=" "+e+" ";o=this[f++];)if(o.nodeType===1&&(" "+Oe(Se(o))+" ").indexOf(n)>-1)return!0;return!1}});var Sr=/\r/g;t.fn.extend({val:function(e){var n,o,f,v=this[0];return arguments.length?(f=h(e),this.each(function(m){var I;this.nodeType===1&&(f?I=e.call(this,m,t(this).val()):I=e,I==null?I="":typeof I=="number"?I+="":Array.isArray(I)&&(I=t.map(I,function(q){return q==null?"":q+""})),n=t.valHooks[this.type]||t.valHooks[this.nodeName.toLowerCase()],(!n||!("set"in n)||n.set(this,I,"value")===void 0)&&(this.value=I))})):v?(n=t.valHooks[v.type]||t.valHooks[v.nodeName.toLowerCase()],n&&"get"in n&&(o=n.get(v,"value"))!==void 0?o:(o=v.value,typeof o=="string"?o.replace(Sr,""):o??"")):void 0}}),t.extend({valHooks:{option:{get:function(e){var n=t.find.attr(e,"value");return n??Oe(t.text(e))}},select:{get:function(e){var n,o,f,v=e.options,m=e.selectedIndex,I=e.type==="select-one",q=I?null:[],_=I?m+1:v.length;for(m<0?f=_:f=I?m:0;f<_;f++)if(o=v[f],(o.selected||f===m)&&!o.disabled&&(!o.parentNode.disabled||!l(o.parentNode,"optgroup"))){if(n=t(o).val(),I)return n;q.push(n)}return q},set:function(e,n){for(var o,f,v=e.options,m=t.makeArray(n),I=v.length;I--;)f=v[I],(f.selected=t.inArray(t.valHooks.option.get(f),m)>-1)&&(o=!0);return o||(e.selectedIndex=-1),m}}}}),t.each(["radio","checkbox"],function(){t.valHooks[this]={set:function(e,n){if(Array.isArray(n))return e.checked=t.inArray(t(e).val(),n)>-1}},u.checkOn||(t.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value})});var je=bt.location,Gn={guid:Date.now()},on=/\?/;t.parseXML=function(e){var n,o;if(!e||typeof e!="string")return null;try{n=new bt.DOMParser().parseFromString(e,"text/xml")}catch{}return o=n&&n.getElementsByTagName("parsererror")[0],(!n||o)&&t.error("Invalid XML: "+(o?t.map(o.childNodes,function(f){return f.textContent}).join(`
`):e)),n};var kn=/^(?:focusinfocus|focusoutblur)$/,Fn=function(e){e.stopPropagation()};t.extend(t.event,{trigger:function(e,n,o,f){var v,m,I,q,_,J,nt,it,Z=[o||O],lt=j.call(e,"type")?e.type:e,Et=j.call(e,"namespace")?e.namespace.split("."):[];if(m=it=I=o=o||O,!(o.nodeType===3||o.nodeType===8)&&!kn.test(lt+t.event.triggered)&&(lt.indexOf(".")>-1&&(Et=lt.split("."),lt=Et.shift(),Et.sort()),_=lt.indexOf(":")<0&&"on"+lt,e=e[t.expando]?e:new t.Event(lt,typeof e=="object"&&e),e.isTrigger=f?2:3,e.namespace=Et.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+Et.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=o),n=n==null?[e]:t.makeArray(n,[e]),nt=t.event.special[lt]||{},!(!f&&nt.trigger&&nt.trigger.apply(o,n)===!1))){if(!f&&!nt.noBubble&&!P(o)){for(q=nt.delegateType||lt,kn.test(q+lt)||(m=m.parentNode);m;m=m.parentNode)Z.push(m),I=m;I===(o.ownerDocument||O)&&Z.push(I.defaultView||I.parentWindow||bt)}for(v=0;(m=Z[v++])&&!e.isPropagationStopped();)it=m,e.type=v>1?q:nt.bindType||lt,J=(Ct.get(m,"events")||Object.create(null))[e.type]&&Ct.get(m,"handle"),J&&J.apply(m,n),J=_&&m[_],J&&J.apply&&de(m)&&(e.result=J.apply(m,n),e.result===!1&&e.preventDefault());return e.type=lt,!f&&!e.isDefaultPrevented()&&(!nt._default||nt._default.apply(Z.pop(),n)===!1)&&de(o)&&_&&h(o[lt])&&!P(o)&&(I=o[_],I&&(o[_]=null),t.event.triggered=lt,e.isPropagationStopped()&&it.addEventListener(lt,Fn),o[lt](),e.isPropagationStopped()&&it.removeEventListener(lt,Fn),t.event.triggered=void 0,I&&(o[_]=I)),e.result}},simulate:function(e,n,o){var f=t.extend(new t.Event,o,{type:e,isSimulated:!0});t.event.trigger(f,null,n)}}),t.fn.extend({trigger:function(e,n){return this.each(function(){t.event.trigger(e,n,this)})},triggerHandler:function(e,n){var o=this[0];if(o)return t.event.trigger(e,n,o,!0)}});var Tr=/\[\]$/,Wn=/\r?\n/g,Ar=/^(?:submit|button|image|reset|file)$/i,Rr=/^(?:input|select|textarea|keygen)/i;function an(e,n,o,f){var v;if(Array.isArray(n))t.each(n,function(m,I){o||Tr.test(e)?f(e,I):an(e+"["+(typeof I=="object"&&I!=null?m:"")+"]",I,o,f)});else if(!o&&C(n)==="object")for(v in n)an(e+"["+v+"]",n[v],o,f);else f(e,n)}t.param=function(e,n){var o,f=[],v=function(m,I){var q=h(I)?I():I;f[f.length]=encodeURIComponent(m)+"="+encodeURIComponent(q??"")};if(e==null)return"";if(Array.isArray(e)||e.jquery&&!t.isPlainObject(e))t.each(e,function(){v(this.name,this.value)});else for(o in e)an(o,e[o],n,v);return f.join("&")},t.fn.extend({serialize:function(){return t.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=t.prop(this,"elements");return e?t.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!t(this).is(":disabled")&&Rr.test(this.nodeName)&&!Ar.test(e)&&(this.checked||!De.test(e))}).map(function(e,n){var o=t(this).val();return o==null?null:Array.isArray(o)?t.map(o,function(f){return{name:n.name,value:f.replace(Wn,`\r
`)}}):{name:n.name,value:o.replace(Wn,`\r
`)}}).get()}});var br=/%20/g,Er=/#.*$/,xr=/([?&])_=[^&]*/,Mr=/^(.*?):[ \t]*([^\r\n]*)$/mg,Ir=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,wr=/^(?:GET|HEAD)$/,Pr=/^\/\//,_n={},sn={},Vn="*/".concat("*"),un=O.createElement("a");un.href=je.href;function zn(e){return function(n,o){typeof n!="string"&&(o=n,n="*");var f,v=0,m=n.toLowerCase().match(dt)||[];if(h(o))for(;f=m[v++];)f[0]==="+"?(f=f.slice(1)||"*",(e[f]=e[f]||[]).unshift(o)):(e[f]=e[f]||[]).push(o)}}function qn(e,n,o,f){var v={},m=e===sn;function I(q){var _;return v[q]=!0,t.each(e[q]||[],function(J,nt){var it=nt(n,o,f);if(typeof it=="string"&&!m&&!v[it])return n.dataTypes.unshift(it),I(it),!1;if(m)return!(_=it)}),_}return I(n.dataTypes[0])||!v["*"]&&I("*")}function fn(e,n){var o,f,v=t.ajaxSettings.flatOptions||{};for(o in n)n[o]!==void 0&&((v[o]?e:f||(f={}))[o]=n[o]);return f&&t.extend(!0,e,f),e}function Dr(e,n,o){for(var f,v,m,I,q=e.contents,_=e.dataTypes;_[0]==="*";)_.shift(),f===void 0&&(f=e.mimeType||n.getResponseHeader("Content-Type"));if(f){for(v in q)if(q[v]&&q[v].test(f)){_.unshift(v);break}}if(_[0]in o)m=_[0];else{for(v in o){if(!_[0]||e.converters[v+" "+_[0]]){m=v;break}I||(I=v)}m=m||I}if(m)return m!==_[0]&&_.unshift(m),o[m]}function Lr(e,n,o,f){var v,m,I,q,_,J={},nt=e.dataTypes.slice();if(nt[1])for(I in e.converters)J[I.toLowerCase()]=e.converters[I];for(m=nt.shift();m;)if(e.responseFields[m]&&(o[e.responseFields[m]]=n),!_&&f&&e.dataFilter&&(n=e.dataFilter(n,e.dataType)),_=m,m=nt.shift(),m){if(m==="*")m=_;else if(_!=="*"&&_!==m){if(I=J[_+" "+m]||J["* "+m],!I){for(v in J)if(q=v.split(" "),q[1]===m&&(I=J[_+" "+q[0]]||J["* "+q[0]],I)){I===!0?I=J[v]:J[v]!==!0&&(m=q[0],nt.unshift(q[1]));break}}if(I!==!0)if(I&&e.throws)n=I(n);else try{n=I(n)}catch(it){return{state:"parsererror",error:I?it:"No conversion from "+_+" to "+m}}}}return{state:"success",data:n}}t.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:je.href,type:"GET",isLocal:Ir.test(je.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Vn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":t.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,n){return n?fn(fn(e,t.ajaxSettings),n):fn(t.ajaxSettings,e)},ajaxPrefilter:zn(_n),ajaxTransport:zn(sn),ajax:function(e,n){typeof e=="object"&&(n=e,e=void 0),n=n||{};var o,f,v,m,I,q,_,J,nt,it,Z=t.ajaxSetup({},n),lt=Z.context||Z,Et=Z.context&&(lt.nodeType||lt.jquery)?t(lt):t.event,jt=t.Deferred(),wt=t.Callbacks("once memory"),Vt=Z.statusCode||{},_t={},se={},ue="canceled",Lt={readyState:0,getResponseHeader:function(Ut){var Wt;if(_){if(!m)for(m={};Wt=Mr.exec(v);)m[Wt[1].toLowerCase()+" "]=(m[Wt[1].toLowerCase()+" "]||[]).concat(Wt[2]);Wt=m[Ut.toLowerCase()+" "]}return Wt==null?null:Wt.join(", ")},getAllResponseHeaders:function(){return _?v:null},setRequestHeader:function(Ut,Wt){return _==null&&(Ut=se[Ut.toLowerCase()]=se[Ut.toLowerCase()]||Ut,_t[Ut]=Wt),this},overrideMimeType:function(Ut){return _==null&&(Z.mimeType=Ut),this},statusCode:function(Ut){var Wt;if(Ut)if(_)Lt.always(Ut[Lt.status]);else for(Wt in Ut)Vt[Wt]=[Vt[Wt],Ut[Wt]];return this},abort:function(Ut){var Wt=Ut||ue;return o&&o.abort(Wt),Te(0,Wt),this}};if(jt.promise(Lt),Z.url=((e||Z.url||je.href)+"").replace(Pr,je.protocol+"//"),Z.type=n.method||n.type||Z.method||Z.type,Z.dataTypes=(Z.dataType||"*").toLowerCase().match(dt)||[""],Z.crossDomain==null){q=O.createElement("a");try{q.href=Z.url,q.href=q.href,Z.crossDomain=un.protocol+"//"+un.host!=q.protocol+"//"+q.host}catch{Z.crossDomain=!0}}if(Z.data&&Z.processData&&typeof Z.data!="string"&&(Z.data=t.param(Z.data,Z.traditional)),qn(_n,Z,n,Lt),_)return Lt;J=t.event&&Z.global,J&&t.active++===0&&t.event.trigger("ajaxStart"),Z.type=Z.type.toUpperCase(),Z.hasContent=!wr.test(Z.type),f=Z.url.replace(Er,""),Z.hasContent?Z.data&&Z.processData&&(Z.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(Z.data=Z.data.replace(br,"+")):(it=Z.url.slice(f.length),Z.data&&(Z.processData||typeof Z.data=="string")&&(f+=(on.test(f)?"&":"?")+Z.data,delete Z.data),Z.cache===!1&&(f=f.replace(xr,"$1"),it=(on.test(f)?"&":"?")+"_="+Gn.guid+++it),Z.url=f+it),Z.ifModified&&(t.lastModified[f]&&Lt.setRequestHeader("If-Modified-Since",t.lastModified[f]),t.etag[f]&&Lt.setRequestHeader("If-None-Match",t.etag[f])),(Z.data&&Z.hasContent&&Z.contentType!==!1||n.contentType)&&Lt.setRequestHeader("Content-Type",Z.contentType),Lt.setRequestHeader("Accept",Z.dataTypes[0]&&Z.accepts[Z.dataTypes[0]]?Z.accepts[Z.dataTypes[0]]+(Z.dataTypes[0]!=="*"?", "+Vn+"; q=0.01":""):Z.accepts["*"]);for(nt in Z.headers)Lt.setRequestHeader(nt,Z.headers[nt]);if(Z.beforeSend&&(Z.beforeSend.call(lt,Lt,Z)===!1||_))return Lt.abort();if(ue="abort",wt.add(Z.complete),Lt.done(Z.success),Lt.fail(Z.error),o=qn(sn,Z,n,Lt),!o)Te(-1,"No Transport");else{if(Lt.readyState=1,J&&Et.trigger("ajaxSend",[Lt,Z]),_)return Lt;Z.async&&Z.timeout>0&&(I=bt.setTimeout(function(){Lt.abort("timeout")},Z.timeout));try{_=!1,o.send(_t,Te)}catch(Ut){if(_)throw Ut;Te(-1,Ut)}}function Te(Ut,Wt,Be,cn){var fe,He,le,ye,me,re=Wt;_||(_=!0,I&&bt.clearTimeout(I),o=void 0,v=cn||"",Lt.readyState=Ut>0?4:0,fe=Ut>=200&&Ut<300||Ut===304,Be&&(ye=Dr(Z,Lt,Be)),!fe&&t.inArray("script",Z.dataTypes)>-1&&t.inArray("json",Z.dataTypes)<0&&(Z.converters["text script"]=function(){}),ye=Lr(Z,ye,Lt,fe),fe?(Z.ifModified&&(me=Lt.getResponseHeader("Last-Modified"),me&&(t.lastModified[f]=me),me=Lt.getResponseHeader("etag"),me&&(t.etag[f]=me)),Ut===204||Z.type==="HEAD"?re="nocontent":Ut===304?re="notmodified":(re=ye.state,He=ye.data,le=ye.error,fe=!le)):(le=re,(Ut||!re)&&(re="error",Ut<0&&(Ut=0))),Lt.status=Ut,Lt.statusText=(Wt||re)+"",fe?jt.resolveWith(lt,[He,re,Lt]):jt.rejectWith(lt,[Lt,re,le]),Lt.statusCode(Vt),Vt=void 0,J&&Et.trigger(fe?"ajaxSuccess":"ajaxError",[Lt,Z,fe?He:le]),wt.fireWith(lt,[Lt,re]),J&&(Et.trigger("ajaxComplete",[Lt,Z]),--t.active||t.event.trigger("ajaxStop")))}return Lt},getJSON:function(e,n,o){return t.get(e,n,o,"json")},getScript:function(e,n){return t.get(e,void 0,n,"script")}}),t.each(["get","post"],function(e,n){t[n]=function(o,f,v,m){return h(f)&&(m=m||v,v=f,f=void 0),t.ajax(t.extend({url:o,type:n,dataType:m,data:f,success:v},t.isPlainObject(o)&&o))}}),t.ajaxPrefilter(function(e){var n;for(n in e.headers)n.toLowerCase()==="content-type"&&(e.contentType=e.headers[n]||"")}),t._evalUrl=function(e,n,o){return t.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(f){t.globalEval(f,n,o)}})},t.fn.extend({wrapAll:function(e){var n;return this[0]&&(h(e)&&(e=e.call(this[0])),n=t(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&n.insertBefore(this[0]),n.map(function(){for(var o=this;o.firstElementChild;)o=o.firstElementChild;return o}).append(this)),this},wrapInner:function(e){return h(e)?this.each(function(n){t(this).wrapInner(e.call(this,n))}):this.each(function(){var n=t(this),o=n.contents();o.length?o.wrapAll(e):n.append(e)})},wrap:function(e){var n=h(e);return this.each(function(o){t(this).wrapAll(n?e.call(this,o):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){t(this).replaceWith(this.childNodes)}),this}}),t.expr.pseudos.hidden=function(e){return!t.expr.pseudos.visible(e)},t.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},t.ajaxSettings.xhr=function(){try{return new bt.XMLHttpRequest}catch{}};var Nr={0:200,1223:204},Ue=t.ajaxSettings.xhr();u.cors=!!Ue&&"withCredentials"in Ue,u.ajax=Ue=!!Ue,t.ajaxTransport(function(e){var n,o;if(u.cors||Ue&&!e.crossDomain)return{send:function(f,v){var m,I=e.xhr();if(I.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(m in e.xhrFields)I[m]=e.xhrFields[m];e.mimeType&&I.overrideMimeType&&I.overrideMimeType(e.mimeType),!e.crossDomain&&!f["X-Requested-With"]&&(f["X-Requested-With"]="XMLHttpRequest");for(m in f)I.setRequestHeader(m,f[m]);n=function(q){return function(){n&&(n=o=I.onload=I.onerror=I.onabort=I.ontimeout=I.onreadystatechange=null,q==="abort"?I.abort():q==="error"?typeof I.status!="number"?v(0,"error"):v(I.status,I.statusText):v(Nr[I.status]||I.status,I.statusText,(I.responseType||"text")!=="text"||typeof I.responseText!="string"?{binary:I.response}:{text:I.responseText},I.getAllResponseHeaders()))}},I.onload=n(),o=I.onerror=I.ontimeout=n("error"),I.onabort!==void 0?I.onabort=o:I.onreadystatechange=function(){I.readyState===4&&bt.setTimeout(function(){n&&o()})},n=n("abort");try{I.send(e.hasContent&&e.data||null)}catch(q){if(n)throw q}},abort:function(){n&&n()}}}),t.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),t.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return t.globalEval(e),e}}}),t.ajaxPrefilter("script",function(e){e.cache===void 0&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),t.ajaxTransport("script",function(e){if(e.crossDomain||e.scriptAttrs){var n,o;return{send:function(f,v){n=t("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",o=function(m){n.remove(),o=null,m&&v(m.type==="error"?404:200,m.type)}),O.head.appendChild(n[0])},abort:function(){o&&o()}}}});var Kn=[],ln=/(=)\?(?=&|$)|\?\?/;t.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Kn.pop()||t.expando+"_"+Gn.guid++;return this[e]=!0,e}}),t.ajaxPrefilter("json jsonp",function(e,n,o){var f,v,m,I=e.jsonp!==!1&&(ln.test(e.url)?"url":typeof e.data=="string"&&(e.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&ln.test(e.data)&&"data");if(I||e.dataTypes[0]==="jsonp")return f=e.jsonpCallback=h(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,I?e[I]=e[I].replace(ln,"$1"+f):e.jsonp!==!1&&(e.url+=(on.test(e.url)?"&":"?")+e.jsonp+"="+f),e.converters["script json"]=function(){return m||t.error(f+" was not called"),m[0]},e.dataTypes[0]="json",v=bt[f],bt[f]=function(){m=arguments},o.always(function(){v===void 0?t(bt).removeProp(f):bt[f]=v,e[f]&&(e.jsonpCallback=n.jsonpCallback,Kn.push(f)),m&&h(v)&&v(m[0]),m=v=void 0}),"script"}),u.createHTMLDocument=function(){var e=O.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",e.childNodes.length===2}(),t.parseHTML=function(e,n,o){if(typeof e!="string")return[];typeof n=="boolean"&&(o=n,n=!1);var f,v,m;return n||(u.createHTMLDocument?(n=O.implementation.createHTMLDocument(""),f=n.createElement("base"),f.href=O.location.href,n.head.appendChild(f)):n=O),v=at.exec(e),m=!o&&[],v?[n.createElement(v[1])]:(v=An([e],n,m),m&&m.length&&t(m).remove(),t.merge([],v.childNodes))},t.fn.load=function(e,n,o){var f,v,m,I=this,q=e.indexOf(" ");return q>-1&&(f=Oe(e.slice(q)),e=e.slice(0,q)),h(n)?(o=n,n=void 0):n&&typeof n=="object"&&(v="POST"),I.length>0&&t.ajax({url:e,type:v||"GET",dataType:"html",data:n}).done(function(_){m=arguments,I.html(f?t("<div>").append(t.parseHTML(_)).find(f):_)}).always(o&&function(_,J){I.each(function(){o.apply(this,m||[_.responseText,J,_])})}),this},t.expr.pseudos.animated=function(e){return t.grep(t.timers,function(n){return e===n.elem}).length},t.offset={setOffset:function(e,n,o){var f,v,m,I,q,_,J,nt=t.css(e,"position"),it=t(e),Z={};nt==="static"&&(e.style.position="relative"),q=it.offset(),m=t.css(e,"top"),_=t.css(e,"left"),J=(nt==="absolute"||nt==="fixed")&&(m+_).indexOf("auto")>-1,J?(f=it.position(),I=f.top,v=f.left):(I=parseFloat(m)||0,v=parseFloat(_)||0),h(n)&&(n=n.call(e,o,t.extend({},q))),n.top!=null&&(Z.top=n.top-q.top+I),n.left!=null&&(Z.left=n.left-q.left+v),"using"in n?n.using.call(e,Z):it.css(Z)}},t.fn.extend({offset:function(e){if(arguments.length)return e===void 0?this:this.each(function(v){t.offset.setOffset(this,e,v)});var n,o,f=this[0];if(f)return f.getClientRects().length?(n=f.getBoundingClientRect(),o=f.ownerDocument.defaultView,{top:n.top+o.pageYOffset,left:n.left+o.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var e,n,o,f=this[0],v={top:0,left:0};if(t.css(f,"position")==="fixed")n=f.getBoundingClientRect();else{for(n=this.offset(),o=f.ownerDocument,e=f.offsetParent||o.documentElement;e&&(e===o.body||e===o.documentElement)&&t.css(e,"position")==="static";)e=e.parentNode;e&&e!==f&&e.nodeType===1&&(v=t(e).offset(),v.top+=t.css(e,"borderTopWidth",!0),v.left+=t.css(e,"borderLeftWidth",!0))}return{top:n.top-v.top-t.css(f,"marginTop",!0),left:n.left-v.left-t.css(f,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&t.css(e,"position")==="static";)e=e.offsetParent;return e||ee})}}),t.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var o=n==="pageYOffset";t.fn[e]=function(f){return Nt(this,function(v,m,I){var q;if(P(v)?q=v:v.nodeType===9&&(q=v.defaultView),I===void 0)return q?q[n]:v[m];q?q.scrollTo(o?q.pageXOffset:I,o?I:q.pageYOffset):v[m]=I},e,f,arguments.length)}}),t.each(["top","left"],function(e,n){t.cssHooks[n]=In(u.pixelPosition,function(o,f){if(f)return f=Le(o,n),Ye.test(f)?t(o).position()[n]+"px":f})}),t.each({Height:"height",Width:"width"},function(e,n){t.each({padding:"inner"+e,content:n,"":"outer"+e},function(o,f){t.fn[f]=function(v,m){var I=arguments.length&&(o||typeof v!="boolean"),q=o||(v===!0||m===!0?"margin":"border");return Nt(this,function(_,J,nt){var it;return P(_)?f.indexOf("outer")===0?_["inner"+e]:_.document.documentElement["client"+e]:_.nodeType===9?(it=_.documentElement,Math.max(_.body["scroll"+e],it["scroll"+e],_.body["offset"+e],it["offset"+e],it["client"+e])):nt===void 0?t.css(_,J,q):t.style(_,J,nt,q)},n,I?v:void 0,I)}})}),t.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,n){t.fn[n]=function(o){return this.on(n,o)}}),t.fn.extend({bind:function(e,n,o){return this.on(e,null,n,o)},unbind:function(e,n){return this.off(e,null,n)},delegate:function(e,n,o,f){return this.on(n,e,o,f)},undelegate:function(e,n,o){return arguments.length===1?this.off(e,"**"):this.off(n,e||"**",o)},hover:function(e,n){return this.on("mouseenter",e).on("mouseleave",n||e)}}),t.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){t.fn[n]=function(o,f){return arguments.length>0?this.on(n,null,o,f):this.trigger(n)}});var jr=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;t.proxy=function(e,n){var o,f,v;if(typeof n=="string"&&(o=e[n],n=e,e=o),!!h(e))return f=T.call(arguments,2),v=function(){return e.apply(n||this,f.concat(T.call(arguments)))},v.guid=e.guid=e.guid||t.guid++,v},t.holdReady=function(e){e?t.readyWait++:t.ready(!0)},t.isArray=Array.isArray,t.parseJSON=JSON.parse,t.nodeName=l,t.isFunction=h,t.isWindow=P,t.camelCase=Qt,t.type=C,t.now=Date.now,t.isNumeric=function(e){var n=t.type(e);return(n==="number"||n==="string")&&!isNaN(e-parseFloat(e))},t.trim=function(e){return e==null?"":(e+"").replace(jr,"$1")};var Ur=bt.jQuery,Br=bt.$;return t.noConflict=function(e){return bt.$===t&&(bt.$=Br),e&&bt.jQuery===t&&(bt.jQuery=Ur),t},typeof ut>"u"&&(bt.jQuery=bt.$=t),t})}(mn)),mn.exports}(function(zt){(function(bt){bt(["jquery"],function(ut){return function(){var S,g,T=0,c={error:"error",info:"info",success:"success",warning:"warning"},G={clear:h,remove:P,error:N,getContainer:H,info:j,options:{},subscribe:b,success:M,version:"2.1.4",warning:u},D;return G;function N(l,i,y){return a({type:c.error,iconClass:t().iconClasses.error,message:l,optionsOverride:y,title:i})}function H(l,i){return l||(l=t()),S=ut("#"+l.containerId),S.length||i&&(S=p(l)),S}function j(l,i,y){return a({type:c.info,iconClass:t().iconClasses.info,message:l,optionsOverride:y,title:i})}function b(l){g=l}function M(l,i,y){return a({type:c.success,iconClass:t().iconClasses.success,message:l,optionsOverride:y,title:i})}function u(l,i,y){return a({type:c.warning,iconClass:t().iconClasses.warning,message:l,optionsOverride:y,title:i})}function h(l,i){var y=t();S||H(y),d(l,y,i)||O(y)}function P(l){var i=t();if(S||H(i),l&&ut(":focus",l).length===0){r(l);return}S.children().length&&S.remove()}function O(l){for(var i=S.children(),y=i.length-1;y>=0;y--)d(ut(i[y]),l)}function d(l,i,y){var U=y&&y.force?y.force:!1;return l&&(U||ut(":focus",l).length===0)?(l[i.hideMethod]({duration:i.hideDuration,easing:i.hideEasing,complete:function(){r(l)}}),!0):!1}function p(l){return S=ut("<div/>").attr("id",l.containerId).addClass(l.positionClass),S.appendTo(ut(l.target)),S}function C(){return{tapToDismiss:!0,toastClass:"toast",containerId:"toast-container",debug:!1,showMethod:"fadeIn",showDuration:300,showEasing:"swing",onShown:void 0,hideMethod:"fadeOut",hideDuration:1e3,hideEasing:"swing",onHidden:void 0,closeMethod:!1,closeDuration:!1,closeEasing:!1,closeOnHover:!0,extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},iconClass:"toast-info",positionClass:"toast-top-right",timeOut:5e3,titleClass:"toast-title",messageClass:"toast-message",escapeHtml:!1,target:"body",closeHtml:'<button type="button">&times;</button>',closeClass:"toast-close-button",newestOnTop:!0,preventDuplicates:!1,progressBar:!1,progressClass:"toast-progress",rtl:!1}}function s(l){g&&g(l)}function a(l){var i=t(),y=l.iconClass||i.iconClass;if(typeof l.optionsOverride<"u"&&(i=ut.extend(i,l.optionsOverride),y=l.optionsOverride.iconClass||y),St(i,l))return;T++,S=H(i,!0);var U=null,w=ut("<div/>"),L=ut("<div/>"),x=ut("<div/>"),E=ut("<div/>"),A=ut(i.closeHtml),W={intervalId:null,hideEta:null,maxHideTime:null},V={toastId:T,state:"visible",startTime:new Date,options:i,map:l};return ot(),R(),$(),s(V),i.debug&&console&&console.log(V),w;function X(Tt){return Tt==null&&(Tt=""),Tt.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function ot(){B(),z(),et(),ct(),dt(),Ot(),k(),at()}function at(){var Tt="";switch(l.iconClass){case"toast-success":case"toast-info":Tt="polite";break;default:Tt="assertive"}w.attr("aria-live",Tt)}function $(){i.closeOnHover&&w.hover(Ht,vt),!i.onclick&&i.tapToDismiss&&w.click(Mt),i.closeButton&&A&&A.click(function(Tt){Tt.stopPropagation?Tt.stopPropagation():Tt.cancelBubble!==void 0&&Tt.cancelBubble!==!0&&(Tt.cancelBubble=!0),i.onCloseClick&&i.onCloseClick(Tt),Mt(!0)}),i.onclick&&w.click(function(Tt){i.onclick(Tt),Mt()})}function R(){w.hide(),w[i.showMethod]({duration:i.showDuration,easing:i.showEasing,complete:i.onShown}),i.timeOut>0&&(U=setTimeout(Mt,i.timeOut),W.maxHideTime=parseFloat(i.timeOut),W.hideEta=new Date().getTime()+W.maxHideTime,i.progressBar&&(W.intervalId=setInterval(Ft,10)))}function B(){l.iconClass&&w.addClass(i.toastClass).addClass(y)}function k(){i.newestOnTop?S.prepend(w):S.append(w)}function z(){if(l.title){var Tt=l.title;i.escapeHtml&&(Tt=X(l.title)),L.append(Tt).addClass(i.titleClass),w.append(L)}}function et(){if(l.message){var Tt=l.message;i.escapeHtml&&(Tt=X(l.message)),x.append(Tt).addClass(i.messageClass),w.append(x)}}function ct(){i.closeButton&&(A.addClass(i.closeClass).attr("role","button"),w.prepend(A))}function dt(){i.progressBar&&(E.addClass(i.progressClass),w.prepend(E))}function Ot(){i.rtl&&w.addClass("rtl")}function St(Tt,Nt){if(Tt.preventDuplicates){if(Nt.message===D)return!0;D=Nt.message}return!1}function Mt(Tt){var Nt=Tt&&i.closeMethod!==!1?i.closeMethod:i.hideMethod,Zt=Tt&&i.closeDuration!==!1?i.closeDuration:i.hideDuration,ve=Tt&&i.closeEasing!==!1?i.closeEasing:i.hideEasing;if(!(ut(":focus",w).length&&!Tt))return clearTimeout(W.intervalId),w[Nt]({duration:Zt,easing:ve,complete:function(){r(w),clearTimeout(U),i.onHidden&&V.state!=="hidden"&&i.onHidden(),V.state="hidden",V.endTime=new Date,s(V)}})}function vt(){(i.timeOut>0||i.extendedTimeOut>0)&&(U=setTimeout(Mt,i.extendedTimeOut),W.maxHideTime=parseFloat(i.extendedTimeOut),W.hideEta=new Date().getTime()+W.maxHideTime)}function Ht(){clearTimeout(U),W.hideEta=0,w.stop(!0,!0)[i.showMethod]({duration:i.showDuration,easing:i.showEasing})}function Ft(){var Tt=(W.hideEta-new Date().getTime())/W.maxHideTime*100;E.width(Tt+"%")}}function t(){return ut.extend({},C(),G.options)}function r(l){S||(S=H()),!l.is(":visible")&&(l.remove(),l=null,S.children().length===0&&(S.remove(),D=void 0))}}()})})(function(bt,ut){zt.exports?zt.exports=ut(Qr()):window.toastr=ut(window.jQuery)})})(Zn);var Jr=Zn.exports;const tr=qr(Jr);var er=new Kr.Realtime("f-eOvQ.531lyg:rYnJ7AxwNX3q7RlLJTLwpFdav5ybFJMhuYV6bVf90I8"),Xr=er.channels.get("channel-in");Xr.subscribe(function(zt){tr.success(zt.data.product+" berhasil masuk gudang")});var $r=er.channels.get("channel-out");$r.subscribe(function(zt){tr.error(zt.data.product+" keluar gudang")});
